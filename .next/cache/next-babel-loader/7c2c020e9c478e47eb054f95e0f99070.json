{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport { Button, Typography, Tooltip, Checkbox } from '@material-ui/core';\nimport { AddCircle as AddCircleIcon, Close as CloseIcon } from '@material-ui/icons';\nimport { AppAutocompleteStyled, DataTable, DataTableCellExpand } from '@/components/index';\nimport { Unless } from 'react-if';\nimport useStyles from './styles';\nimport useStylesLayout from '@/styles/page/layout';\nimport { useTranslation } from 'next-i18next';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { useFormContext } from 'react-hook-form';\nimport clsx from 'clsx';\nimport { makeAListActions } from '@/store/reducers';\nimport * as columnProperties from '@/utils/columnProperties';\n\nfunction TablePresetList(_ref) {\n  var setActiveTab = _ref.setActiveTab;\n  var classes = useStyles();\n  var classesLayout = useStylesLayout();\n\n  var _useTranslation = useTranslation(['make_a_list']),\n      t = _useTranslation.t;\n\n  var makeAListForm = useFormContext();\n  var refDataGrid = React.useRef(null);\n\n  var _React$useState = React.useState(null),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      idSelected = _React$useState2[0],\n      setIdSelected = _React$useState2[1];\n\n  var dispatch = useDispatch();\n  var filterType = useSelector(makeAListActions.selectFilterType);\n  var presetList = useSelector(makeAListActions.selectPresetList);\n  var loadingTable = useSelector(makeAListActions.selectLoadingTable);\n  var malPermissions = useSelector(makeAListActions.selectPermissions);\n  var presetDefault = useSelector(makeAListActions.selectPresetDefault);\n  var presetDetail = useSelector(makeAListActions.selectPresetDetail);\n\n  var getColumnPresetList = function getColumnPresetList() {\n    var onwColumns = [_objectSpread(_objectSpread({}, columnProperties.defaultProperties), {}, {\n      field: 'name',\n      headerName: 'Name',\n      flex: 0.6\n    }), _objectSpread(_objectSpread({}, columnProperties.defaultProperties), {}, {\n      headerName: 'Shared',\n      field: 'is_shared',\n      renderCell: function renderCell(params) {\n        if (!refDataGrid.current) {\n          refDataGrid.current = params.api;\n        }\n\n        var message = params.value ? t('make_a_list:tooltip.unshare_checkbox') : t('make_a_list:tooltip.share_checkbox');\n        return /*#__PURE__*/_jsx(Tooltip, {\n          title: message,\n          children: /*#__PURE__*/_jsx(Checkbox, {\n            color: \"primary\",\n            checked: params.value,\n            onChange: onSharePreset(params.id)\n          })\n        });\n      }\n    })];\n    var sharedColumns = [_objectSpread(_objectSpread({}, columnProperties.defaultProperties), {}, {\n      field: 'name',\n      headerName: 'Name',\n      flex: 0.6,\n      renderCell: function renderCell(params) {\n        if (!refDataGrid.current) {\n          refDataGrid.current = params.api;\n        }\n\n        return /*#__PURE__*/_jsx(DataTableCellExpand, {\n          value: params.value,\n          width: params.colDef.width\n        });\n      }\n    }), _objectSpread(_objectSpread({}, columnProperties.defaultProperties), {}, {\n      field: 'created_by',\n      headerName: t('advanced_filter:list.owner')\n    })];\n\n    if (filterType === 'own') {\n      return onwColumns;\n    }\n\n    return sharedColumns;\n  };\n\n  var getOptionFilterList = function getOptionFilterList() {\n    var defaultOptions = [{\n      name: 'Owner',\n      value: 'own'\n    }, {\n      name: 'Shared',\n      value: 'shared'\n    }];\n\n    if (malPermissions.update_system_default_presets) {\n      defaultOptions.push({\n        name: 'System',\n        value: 'system'\n      });\n    }\n\n    return defaultOptions;\n  };\n\n  var filterOptions = React.useMemo(getOptionFilterList, [malPermissions.update_system_default_presets]);\n  var columnsMyPreset = React.useMemo(getColumnPresetList, [filterType]);\n  React.useEffect(function () {\n    setIdSelected(presetDetail.id);\n  }, [presetDetail]);\n\n  var onChangeFilterType = function onChangeFilterType(_, _ref2) {\n    var value = _ref2.value;\n    dispatch(makeAListActions.changeFilterType(value));\n  };\n\n  var onSelectRowPresetDetail = function onSelectRowPresetDetail(params) {\n    setActiveTab(0);\n    makeAListForm.clearErrors();\n    onSelectPresetDetail(params.id)();\n  };\n\n  var onSelectPresetDetail = function onSelectPresetDetail(id) {\n    return function () {\n      var _refDataGrid$current;\n\n      (_refDataGrid$current = refDataGrid.current) === null || _refDataGrid$current === void 0 ? void 0 : _refDataGrid$current.setSelectionModel([]);\n      dispatch(makeAListActions.setIsEditMode(true));\n      dispatch(makeAListActions.getDetail(id));\n    };\n  };\n\n  var onClearUserDefault = function onClearUserDefault() {\n    var _refDataGrid$current2;\n\n    (_refDataGrid$current2 = refDataGrid.current) === null || _refDataGrid$current2 === void 0 ? void 0 : _refDataGrid$current2.setSelectionModel([]);\n    dispatch(makeAListActions.clearDefault());\n  };\n\n  var onSharePreset = function onSharePreset(id) {\n    return function (event, shared) {\n      dispatch(makeAListActions.share({\n        id: id,\n        shared: shared\n      }));\n    };\n  };\n\n  var onCreateFilter = function onCreateFilter() {\n    var _refDataGrid$current3;\n\n    (_refDataGrid$current3 = refDataGrid.current) === null || _refDataGrid$current3 === void 0 ? void 0 : _refDataGrid$current3.setSelectionModel([]);\n    dispatch(makeAListActions.resetPresetDetail());\n    dispatch(makeAListActions.setIsEditMode(false));\n    setActiveTab(0);\n    makeAListForm.clearErrors();\n  };\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: classes.filterListTopSection,\n      children: [/*#__PURE__*/_jsx(AppAutocompleteStyled, {\n        label: \"Preset List\",\n        options: filterOptions,\n        renderOption: function renderOption(option) {\n          return option.name;\n        },\n        defaultValue: filterOptions[0],\n        onChange: onChangeFilterType,\n        primaryKeyOption: \"value\"\n      }), /*#__PURE__*/_jsx(Button, {\n        variant: \"contained\",\n        startIcon: /*#__PURE__*/_jsx(AddCircleIcon, {}),\n        className: clsx(classesLayout.buttonControl, 'new', classes.btnCreatePreset),\n        style: {\n          background: '#0A65FF',\n          color: 'white'\n        },\n        onClick: onCreateFilter,\n        children: \"New preset\"\n      })]\n    }), /*#__PURE__*/_jsxs(Typography, {\n      component: \"div\",\n      className: classes.wrapLabelFilter,\n      children: [/*#__PURE__*/_jsx(Typography, {\n        component: \"span\",\n        variant: \"body1\",\n        children: \"Default Preset:\\xA0\"\n      }), /*#__PURE__*/_jsx(Typography, {\n        component: \"span\",\n        variant: \"body1\",\n        className: classes.defaultFilterLink,\n        noWrap: true,\n        onClick: onSelectPresetDetail(presetDefault.id),\n        children: presetDefault.name\n      }), /*#__PURE__*/_jsx(Unless, {\n        condition: presetDefault.is_system_default,\n        children: /*#__PURE__*/_jsx(CloseIcon, {\n          onClick: onClearUserDefault\n        })\n      })]\n    }), /*#__PURE__*/_jsx(DataTable, {\n      loading: loadingTable,\n      tableHeight: 570,\n      disableColumnMenu: true,\n      columns: columnsMyPreset,\n      rows: presetList,\n      hideFooter: true,\n      onRowClick: onSelectRowPresetDetail,\n      getRowClassName: function getRowClassName(params) {\n        return clsx(_defineProperty({}, classes.presetSelected, params.id === idSelected));\n      },\n      onCellClick: function onCellClick(params, event) {\n        if (params.field === 'is_shared') {\n          event.stopPropagation();\n        }\n      }\n    })]\n  });\n}\n\nexport default TablePresetList;","map":null,"metadata":{},"sourceType":"module"}