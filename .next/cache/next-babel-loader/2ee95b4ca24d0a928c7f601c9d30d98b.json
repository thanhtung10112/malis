{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { createElement as _createElement } from \"react\";\nvar _jsxFileName = \"D:\\\\TTS_Reactjs\\\\malis-3-frontend\\\\src\\\\components\\\\App\\\\Layout\\\\index.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport { useMemo, useEffect, useCallback } from 'react';\nimport { useRouter } from 'next/router';\nimport useStyles from './styles';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useTranslation } from 'react-i18next';\nimport Head from 'next/head';\nimport { Paper, Grid } from '@material-ui/core';\nimport { DataGrid } from '@material-ui/data-grid';\nimport { When, Unless } from 'react-if';\nimport { AdvancedFilter, MakeAList, AppBreadcrumb, MalisNoViewPermissionOnModule, Footer, DataTablePagination, DataTableLoadingOverlay, DataTableNoRowsOverlay, AppButton, DataTableColumnMenu, AppSearchBar } from '@/components';\nimport clsx from 'clsx';\nimport _ from 'lodash';\nimport { advancedFilterActions, commonStore, equivalenceStore } from '@/store/reducers';\nimport { createAction } from '@reduxjs/toolkit';\nimport { actionTypes } from '@/utils/constant';\nimport { TABLE_HEIGHT_INCLUDE_FOOTER } from '@/styles/vars/size';\nimport AppNumber from '@/helper/AppNumber';\n\nconst Layout = props => {\n  const {\n    breadcrumbs,\n    buttons,\n    Dialogs,\n    Options,\n    tableProps,\n    exportable,\n    permissions,\n    searchProps,\n    filterable,\n    leftSection,\n    tableSection,\n    bottomSection,\n    tableHeight,\n    entity,\n    wikiPage\n  } = props;\n  const classes = useStyles();\n  const {\n    t\n  } = useTranslation();\n  const router = useRouter();\n  const dispatch = useDispatch();\n  const equivalenceType = useSelector(equivalenceStore.selectEquivalenceType);\n  const isOpenAF = useSelector(advancedFilterActions.selectOpenAdvanceSearch);\n  const tableState = useSelector(commonStore.selectTableState);\n  const {\n    table: loadingTable\n  } = useSelector(commonStore.selectLoading);\n  const selectedRows = useSelector(commonStore.selectSelectedRows);\n  const editRows = useSelector(commonStore.selectEditRows);\n  const entityApp = useMemo(() => {\n    if (entity === 'manufacturing_standard' || entity === 'material_standard') {\n      return 'equivalence';\n    }\n\n    return entity;\n  }, [entity]);\n  const headTitle = useMemo(() => {\n    if (!entityApp) {\n      return t('common:loading');\n    }\n\n    if (entityApp === 'equivalence') {\n      if (equivalenceType) {\n        return t(`${entityApp}:head_title_${equivalenceType}`);\n      }\n\n      return t('common:loading');\n    }\n\n    return t(`${entityApp}:head_title`);\n  }, [entityApp, equivalenceType]);\n  const dataList = useSelector(state => {\n    var _state$entityApp;\n\n    if (!entityApp) {\n      return [];\n    }\n\n    return ((_state$entityApp = state[entityApp]) === null || _state$entityApp === void 0 ? void 0 : _state$entityApp.dataList) || [];\n  });\n  const getListAction = useMemo(() => createAction(`${entityApp}/${actionTypes.GET_LIST}`), [entityApp]);\n  const resetStateAction = useMemo(() => createAction(`${entityApp}/${actionTypes.RESET_STATE}`), [entityApp]);\n  const openCreateDialogAct = useMemo(() => createAction(`${entityApp}/${actionTypes.OPEN_CREATE_DIALOG}`), [entityApp]);\n  const openUpdateDialogAct = useMemo(() => createAction(`${entityApp}/${actionTypes.OPEN_UPDATE_DIALOG}`), [entityApp]);\n  useEffect(() => {\n    if (!entity) {\n      return;\n    }\n\n    dispatch(commonStore.actions.setEntity(entity));\n    dispatch(getListAction());\n    return () => {\n      dispatch(resetStateAction());\n    };\n  }, [entity, resetStateAction, getListAction]);\n  useEffect(() => {\n    if (selectedRows.length > 0) {\n      dispatch(commonStore.actions.setSelectedRows([]));\n    }\n\n    if (editRows.length > 0) {\n      dispatch(commonStore.actions.setEditRows([]));\n    }\n  }, [dataList]);\n  useEffect(() => {\n    const {\n      id,\n      action\n    } = router.query;\n\n    if (AppNumber.isNumber(id) && action === 'update') {\n      dispatch(openUpdateDialogAct(router.query.id));\n    } else if (action === 'create') {\n      dispatch(openCreateDialogAct());\n    }\n  }, [entityApp, actionTypes, router.query.id, router.query.action]);\n  const renderButtons = useCallback(() => {\n    if (_.isArray(buttons)) {\n      return buttons.filter(button => !button.hide).map((_ref, index) => {\n        let {\n          label,\n          hide,\n          className\n        } = _ref,\n            buttonProps = _objectWithoutProperties(_ref, [\"label\", \"hide\", \"className\"]);\n\n        return /*#__PURE__*/_createElement(AppButton, _objectSpread(_objectSpread({}, buttonProps), {}, {\n          key: index,\n          className: clsx(className, classes.buttonControl),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 11\n          },\n          __self: this\n        }), label);\n      });\n    }\n\n    return /*#__PURE__*/_jsxDEV(AppButton, _objectSpread(_objectSpread({}, buttons), {}, {\n      className: clsx(buttons === null || buttons === void 0 ? void 0 : buttons.className, classes.buttonControl),\n      children: buttons === null || buttons === void 0 ? void 0 : buttons.label\n    }), void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 7\n    }, this);\n  }, [buttons]);\n\n  const handleChangePage = page => {\n    dispatch(commonStore.actions.setTableState({\n      page\n    }));\n    dispatch(getListAction());\n  };\n\n  const handleChangePerpage = per_page => {\n    dispatch(commonStore.actions.setTableState({\n      per_page\n    }));\n    handleChangePage(1);\n  };\n\n  const handleSearch = (event, query) => {\n    dispatch(commonStore.actions.setSearchQuery(query));\n    handleChangePage(1);\n  };\n\n  const handleSelectRows = ({\n    selectionModel\n  }) => {\n    dispatch(commonStore.actions.setSelectedRows(selectionModel));\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: /*#__PURE__*/_jsxDEV(\"title\", {\n        children: headTitle\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(AppBreadcrumb, {\n      items: breadcrumbs,\n      wikiPage: wikiPage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Paper, {\n      elevation: 1,\n      className: classes.main,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.control,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.wrapControl,\n          children: [/*#__PURE__*/_jsxDEV(AppSearchBar, _objectSpread(_objectSpread({\n            onSearch: handleSearch,\n            width: 500,\n            placeholder: t(`${entityApp}:search_placeholder`),\n            filterable: filterable\n          }, searchProps), {}, {\n            disabled: !(permissions === null || permissions === void 0 ? void 0 : permissions.view)\n          }), void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 13\n          }, this), Options]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"\",\n          children: renderButtons()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(When, {\n        condition: isOpenAF,\n        children: /*#__PURE__*/_jsxDEV(AdvancedFilter, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(When, {\n        condition: permissions === null || permissions === void 0 ? void 0 : permissions.view,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          style: {\n            height: tableHeight || TABLE_HEIGHT_INCLUDE_FOOTER,\n            width: '100%'\n          },\n          children: [/*#__PURE__*/_jsxDEV(Unless, {\n            condition: leftSection === null || leftSection === void 0 ? void 0 : leftSection.hide,\n            children: /*#__PURE__*/_jsxDEV(Grid, _objectSpread(_objectSpread(_objectSpread({\n              item: true\n            }, leftSection.breakPoint), _.omit(leftSection, ['breakPoint', 'hide', 'Component'])), {}, {\n              children: leftSection.Component\n            }), void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Grid, _objectSpread(_objectSpread({\n            item: true\n          }, tableSection === null || tableSection === void 0 ? void 0 : tableSection.breakPoint), {}, {\n            children: /*#__PURE__*/_jsxDEV(DataGrid, _objectSpread({\n              checkboxSelection: true,\n              loading: loadingTable,\n              rows: dataList,\n              headerHeight: 30,\n              rowHeight: 30,\n              hideFooter: true,\n              selectionModel: selectedRows,\n              onSelectionModelChange: handleSelectRows,\n              components: {\n                LoadingOverlay: DataTableLoadingOverlay,\n                NoRowsOverlay: DataTableNoRowsOverlay,\n                ColumnMenu: DataTableColumnMenu\n              },\n              onCellClick: (params, event) => {\n                if (params.field === 'id') {\n                  event.stopPropagation();\n                }\n              }\n            }, tableProps), void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 15\n            }, this)\n          }), void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 11\n        }, this), bottomSection, /*#__PURE__*/_jsxDEV(DataTablePagination, {\n          countSelectedItems: selectedRows.length,\n          page: tableState.page,\n          perPage: tableState.per_page,\n          totalItems: tableState.total_items,\n          onChangePage: handleChangePage,\n          onChangePerPage: handleChangePerpage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(When, {\n        condition: !_.isNil(permissions) && (permissions === null || permissions === void 0 ? void 0 : permissions.view) === false,\n        children: /*#__PURE__*/_jsxDEV(MalisNoViewPermissionOnModule, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 7\n    }, this), Dialogs, /*#__PURE__*/_jsxDEV(When, {\n      condition: exportable,\n      children: /*#__PURE__*/_jsxDEV(MakeAList, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\nLayout.defaultProps = {\n  filterable: true,\n  exportable: true,\n  permissions: null,\n  tableProps: {\n    columns: []\n  },\n  tableSection: {\n    breakPoint: {\n      xs: 12\n    }\n  },\n  leftSection: {}\n};\nexport default Layout;","map":{"version":3,"sources":["D:/TTS_Reactjs/malis-3-frontend/src/components/App/Layout/index.tsx"],"names":["useMemo","useEffect","useCallback","useRouter","useStyles","useDispatch","useSelector","useTranslation","Head","Paper","Grid","DataGrid","When","Unless","AdvancedFilter","MakeAList","AppBreadcrumb","MalisNoViewPermissionOnModule","Footer","DataTablePagination","DataTableLoadingOverlay","DataTableNoRowsOverlay","AppButton","DataTableColumnMenu","AppSearchBar","clsx","_","advancedFilterActions","commonStore","equivalenceStore","createAction","actionTypes","TABLE_HEIGHT_INCLUDE_FOOTER","AppNumber","Layout","props","breadcrumbs","buttons","Dialogs","Options","tableProps","exportable","permissions","searchProps","filterable","leftSection","tableSection","bottomSection","tableHeight","entity","wikiPage","classes","t","router","dispatch","equivalenceType","selectEquivalenceType","isOpenAF","selectOpenAdvanceSearch","tableState","selectTableState","table","loadingTable","selectLoading","selectedRows","selectSelectedRows","editRows","selectEditRows","entityApp","headTitle","dataList","state","getListAction","GET_LIST","resetStateAction","RESET_STATE","openCreateDialogAct","OPEN_CREATE_DIALOG","openUpdateDialogAct","OPEN_UPDATE_DIALOG","actions","setEntity","length","setSelectedRows","setEditRows","id","action","query","isNumber","renderButtons","isArray","filter","button","hide","map","index","label","className","buttonProps","buttonControl","handleChangePage","page","setTableState","handleChangePerpage","per_page","handleSearch","event","setSearchQuery","handleSelectRows","selectionModel","main","control","wrapControl","view","height","width","breakPoint","omit","Component","LoadingOverlay","NoRowsOverlay","ColumnMenu","params","field","stopPropagation","total_items","isNil","defaultProps","columns","xs"],"mappings":"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","sourcesContent":["import { useMemo, useEffect, useCallback } from 'react'\nimport { useRouter } from 'next/router'\nimport useStyles from './styles'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { useTranslation } from 'react-i18next'\n\nimport Head from 'next/head'\n\nimport { Paper, Grid } from '@material-ui/core'\nimport { DataGrid } from '@material-ui/data-grid'\n\nimport { When, Unless } from 'react-if'\n\nimport {\n  AdvancedFilter,\n  MakeAList,\n  AppBreadcrumb,\n  MalisNoViewPermissionOnModule,\n  Footer,\n  DataTablePagination,\n  DataTableLoadingOverlay,\n  DataTableNoRowsOverlay,\n  AppButton,\n  DataTableColumnMenu,\n  AppSearchBar\n} from '@/components'\n\nimport clsx from 'clsx'\nimport _ from 'lodash'\nimport { advancedFilterActions, commonStore, equivalenceStore } from '@/store/reducers'\nimport { createAction } from '@reduxjs/toolkit'\nimport { actionTypes } from '@/utils/constant'\n\nimport { TABLE_HEIGHT_INCLUDE_FOOTER } from '@/styles/vars/size'\n\nimport type { ButtonLayout, LayoutProps } from './type'\nimport AppNumber from '@/helper/AppNumber'\n\nconst Layout: React.FC<LayoutProps> = (props) => {\n  const {\n    breadcrumbs,\n    buttons,\n    Dialogs,\n    Options,\n    tableProps,\n    exportable,\n    permissions,\n    searchProps,\n    filterable,\n    leftSection,\n    tableSection,\n    bottomSection,\n    tableHeight,\n    entity,\n    wikiPage\n  } = props\n\n  const classes = useStyles()\n  const { t } = useTranslation()\n  const router = useRouter()\n\n  const dispatch = useDispatch()\n  const equivalenceType = useSelector(equivalenceStore.selectEquivalenceType)\n  const isOpenAF = useSelector(advancedFilterActions.selectOpenAdvanceSearch)\n  const tableState = useSelector(commonStore.selectTableState)\n  const { table: loadingTable } = useSelector(commonStore.selectLoading)\n  const selectedRows = useSelector(commonStore.selectSelectedRows)\n  const editRows = useSelector(commonStore.selectEditRows)\n\n  const entityApp = useMemo(() => {\n    if (entity === 'manufacturing_standard' || entity === 'material_standard') {\n      return 'equivalence'\n    }\n    return entity\n  }, [entity])\n\n  const headTitle = useMemo(() => {\n    if (!entityApp) {\n      return t('common:loading')\n    }\n    if (entityApp === 'equivalence') {\n      if (equivalenceType) {\n        return t(`${entityApp}:head_title_${equivalenceType}`)\n      }\n      return t('common:loading')\n    }\n    return t(`${entityApp}:head_title`)\n  }, [entityApp, equivalenceType])\n\n  const dataList = useSelector((state) => {\n    if (!entityApp) {\n      return []\n    }\n    return state[entityApp]?.dataList || []\n  })\n\n  const getListAction = useMemo(() => createAction(`${entityApp}/${actionTypes.GET_LIST}`), [entityApp])\n\n  const resetStateAction = useMemo(() => createAction(`${entityApp}/${actionTypes.RESET_STATE}`), [entityApp])\n\n  const openCreateDialogAct = useMemo(() => createAction(`${entityApp}/${actionTypes.OPEN_CREATE_DIALOG}`), [entityApp])\n\n  const openUpdateDialogAct = useMemo(\n    () => createAction<number>(`${entityApp}/${actionTypes.OPEN_UPDATE_DIALOG}`),\n    [entityApp]\n  )\n\n  useEffect(() => {\n    if (!entity) {\n      return\n    }\n    dispatch(commonStore.actions.setEntity(entity))\n    dispatch(getListAction())\n    return () => {\n      dispatch(resetStateAction())\n    }\n  }, [entity, resetStateAction, getListAction])\n\n  useEffect(() => {\n    if (selectedRows.length > 0) {\n      dispatch(commonStore.actions.setSelectedRows([]))\n    }\n    if (editRows.length > 0) {\n      dispatch(commonStore.actions.setEditRows([]))\n    }\n  }, [dataList])\n\n  useEffect(() => {\n    const { id, action } = router.query\n    if (AppNumber.isNumber(id) && action === 'update') {\n      dispatch(openUpdateDialogAct((router.query as any).id))\n    } else if (action === 'create') {\n      dispatch(openCreateDialogAct())\n    }\n  }, [entityApp, actionTypes, router.query.id, router.query.action])\n\n  const renderButtons = useCallback(() => {\n    if (_.isArray(buttons)) {\n      return (buttons as ButtonLayout[])\n        .filter((button) => !button.hide)\n        .map(({ label, hide, className, ...buttonProps }, index) => (\n          <AppButton {...buttonProps} key={index} className={clsx(className, classes.buttonControl)}>\n            {label}\n          </AppButton>\n        ))\n    }\n    return (\n      <AppButton {...buttons} className={clsx(buttons?.className, classes.buttonControl)}>\n        {buttons?.label}\n      </AppButton>\n    )\n  }, [buttons])\n\n  const handleChangePage = (page) => {\n    dispatch(commonStore.actions.setTableState({ page }))\n    dispatch(getListAction())\n  }\n\n  const handleChangePerpage = (per_page) => {\n    dispatch(commonStore.actions.setTableState({ per_page }))\n    handleChangePage(1)\n  }\n\n  const handleSearch = (event, query) => {\n    dispatch(commonStore.actions.setSearchQuery(query))\n    handleChangePage(1)\n  }\n\n  const handleSelectRows = ({ selectionModel }) => {\n    dispatch(commonStore.actions.setSelectedRows(selectionModel))\n  }\n\n  return (\n    <>\n      <Head>\n        <title>{headTitle}</title>\n      </Head>\n      <AppBreadcrumb items={breadcrumbs} wikiPage={wikiPage} />\n\n      <Paper elevation={1} className={classes.main}>\n        <div className={classes.control}>\n          <div className={classes.wrapControl}>\n            <AppSearchBar\n              onSearch={handleSearch}\n              width={500}\n              placeholder={t(`${entityApp}:search_placeholder`)}\n              filterable={filterable}\n              {...searchProps}\n              disabled={!permissions?.view}\n            />\n            {Options}\n          </div>\n          <div className=\"\">{renderButtons()}</div>\n        </div>\n\n        <When condition={isOpenAF}>\n          <AdvancedFilter />\n        </When>\n\n        <When condition={permissions?.view}>\n          <Grid\n            container\n            style={{\n              height: tableHeight || TABLE_HEIGHT_INCLUDE_FOOTER,\n              width: '100%'\n            }}\n          >\n            <Unless condition={leftSection?.hide}>\n              <Grid item {...leftSection.breakPoint} {..._.omit(leftSection, ['breakPoint', 'hide', 'Component'])}>\n                {leftSection.Component}\n              </Grid>\n            </Unless>\n\n            <Grid item {...tableSection?.breakPoint}>\n              <DataGrid\n                checkboxSelection\n                loading={loadingTable}\n                rows={dataList}\n                headerHeight={30}\n                rowHeight={30}\n                hideFooter\n                selectionModel={selectedRows}\n                onSelectionModelChange={handleSelectRows}\n                components={{\n                  LoadingOverlay: DataTableLoadingOverlay,\n                  NoRowsOverlay: DataTableNoRowsOverlay,\n                  ColumnMenu: DataTableColumnMenu\n                }}\n                onCellClick={(params, event) => {\n                  if (params.field === 'id') {\n                    event.stopPropagation()\n                  }\n                }}\n                {...tableProps}\n              />\n            </Grid>\n          </Grid>\n          {bottomSection}\n          <DataTablePagination\n            countSelectedItems={selectedRows.length}\n            page={tableState.page}\n            perPage={tableState.per_page}\n            totalItems={tableState.total_items}\n            onChangePage={handleChangePage}\n            onChangePerPage={handleChangePerpage}\n          />\n          <Footer />\n        </When>\n\n        <When condition={!_.isNil(permissions) && permissions?.view === false}>\n          <MalisNoViewPermissionOnModule />\n        </When>\n      </Paper>\n      {Dialogs}\n      <When condition={exportable}>\n        <MakeAList />\n      </When>\n    </>\n  )\n}\n\nLayout.defaultProps = {\n  filterable: true,\n  exportable: true,\n  permissions: null,\n  tableProps: {\n    columns: []\n  },\n  tableSection: {\n    breakPoint: { xs: 12 }\n  },\n  leftSection: {} as any\n}\n\nexport default Layout\n"]},"metadata":{},"sourceType":"module"}