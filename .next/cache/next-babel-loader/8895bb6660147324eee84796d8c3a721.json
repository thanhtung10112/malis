{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { createSlice, createAction, createSelector } from '@reduxjs/toolkit';\nimport { setCookie, destroyCookie } from 'nookies';\nimport Router from 'next/router';\nimport { actionTypes } from '@/utils/constant';\nexport var name = 'auth';\nexport var resetState = createAction(\"\".concat(name, \"/RESET_STATE\"));\nexport var initialState = {\n  access_token: '',\n  loading: false,\n  unauthorized: false,\n  loadingAuth: false,\n  profile: {\n    user_id: '',\n    first_name: '',\n    last_name: '',\n    email: '',\n    valid_until: '',\n    user_name: '',\n    updated_at: '',\n    group_membership: [],\n    default_language_id: null\n  },\n  pwdDialogState: {\n    loading: false,\n    open: false\n  },\n  settings: {\n    initData: {\n      parameters: {\n        PAGES: [],\n        PLLA: []\n      },\n      timezones: []\n    },\n    detail: {\n      default_language: null,\n      home_page: null,\n      time_zone: ''\n    }\n  }\n};\nvar authSlice = createSlice({\n  name: name,\n  initialState: initialState,\n  reducers: {\n    saveTokenLogin: function saveTokenLogin(state, _ref) {\n      var payload = _ref.payload;\n      state.access_token = payload.access_token;\n\n      if (payload.remember) {\n        setCookie(null, 'token', payload.access_token, {\n          maxAge: 60 * 60 * 24 // 1 day\n\n        });\n      } else {\n        setCookie(null, 'token', payload.access_token);\n      }\n\n      setCookie(null, 'redirect_to', payload.redirect_to, {\n        maxAge: 60 * 60 * 24 * 365\n      });\n      Router.push(payload.redirect_to);\n    },\n    setLoading: function setLoading(state, _ref2) {\n      var payload = _ref2.payload;\n      state.loading = payload;\n    },\n    setUnauthorized: function setUnauthorized(state, _ref3) {\n      var payload = _ref3.payload;\n      state.unauthorized = payload;\n    },\n    setProfile: function setProfile(state, _ref4) {\n      var payload = _ref4.payload;\n      state.profile = payload;\n    },\n    logout: function logout(state) {\n      destroyCookie(null, 'token');\n      destroyCookie(null, 'redirect_to');\n      destroyCookie(null, 'current_job_id');\n      state.unauthorized = false;\n      state.access_token = '';\n      Router.push('/login');\n    },\n    setPwDialogState: function setPwDialogState(state, _ref5) {\n      var payload = _ref5.payload;\n      state.pwdDialogState = _objectSpread(_objectSpread({}, state.pwdDialogState), payload);\n    },\n    setProfileAvatar: function setProfileAvatar(state, _ref6) {\n      var payload = _ref6.payload;\n      state.profile.avatar = payload;\n    },\n    setSettingInitData: function setSettingInitData(state, _ref7) {\n      var payload = _ref7.payload;\n      state.settings.initData = payload;\n    },\n    setLoadingAuth: function setLoadingAuth(state, _ref8) {\n      var payload = _ref8.payload;\n      state.loadingAuth = payload;\n    },\n    setSettingDetail: function setSettingDetail(state, _ref9) {\n      var payload = _ref9.payload;\n      state.settings.detail = _objectSpread(_objectSpread({}, state.settings.detail), payload);\n    },\n    setDefaultLanguage: function setDefaultLanguage(state, _ref10) {\n      var payload = _ref10.payload;\n      state.profile.default_language_id = payload;\n    }\n  },\n  extraReducers: _defineProperty({}, resetState.type, function () {\n    return initialState;\n  })\n}); // Actions\n\nvar actions = authSlice.actions; // Saga actions\n\nexport { actions };\nexport var sagaLogin = createAction(\"\".concat(name, \"/\").concat(actionTypes.LOGIN));\nexport var sagaGetProfile = createAction(\"\".concat(name, \"/\").concat(actionTypes.GET_PROFILE));\nexport var sagaChangePassword = createAction(\"\".concat(name, \"/\").concat(actionTypes.CHANGE_PASSWORD));\nexport var sagaGetSettings = createAction(\"\".concat(name, \"/GET_SETTINGS\"));\nexport var sagaSaveSettings = createAction(\"\".concat(name, \"/SAVE_SETTINGS\"));\nexport var sagaLogout = createAction(\"\".concat(name, \"/\").concat(actionTypes.LOGOUT));\nexport var selectState = function selectState(state) {\n  return state.auth;\n};\nexport var selectUnauthorized = createSelector(selectState, function (state) {\n  return state.unauthorized;\n});\nexport var selectProfile = createSelector(selectState, function (state) {\n  return state.profile;\n});\nexport var selectPwdDialogState = createSelector(selectState, function (state) {\n  return state.pwdDialogState;\n});\nexport var selectSettings = createSelector(selectState, function (state) {\n  return state.settings;\n});\nexport var selectSettingsParameters = createSelector(selectState, function (state) {\n  return state.settings.initData.parameters;\n});\nexport var selectLoadingAuth = createSelector(selectState, function (state) {\n  return state.loadingAuth;\n});\nexport default authSlice;","map":{"version":3,"sources":["D:/TTS_Reactjs/malis-3-frontend/src/store/reducers/auth.reducer.ts"],"names":["createSlice","createAction","createSelector","setCookie","destroyCookie","Router","actionTypes","name","resetState","initialState","access_token","loading","unauthorized","loadingAuth","profile","user_id","first_name","last_name","email","valid_until","user_name","updated_at","group_membership","default_language_id","pwdDialogState","open","settings","initData","parameters","PAGES","PLLA","timezones","detail","default_language","home_page","time_zone","authSlice","reducers","saveTokenLogin","state","payload","remember","maxAge","redirect_to","push","setLoading","setUnauthorized","setProfile","logout","setPwDialogState","setProfileAvatar","avatar","setSettingInitData","setLoadingAuth","setSettingDetail","setDefaultLanguage","extraReducers","type","actions","sagaLogin","LOGIN","sagaGetProfile","GET_PROFILE","sagaChangePassword","CHANGE_PASSWORD","sagaGetSettings","sagaSaveSettings","sagaLogout","LOGOUT","selectState","auth","selectUnauthorized","selectProfile","selectPwdDialogState","selectSettings","selectSettingsParameters","selectLoadingAuth"],"mappings":"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","sourcesContent":["import { createSlice, createAction, PayloadAction, createSelector } from '@reduxjs/toolkit'\nimport { setCookie, destroyCookie } from 'nookies'\nimport Router from 'next/router'\n\nimport { actionTypes } from '@/utils/constant'\n\nimport type { LoginData, Profile, SettingDetail, SettingInitData } from '@/types/Auth'\nimport type { RootReducerType } from './rootReducer'\n\nexport const name = 'auth'\n\nexport const resetState = createAction(`${name}/RESET_STATE`)\n\nexport const initialState = {\n  access_token: '',\n  loading: false,\n  unauthorized: false,\n  loadingAuth: false,\n  profile: {\n    user_id: '',\n    first_name: '',\n    last_name: '',\n    email: '',\n    valid_until: '',\n    user_name: '',\n    updated_at: '',\n    group_membership: [],\n    default_language_id: null\n  } as Profile,\n  pwdDialogState: {\n    loading: false,\n    open: false\n  },\n  settings: {\n    initData: {\n      parameters: {\n        PAGES: [],\n        PLLA: []\n      },\n      timezones: []\n    } as SettingInitData,\n    detail: {\n      default_language: null,\n      home_page: null,\n      time_zone: ''\n    } as SettingDetail\n  }\n}\n\nconst authSlice = createSlice({\n  name,\n  initialState,\n  reducers: {\n    saveTokenLogin(\n      state,\n      {\n        payload\n      }: PayloadAction<{\n        access_token: string\n        remember: boolean\n        redirect_to: string\n      }>\n    ) {\n      state.access_token = payload.access_token\n      if (payload.remember) {\n        setCookie(null, 'token', payload.access_token, {\n          maxAge: 60 * 60 * 24 // 1 day\n        })\n      } else {\n        setCookie(null, 'token', payload.access_token)\n      }\n      setCookie(null, 'redirect_to', payload.redirect_to, {\n        maxAge: 60 * 60 * 24 * 365\n      })\n      Router.push(payload.redirect_to)\n    },\n    setLoading(state, { payload }: PayloadAction<boolean>) {\n      state.loading = payload\n    },\n    setUnauthorized(state, { payload }: PayloadAction<boolean>) {\n      state.unauthorized = payload\n    },\n    setProfile(state, { payload }: PayloadAction<Profile>) {\n      state.profile = payload\n    },\n    logout(state) {\n      destroyCookie(null, 'token')\n      destroyCookie(null, 'redirect_to')\n      destroyCookie(null, 'current_job_id')\n      state.unauthorized = false\n      state.access_token = ''\n      Router.push('/login')\n    },\n    setPwDialogState(state, { payload }: PayloadAction<Partial<typeof initialState.pwdDialogState>>) {\n      state.pwdDialogState = {\n        ...state.pwdDialogState,\n        ...payload\n      }\n    },\n    setProfileAvatar(state, { payload }: PayloadAction<string>) {\n      state.profile.avatar = payload\n    },\n    setSettingInitData(state, { payload }: PayloadAction<SettingInitData>) {\n      state.settings.initData = payload\n    },\n    setLoadingAuth(state, { payload }: PayloadAction<boolean>) {\n      state.loadingAuth = payload\n    },\n    setSettingDetail(state, { payload }: PayloadAction<Partial<SettingDetail>>) {\n      state.settings.detail = {\n        ...state.settings.detail,\n        ...payload\n      }\n    },\n    setDefaultLanguage(state, { payload }: PayloadAction<number>) {\n      state.profile.default_language_id = payload\n    }\n  },\n  extraReducers: {\n    [resetState.type]() {\n      return initialState\n    }\n  }\n})\n\n// Actions\nexport const { actions } = authSlice\n\n// Saga actions\n\nexport const sagaLogin = createAction<LoginData>(`${name}/${actionTypes.LOGIN}`)\nexport const sagaGetProfile = createAction(`${name}/${actionTypes.GET_PROFILE}`)\nexport const sagaChangePassword = createAction<{ new_password: string; old_password: string }>(\n  `${name}/${actionTypes.CHANGE_PASSWORD}`\n)\nexport const sagaGetSettings = createAction(`${name}/GET_SETTINGS`)\nexport const sagaSaveSettings = createAction<SettingDetail>(`${name}/SAVE_SETTINGS`)\nexport const sagaLogout = createAction<{ confirm: string }>(`${name}/${actionTypes.LOGOUT}`)\n\nexport const selectState = (state: RootReducerType) => state.auth\nexport const selectUnauthorized = createSelector(selectState, (state) => state.unauthorized)\nexport const selectProfile = createSelector(selectState, (state) => state.profile)\nexport const selectPwdDialogState = createSelector(selectState, (state) => state.pwdDialogState)\nexport const selectSettings = createSelector(selectState, (state) => state.settings)\n\nexport const selectSettingsParameters = createSelector(selectState, (state) => state.settings.initData.parameters)\n\nexport const selectLoadingAuth = createSelector(selectState, (state) => state.loadingAuth)\n\nexport default authSlice\n"]},"metadata":{},"sourceType":"module"}