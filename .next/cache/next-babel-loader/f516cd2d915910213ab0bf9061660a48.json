{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar _marked = /*#__PURE__*/_regeneratorRuntime.mark(fetchGenerateCode),\n    _marked2 = /*#__PURE__*/_regeneratorRuntime.mark(openPartCreateDialog),\n    _marked3 = /*#__PURE__*/_regeneratorRuntime.mark(changePartDrawing),\n    _marked4 = /*#__PURE__*/_regeneratorRuntime.mark(getPartRefItem),\n    _marked5 = /*#__PURE__*/_regeneratorRuntime.mark(createPart),\n    _marked6 = /*#__PURE__*/_regeneratorRuntime.mark(fetchPartDetail),\n    _marked7 = /*#__PURE__*/_regeneratorRuntime.mark(openPartUpdateDialog),\n    _marked8 = /*#__PURE__*/_regeneratorRuntime.mark(updatePart),\n    _marked9 = /*#__PURE__*/_regeneratorRuntime.mark(closePartDialog),\n    _marked10 = /*#__PURE__*/_regeneratorRuntime.mark(itemSelectEquiv),\n    _marked11 = /*#__PURE__*/_regeneratorRuntime.mark(openManuDialog),\n    _marked12 = /*#__PURE__*/_regeneratorRuntime.mark(createManu),\n    _marked13 = /*#__PURE__*/_regeneratorRuntime.mark(closeManuDialog),\n    _marked14 = /*#__PURE__*/_regeneratorRuntime.mark(getManuId),\n    _marked15 = /*#__PURE__*/_regeneratorRuntime.mark(getItemCopy),\n    _marked16 = /*#__PURE__*/_regeneratorRuntime.mark(getDrawingItems),\n    _marked17 = /*#__PURE__*/_regeneratorRuntime.mark(partSaga);\n\nimport { takeLatest, call, put, putResolve, takeEvery } from 'redux-saga/effects';\nimport { select, all } from 'typed-redux-saga';\nimport { createAction } from '@reduxjs/toolkit';\nimport _ from 'lodash';\nimport { partStore, commonStore, drawingStore } from '@/store/reducers';\nimport * as errorSaga from '@/store/saga/errorSaga';\nimport { StatusCode } from '@/utils/StatusCode';\nimport { getDefaultValues } from '@/utils/getDefaultValues';\nimport { actionTypes } from '@/utils/constant';\nimport { isAssemblyByDpn } from '@/utils/isAssembly';\nimport itemApi from '@/apis/item.api';\nimport assemblyApi from '@/apis/assembly.api';\nimport partRefApi from '@/apis/part.api';\nimport equivalenceApi from '@/apis/equivalence.api';\nimport manufacturerApi from '@/apis/manufacturer.api';\nimport drawingApi from '@/apis/drawing.api';\n\nvar getPartApi = function getPartApi(entity) {\n  return entity === 'item' ? itemApi : assemblyApi;\n};\n\nfunction fetchGenerateCode(entity, drawing) {\n  var partApi, _yield$call, generated_code;\n\n  return _regeneratorRuntime.wrap(function fetchGenerateCode$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          partApi = getPartApi(entity);\n          _context.next = 3;\n          return call(partApi.getGenerateCode, drawing.value);\n\n        case 3:\n          _yield$call = _context.sent;\n          generated_code = _yield$call.generated_code;\n          return _context.abrupt(\"return\", generated_code);\n\n        case 6:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked);\n}\n\nfunction openPartCreateDialog(_ref) {\n  var payload, partApi, _yield$all, userJob, userDrawing, initDetail, _yield$call2, permissions, wiki_page, initData, defaultValues;\n\n  return _regeneratorRuntime.wrap(function openPartCreateDialog$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          payload = _ref.payload;\n          _context2.next = 3;\n          return put(commonStore.actions.setLoadingPage(true));\n\n        case 3:\n          _context2.prev = 3;\n          partApi = getPartApi(payload);\n          return _context2.delegateYield(all({\n            userJob: select(commonStore.selectUserValueJob),\n            userDrawing: select(commonStore.selectUserValueDrawing)\n          }), \"t0\", 6);\n\n        case 6:\n          _yield$all = _context2.t0;\n          userJob = _yield$all.userJob;\n          userDrawing = _yield$all.userDrawing;\n          initDetail = payload === 'item' ? partStore.itemDetail : partStore.assemblyDetail;\n          _context2.next = 12;\n          return call(partApi.getInitDataForCE, {\n            job_id_pk: userJob.value\n          });\n\n        case 12:\n          _yield$call2 = _context2.sent;\n          permissions = _yield$call2.permissions;\n          wiki_page = _yield$call2.wiki_page;\n          initData = _objectWithoutProperties(_yield$call2, [\"permissions\", \"wiki_page\"]);\n          defaultValues = getDefaultValues(initData.parameters, {\n            unit: 'UNIT'\n          }, initDetail);\n          defaultValues.drawing_id = userDrawing.value < 0 ? null : userDrawing;\n          defaultValues.job_id = userJob.value;\n\n          if (!defaultValues.drawing_id) {\n            _context2.next = 23;\n            break;\n          }\n\n          _context2.next = 22;\n          return call(fetchGenerateCode, payload, defaultValues.drawing_id);\n\n        case 22:\n          defaultValues.dpn = _context2.sent;\n\n        case 23:\n          _context2.next = 25;\n          return putResolve(partStore.actions.setInitData(initData));\n\n        case 25:\n          _context2.next = 27;\n          return put(partStore.actions.addPart({\n            detail: defaultValues,\n            wiki_page: wiki_page,\n            permissions: permissions[payload]\n          }));\n\n        case 27:\n          _context2.next = 33;\n          break;\n\n        case 29:\n          _context2.prev = 29;\n          _context2.t1 = _context2[\"catch\"](3);\n          _context2.next = 33;\n          return errorSaga.handleError(_context2.t1);\n\n        case 33:\n          _context2.next = 35;\n          return put(commonStore.actions.setLoadingPage(false));\n\n        case 35:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, _marked2, null, [[3, 29]]);\n}\n\nfunction changePartDrawing(_ref2) {\n  var payload, formData, drawing, entity, partApi, _yield$call3, generated_code;\n\n  return _regeneratorRuntime.wrap(function changePartDrawing$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          payload = _ref2.payload;\n          _context3.next = 3;\n          return put(partStore.actions.setPartLoading(true));\n\n        case 3:\n          _context3.prev = 3;\n          formData = payload.formData, drawing = payload.drawing, entity = payload.entity;\n          partApi = getPartApi(entity);\n          _context3.next = 8;\n          return call(partApi.getGenerateCode, drawing.value);\n\n        case 8:\n          _yield$call3 = _context3.sent;\n          generated_code = _yield$call3.generated_code;\n          _context3.next = 12;\n          return put(partStore.actions.updateCurrentPart(_objectSpread(_objectSpread({}, formData), {}, {\n            dpn: generated_code,\n            drawing_id: drawing\n          })));\n\n        case 12:\n          _context3.next = 18;\n          break;\n\n        case 14:\n          _context3.prev = 14;\n          _context3.t0 = _context3[\"catch\"](3);\n          _context3.next = 18;\n          return errorSaga.handleError(_context3.t0);\n\n        case 18:\n          _context3.next = 20;\n          return put(partStore.actions.setPartLoading(false));\n\n        case 20:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, _marked3, null, [[3, 14]]);\n}\n\nfunction getPartRefItem(_ref3) {\n  var payload, selected_part, _yield$call4, part, message, item, response, status, data;\n\n  return _regeneratorRuntime.wrap(function getPartRefItem$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          payload = _ref3.payload;\n          _context4.next = 3;\n          return put(partStore.actions.setPartLoading(true));\n\n        case 3:\n          _context4.prev = 3;\n          selected_part = payload.selected_part;\n\n          if (!_.isNull(selected_part)) {\n            _context4.next = 10;\n            break;\n          }\n\n          _context4.next = 8;\n          return put(partStore.actions.updateCurrentPart({\n            reference_to: null\n          }));\n\n        case 8:\n          _context4.next = 28;\n          break;\n\n        case 10:\n          _context4.next = 12;\n          return call(partRefApi.getReferencedPart, payload);\n\n        case 12:\n          _yield$call4 = _context4.sent;\n          part = _yield$call4.part;\n          message = _yield$call4.message;\n          item = _.pick(part, ['descriptions', 'manufacturer_equiv', 'manufacturers', 'mass', 'material_equiv', 'unit', 'manufacturer_equiv_standards', 'material_equiv_standards']);\n          item.reference_to = {\n            description: '',\n            entity_id: part.dpn,\n            value: part.id\n          };\n          item.manufacturer_equiv = part.manufacturer_equiv_object;\n          item.material_equiv = part.material_equiv_object;\n          _context4.next = 21;\n          return putResolve(partStore.actions.updateCurrentPart(item));\n\n        case 21:\n          if (!(selected_part !== part.id)) {\n            _context4.next = 26;\n            break;\n          }\n\n          _context4.next = 24;\n          return put(partStore.actions.setConfirmRef({\n            open: true,\n            message: message\n          }));\n\n        case 24:\n          _context4.next = 28;\n          break;\n\n        case 26:\n          _context4.next = 28;\n          return put(commonStore.actions.setSuccessMessage(message));\n\n        case 28:\n          _context4.next = 42;\n          break;\n\n        case 30:\n          _context4.prev = 30;\n          _context4.t0 = _context4[\"catch\"](3);\n          response = _context4.t0.response;\n\n          if (!_.isNil(response)) {\n            _context4.next = 38;\n            break;\n          }\n\n          _context4.next = 36;\n          return errorSaga.handleError(_context4.t0);\n\n        case 36:\n          _context4.next = 42;\n          break;\n\n        case 38:\n          status = response.status, data = response.data;\n\n          if (!(status === StatusCode.BAD_REQUEST)) {\n            _context4.next = 42;\n            break;\n          }\n\n          _context4.next = 42;\n          return put(partStore.actions.setConfirmRef({\n            open: true,\n            message: data.message\n          }));\n\n        case 42:\n          _context4.next = 44;\n          return put(partStore.actions.setPartLoading(false));\n\n        case 44:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, _marked4, null, [[3, 30]]);\n}\n\nfunction createPart(_ref4) {\n  var payload, entity, formData, partApi, _yield$call5, message, _yield$all2, userJob, userDrawing, generateCode;\n\n  return _regeneratorRuntime.wrap(function createPart$(_context5) {\n    while (1) {\n      switch (_context5.prev = _context5.next) {\n        case 0:\n          payload = _ref4.payload;\n          _context5.next = 3;\n          return put(partStore.actions.setPartLoading(true));\n\n        case 3:\n          _context5.prev = 3;\n          entity = payload.entity, formData = payload.formData;\n          partApi = getPartApi(entity);\n          _context5.next = 8;\n          return call(partApi.create, formData);\n\n        case 8:\n          _yield$call5 = _context5.sent;\n          message = _yield$call5.message;\n          return _context5.delegateYield(all({\n            userJob: select(commonStore.selectUserValueJob),\n            userDrawing: select(commonStore.selectUserValueDrawing)\n          }), \"t0\", 11);\n\n        case 11:\n          _yield$all2 = _context5.t0;\n          userJob = _yield$all2.userJob;\n          userDrawing = _yield$all2.userDrawing;\n          generateCode = '';\n\n          if (!(userDrawing.value >= 0)) {\n            _context5.next = 19;\n            break;\n          }\n\n          _context5.next = 18;\n          return call(fetchGenerateCode, entity, userDrawing);\n\n        case 18:\n          generateCode = _context5.sent;\n\n        case 19:\n          _context5.next = 21;\n          return putResolve(partStore.actions.resetCurrentPart({\n            userJob: userJob,\n            userDrawing: userDrawing,\n            generateCode: generateCode\n          }));\n\n        case 21:\n          _context5.next = 23;\n          return all([put(commonStore.actions.setSuccessMessage(message)), put(partStore.actions.setPartTab(0))]);\n\n        case 23:\n          _context5.next = 29;\n          break;\n\n        case 25:\n          _context5.prev = 25;\n          _context5.t1 = _context5[\"catch\"](3);\n          _context5.next = 29;\n          return errorSaga.handleError(_context5.t1);\n\n        case 29:\n          _context5.next = 31;\n          return put(partStore.actions.setPartLoading(false));\n\n        case 31:\n        case \"end\":\n          return _context5.stop();\n      }\n    }\n  }, _marked5, null, [[3, 25]]);\n}\n\nvar getPartDpn = function getPartDpn(entity, dpn) {\n  // const type = entity === 'item' ? 'H' : 'G'\n  var regexItem = /H\\S+/g;\n  var regexAssembly = /G\\S+/g;\n  var regex = entity === 'item' ? regexItem : regexAssembly;\n  var match = dpn.match(regex);\n\n  if (_.isArray(match)) {\n    return match[0];\n  }\n\n  return '';\n};\n\nfunction fetchPartDetail(entity, id) {\n  var partApi, data, partDetail;\n  return _regeneratorRuntime.wrap(function fetchPartDetail$(_context6) {\n    while (1) {\n      switch (_context6.prev = _context6.next) {\n        case 0:\n          partApi = getPartApi(entity);\n          _context6.next = 3;\n          return call(partApi.getDetail, id);\n\n        case 3:\n          data = _context6.sent;\n          partDetail = data[entity];\n          partDetail.dpn = getPartDpn(entity, partDetail.dpn);\n          partDetail.drawing_id = partDetail.related_drawing;\n          partDetail.items = (partDetail.components || []).map(function (_ref5) {\n            var id = _ref5.id,\n                quantity = _ref5.quantity;\n            return {\n              item_id: id,\n              quantity: quantity\n            };\n          });\n\n          if (entity === 'item') {\n            partDetail.manufacturer_equiv = partDetail.manufacturer_equiv_object;\n            partDetail.material_equiv = partDetail.material_equiv_object;\n          }\n\n          return _context6.abrupt(\"return\", partDetail);\n\n        case 10:\n        case \"end\":\n          return _context6.stop();\n      }\n    }\n  }, _marked6);\n}\n\nfunction openPartUpdateDialog(_ref6) {\n  var payload, id, entity, partApi, partDetail, _yield$call6, permissions, wiki_page, initData;\n\n  return _regeneratorRuntime.wrap(function openPartUpdateDialog$(_context7) {\n    while (1) {\n      switch (_context7.prev = _context7.next) {\n        case 0:\n          payload = _ref6.payload;\n          _context7.next = 3;\n          return put(commonStore.actions.setLoadingPage(true));\n\n        case 3:\n          _context7.prev = 3;\n          id = payload.id, entity = payload.entity;\n          partApi = getPartApi(entity);\n          _context7.next = 8;\n          return call(fetchPartDetail, entity, id);\n\n        case 8:\n          partDetail = _context7.sent;\n          _context7.next = 11;\n          return call(partApi.getInitDataForCE, {\n            job_id_pk: partDetail.job_id\n          });\n\n        case 11:\n          _yield$call6 = _context7.sent;\n          permissions = _yield$call6.permissions;\n          wiki_page = _yield$call6.wiki_page;\n          initData = _objectWithoutProperties(_yield$call6, [\"permissions\", \"wiki_page\"]);\n          _context7.next = 17;\n          return putResolve(partStore.actions.setInitData(initData));\n\n        case 17:\n          _context7.next = 19;\n          return put(partStore.actions.addPart({\n            detail: partDetail,\n            wiki_page: wiki_page,\n            permissions: permissions[entity]\n          }));\n\n        case 19:\n          _context7.next = 25;\n          break;\n\n        case 21:\n          _context7.prev = 21;\n          _context7.t0 = _context7[\"catch\"](3);\n          _context7.next = 25;\n          return errorSaga.handleError(_context7.t0);\n\n        case 25:\n          _context7.next = 27;\n          return put(commonStore.actions.setLoadingPage(false));\n\n        case 27:\n        case \"end\":\n          return _context7.stop();\n      }\n    }\n  }, _marked7, null, [[3, 21]]);\n}\n\nfunction updatePart(_ref7) {\n  var payload, entity, formData, id, partApi, _yield$call7, message;\n\n  return _regeneratorRuntime.wrap(function updatePart$(_context8) {\n    while (1) {\n      switch (_context8.prev = _context8.next) {\n        case 0:\n          payload = _ref7.payload;\n          _context8.next = 3;\n          return put(partStore.actions.setPartLoading(true));\n\n        case 3:\n          _context8.prev = 3;\n          entity = payload.entity, formData = payload.formData, id = payload.id;\n          partApi = getPartApi(entity);\n          _context8.next = 8;\n          return call(partApi.update, id, formData);\n\n        case 8:\n          _yield$call7 = _context8.sent;\n          message = _yield$call7.message;\n          _context8.next = 12;\n          return call(closePartDialog);\n\n        case 12:\n          _context8.next = 14;\n          return put(commonStore.actions.setSuccessMessage(message));\n\n        case 14:\n          _context8.next = 20;\n          break;\n\n        case 16:\n          _context8.prev = 16;\n          _context8.t0 = _context8[\"catch\"](3);\n          _context8.next = 20;\n          return errorSaga.handleError(_context8.t0);\n\n        case 20:\n          _context8.next = 22;\n          return put(partStore.actions.setPartLoading(false));\n\n        case 22:\n        case \"end\":\n          return _context8.stop();\n      }\n    }\n  }, _marked8, null, [[3, 16]]);\n}\n\nfunction closePartDialog() {\n  var partList, entity, _$last, detail, partEntity, partDetail, getListAction;\n\n  return _regeneratorRuntime.wrap(function closePartDialog$(_context9) {\n    while (1) {\n      switch (_context9.prev = _context9.next) {\n        case 0:\n          _context9.prev = 0;\n          _context9.next = 3;\n          return putResolve(partStore.actions.removePart());\n\n        case 3:\n          return _context9.delegateYield(select(partStore.selectPartList), \"t0\", 4);\n\n        case 4:\n          partList = _context9.t0;\n          return _context9.delegateYield(select(commonStore.selectEntity), \"t1\", 6);\n\n        case 6:\n          entity = _context9.t1;\n\n          if (!(partList.length > 0)) {\n            _context9.next = 19;\n            break;\n          }\n\n          _$last = _.last(partList), detail = _$last.detail;\n          partEntity = detail.is_assembly ? 'assembly' : 'item';\n          _context9.next = 12;\n          return call(fetchPartDetail, partEntity, detail.id);\n\n        case 12:\n          partDetail = _context9.sent;\n          _context9.next = 15;\n          return put(partStore.actions.updateCurrentPart(partDetail));\n\n        case 15:\n          if (!isAssemblyByDpn(detail.dpn)) {\n            _context9.next = 18;\n            break;\n          }\n\n          _context9.next = 18;\n          return call(getDrawingItems, {\n            type: '',\n            payload: partDetail.related_drawing.value\n          });\n\n        case 18:\n          return _context9.abrupt(\"return\");\n\n        case 19:\n          if (!(entity === 'drawing')) {\n            _context9.next = 24;\n            break;\n          }\n\n          _context9.next = 22;\n          return put(drawingStore.sagaGetDrawingPartList());\n\n        case 22:\n          _context9.next = 27;\n          break;\n\n        case 24:\n          getListAction = createAction(\"\".concat(entity, \"/\").concat(actionTypes.GET_LIST));\n          _context9.next = 27;\n          return put(getListAction());\n\n        case 27:\n          _context9.next = 33;\n          break;\n\n        case 29:\n          _context9.prev = 29;\n          _context9.t2 = _context9[\"catch\"](0);\n          _context9.next = 33;\n          return errorSaga.handleError(_context9.t2);\n\n        case 33:\n        case \"end\":\n          return _context9.stop();\n      }\n    }\n  }, _marked9, null, [[0, 29]]);\n}\n\nfunction itemSelectEquiv(_ref8) {\n  var payload, _partStore$actions$up, type, equiv, _yield$call8, standards, equivKey, standardKey;\n\n  return _regeneratorRuntime.wrap(function itemSelectEquiv$(_context10) {\n    while (1) {\n      switch (_context10.prev = _context10.next) {\n        case 0:\n          payload = _ref8.payload;\n          _context10.next = 3;\n          return put(partStore.actions.setPartLoading(true));\n\n        case 3:\n          _context10.prev = 3;\n          type = payload.type, equiv = payload.equiv;\n          _context10.next = 7;\n          return call(equivalenceApi.getEquivalenceStandards, equiv.value);\n\n        case 7:\n          _yield$call8 = _context10.sent;\n          standards = _yield$call8.standards;\n          equivKey = type === 'manufacturing_standard' ? 'manufacturer_equiv' : 'material_equiv';\n          standardKey = \"\".concat(equivKey, \"_standards\");\n          _context10.next = 13;\n          return put(partStore.actions.updateCurrentPart((_partStore$actions$up = {}, _defineProperty(_partStore$actions$up, equivKey, equiv), _defineProperty(_partStore$actions$up, standardKey, standards), _partStore$actions$up)));\n\n        case 13:\n          _context10.next = 19;\n          break;\n\n        case 15:\n          _context10.prev = 15;\n          _context10.t0 = _context10[\"catch\"](3);\n          _context10.next = 19;\n          return errorSaga.handleError(_context10.t0);\n\n        case 19:\n          _context10.next = 21;\n          return put(partStore.actions.setPartLoading(false));\n\n        case 21:\n        case \"end\":\n          return _context10.stop();\n      }\n    }\n  }, _marked10, null, [[3, 15]]);\n}\n\nfunction openManuDialog(_ref9) {\n  var payload, _yield$call9, next_code, initData;\n\n  return _regeneratorRuntime.wrap(function openManuDialog$(_context11) {\n    while (1) {\n      switch (_context11.prev = _context11.next) {\n        case 0:\n          payload = _ref9.payload;\n          _context11.next = 3;\n          return put(partStore.actions.setPartLoading(true));\n\n        case 3:\n          _context11.prev = 3;\n          _context11.next = 6;\n          return put(partStore.actions.updateCurrentPart(payload));\n\n        case 6:\n          _context11.next = 8;\n          return call(manufacturerApi.getInitDataForCE);\n\n        case 8:\n          _yield$call9 = _context11.sent;\n          next_code = _yield$call9.next_code;\n          initData = _objectWithoutProperties(_yield$call9, [\"next_code\"]);\n          _context11.next = 13;\n          return all([putResolve(partStore.actions.setManuDetail({\n            manufacturer_id: next_code\n          })), putResolve(partStore.actions.setManuInitData(initData))]);\n\n        case 13:\n          _context11.next = 15;\n          return put(partStore.actions.setManuDialogOpen(true));\n\n        case 15:\n          _context11.next = 21;\n          break;\n\n        case 17:\n          _context11.prev = 17;\n          _context11.t0 = _context11[\"catch\"](3);\n          _context11.next = 21;\n          return errorSaga.handleError(_context11.t0);\n\n        case 21:\n          _context11.next = 23;\n          return put(partStore.actions.setPartLoading(false));\n\n        case 23:\n        case \"end\":\n          return _context11.stop();\n      }\n    }\n  }, _marked11, null, [[3, 17]]);\n}\n\nfunction createManu(_ref10) {\n  var payload, _yield$call10, message, id, _yield$call11, next_code, name;\n\n  return _regeneratorRuntime.wrap(function createManu$(_context12) {\n    while (1) {\n      switch (_context12.prev = _context12.next) {\n        case 0:\n          payload = _ref10.payload;\n          _context12.next = 3;\n          return put(partStore.actions.setManuDialogLoading(true));\n\n        case 3:\n          _context12.prev = 3;\n          _context12.next = 6;\n          return call(manufacturerApi.create, payload);\n\n        case 6:\n          _yield$call10 = _context12.sent;\n          message = _yield$call10.message;\n          id = _yield$call10.id;\n          _context12.next = 11;\n          return call(manufacturerApi.getInitDataForCE);\n\n        case 11:\n          _yield$call11 = _context12.sent;\n          next_code = _yield$call11.next_code;\n          name = payload.name;\n          _context12.next = 16;\n          return putResolve(partStore.actions.setManuDetail(_objectSpread(_objectSpread({}, partStore.initialState.manufacturer.detail), {}, {\n            manufacturer_id: next_code\n          })));\n\n        case 16:\n          _context12.next = 18;\n          return all([put(commonStore.actions.setSuccessMessage(message)), put(partStore.actions.addManufacturer({\n            manufacturer_id: id,\n            reference: '',\n            description: name\n          }))]);\n\n        case 18:\n          _context12.next = 24;\n          break;\n\n        case 20:\n          _context12.prev = 20;\n          _context12.t0 = _context12[\"catch\"](3);\n          _context12.next = 24;\n          return errorSaga.handleError(_context12.t0);\n\n        case 24:\n          _context12.next = 26;\n          return put(partStore.actions.setManuDialogLoading(false));\n\n        case 26:\n        case \"end\":\n          return _context12.stop();\n      }\n    }\n  }, _marked12, null, [[3, 20]]);\n}\n\nfunction closeManuDialog() {\n  return _regeneratorRuntime.wrap(function closeManuDialog$(_context13) {\n    while (1) {\n      switch (_context13.prev = _context13.next) {\n        case 0:\n          _context13.next = 2;\n          return putResolve(partStore.actions.setManuDialogOpen(false));\n\n        case 2:\n          _context13.next = 4;\n          return put(partStore.actions.setManuDetail({\n            manufacturer_id: null,\n            name: ''\n          }));\n\n        case 4:\n        case \"end\":\n          return _context13.stop();\n      }\n    }\n  }, _marked13);\n}\n\nfunction getManuId(_ref11) {\n  var payload, _yield$call12, generated_code;\n\n  return _regeneratorRuntime.wrap(function getManuId$(_context14) {\n    while (1) {\n      switch (_context14.prev = _context14.next) {\n        case 0:\n          payload = _ref11.payload;\n          _context14.next = 3;\n          return put(partStore.actions.setManuDialogLoading(true));\n\n        case 3:\n          _context14.prev = 3;\n          _context14.next = 6;\n          return call(manufacturerApi.getNextCode, payload.manufacturer_id);\n\n        case 6:\n          _yield$call12 = _context14.sent;\n          generated_code = _yield$call12.generated_code;\n          _context14.next = 10;\n          return put(partStore.actions.setManuDetail(_objectSpread(_objectSpread({}, payload), {}, {\n            manufacturer_id: generated_code\n          })));\n\n        case 10:\n          _context14.next = 16;\n          break;\n\n        case 12:\n          _context14.prev = 12;\n          _context14.t0 = _context14[\"catch\"](3);\n          _context14.next = 16;\n          return errorSaga.handleError(_context14.t0);\n\n        case 16:\n          _context14.next = 18;\n          return put(partStore.actions.setManuDialogLoading(false));\n\n        case 18:\n        case \"end\":\n          return _context14.stop();\n      }\n    }\n  }, _marked14, null, [[3, 12]]);\n}\n\nfunction getItemCopy(_ref12) {\n  var payload, data, part;\n  return _regeneratorRuntime.wrap(function getItemCopy$(_context15) {\n    while (1) {\n      switch (_context15.prev = _context15.next) {\n        case 0:\n          payload = _ref12.payload;\n          _context15.next = 3;\n          return put(partStore.actions.setPartLoading(true));\n\n        case 3:\n          _context15.prev = 3;\n          _context15.next = 6;\n          return call(partRefApi.getDetail, payload.value);\n\n        case 6:\n          data = _context15.sent;\n          // get the allowed attributes\n          part = _.pick(data.part, ['descriptions', 'manufacturer_equiv', 'manufacturers', 'mass', 'material_equiv', 'unit', 'manufacturer_equiv_standards', 'material_equiv_standards']);\n          part.manufacturer_equiv = data.part.manufacturer_equiv_object;\n          part.material_equiv = data.part.material_equiv_object;\n          _context15.next = 12;\n          return put(partStore.actions.updateCurrentPart(part));\n\n        case 12:\n          _context15.next = 14;\n          return put(commonStore.actions.setSuccessMessage(data.message));\n\n        case 14:\n          _context15.next = 20;\n          break;\n\n        case 16:\n          _context15.prev = 16;\n          _context15.t0 = _context15[\"catch\"](3);\n          _context15.next = 20;\n          return errorSaga.handleError(_context15.t0);\n\n        case 20:\n          _context15.next = 22;\n          return put(partStore.actions.setPartLoading(false));\n\n        case 22:\n        case \"end\":\n          return _context15.stop();\n      }\n    }\n  }, _marked15, null, [[3, 16]]);\n}\n\nfunction getDrawingItems(_ref13) {\n  var payload, _yield$call13, items;\n\n  return _regeneratorRuntime.wrap(function getDrawingItems$(_context16) {\n    while (1) {\n      switch (_context16.prev = _context16.next) {\n        case 0:\n          payload = _ref13.payload;\n          _context16.next = 3;\n          return put(partStore.actions.setPartLoading(true));\n\n        case 3:\n          _context16.prev = 3;\n          _context16.next = 6;\n          return call(drawingApi.getItemList, payload);\n\n        case 6:\n          _yield$call13 = _context16.sent;\n          items = _yield$call13.items;\n          _context16.next = 10;\n          return put(partStore.actions.setDrawingItems(items));\n\n        case 10:\n          _context16.next = 16;\n          break;\n\n        case 12:\n          _context16.prev = 12;\n          _context16.t0 = _context16[\"catch\"](3);\n          _context16.next = 16;\n          return errorSaga.handleError(_context16.t0);\n\n        case 16:\n          _context16.next = 18;\n          return put(partStore.actions.setPartLoading(false));\n\n        case 18:\n        case \"end\":\n          return _context16.stop();\n      }\n    }\n  }, _marked16, null, [[3, 12]]);\n}\n\nfunction partSaga() {\n  return _regeneratorRuntime.wrap(function partSaga$(_context17) {\n    while (1) {\n      switch (_context17.prev = _context17.next) {\n        case 0:\n          _context17.next = 2;\n          return takeLatest(partStore.sagaOpenCreateDialog, openPartCreateDialog);\n\n        case 2:\n          _context17.next = 4;\n          return takeLatest(partStore.sagaChangeDrawing, changePartDrawing);\n\n        case 4:\n          _context17.next = 6;\n          return takeLatest(partStore.sagaGetPartRefItem, getPartRefItem);\n\n        case 6:\n          _context17.next = 8;\n          return takeLatest(partStore.sagaCreate, createPart);\n\n        case 8:\n          _context17.next = 10;\n          return takeLatest(partStore.sagaOpenUpdateDialog, openPartUpdateDialog);\n\n        case 10:\n          _context17.next = 12;\n          return takeLatest(partStore.sagaUpdate, updatePart);\n\n        case 12:\n          _context17.next = 14;\n          return takeEvery(partStore.sagaCloseDialog, closePartDialog);\n\n        case 14:\n          _context17.next = 16;\n          return takeLatest(partStore.sagaSelectEquiv, itemSelectEquiv);\n\n        case 16:\n          _context17.next = 18;\n          return takeLatest(partStore.sagaOpenManuDialog, openManuDialog);\n\n        case 18:\n          _context17.next = 20;\n          return takeEvery(partStore.sagaCreateManu, createManu);\n\n        case 20:\n          _context17.next = 22;\n          return takeEvery(partStore.sagaCloseManuDialog, closeManuDialog);\n\n        case 22:\n          _context17.next = 24;\n          return takeLatest(partStore.sagaGetManuId, getManuId);\n\n        case 24:\n          _context17.next = 26;\n          return takeLatest(partStore.sagaGetItemCopy, getItemCopy);\n\n        case 26:\n          _context17.next = 28;\n          return takeLatest(partStore.sagaGetDrawingItems, getDrawingItems);\n\n        case 28:\n        case \"end\":\n          return _context17.stop();\n      }\n    }\n  }, _marked17);\n}\n\nexport default partSaga;","map":null,"metadata":{},"sourceType":"module"}