{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar _marked = /*#__PURE__*/_regeneratorRuntime.mark(fetchInitDataForList),\n    _marked2 = /*#__PURE__*/_regeneratorRuntime.mark(fetchList),\n    _marked3 = /*#__PURE__*/_regeneratorRuntime.mark(fetchInitDataForCE),\n    _marked4 = /*#__PURE__*/_regeneratorRuntime.mark(fetchDetail),\n    _marked5 = /*#__PURE__*/_regeneratorRuntime.mark(getCurrencyList),\n    _marked6 = /*#__PURE__*/_regeneratorRuntime.mark(changeUserCurrency),\n    _marked7 = /*#__PURE__*/_regeneratorRuntime.mark(openCurrencyCreateDialog),\n    _marked8 = /*#__PURE__*/_regeneratorRuntime.mark(createCurrency),\n    _marked9 = /*#__PURE__*/_regeneratorRuntime.mark(openCurrencyUpdateDialog),\n    _marked10 = /*#__PURE__*/_regeneratorRuntime.mark(updateCurrency),\n    _marked11 = /*#__PURE__*/_regeneratorRuntime.mark(closeCurrencyDialog),\n    _marked12 = /*#__PURE__*/_regeneratorRuntime.mark(currencySaga);\n\nimport { takeEvery, takeLatest, put } from 'redux-saga/effects';\nimport { call, select, all } from 'typed-redux-saga';\nimport { advancedFilterActions, commonStore, currencyStore } from '@/store/reducers';\nimport _ from 'lodash';\nimport currencyApi from '@/apis/currency.api';\nimport * as constant from '@/utils/constant';\nimport AppNumber from '@/helper/AppNumber';\n\nfunction fetchInitDataForList() {\n  var userBaseCurrency, data;\n  return _regeneratorRuntime.wrap(function fetchInitDataForList$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          return _context.delegateYield(select(currencyStore.selectUserBaseCurrency), \"t0\", 1);\n\n        case 1:\n          userBaseCurrency = _context.t0;\n          _context.next = 4;\n          return call(currencyApi.getInitDataForList);\n\n        case 4:\n          data = _context.sent;\n\n          if (!_.isNull(userBaseCurrency.id)) {\n            data.user_base_currency = userBaseCurrency;\n          }\n\n          _context.next = 8;\n          return put(currencyStore.actions.setInitDataForList(data));\n\n        case 8:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked);\n}\n\nfunction fetchList() {\n  var _yield$all, tableState, searchQuery, filterData, baseCurrency, page, per_page, data;\n\n  return _regeneratorRuntime.wrap(function fetchList$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          return _context2.delegateYield(all({\n            tableState: select(commonStore.selectTableState),\n            searchQuery: select(commonStore.selectSearchQuery),\n            filterData: select(advancedFilterActions.selectFilterData),\n            baseCurrency: select(currencyStore.selectUserBaseCurrency)\n          }), \"t0\", 1);\n\n        case 1:\n          _yield$all = _context2.t0;\n          tableState = _yield$all.tableState;\n          searchQuery = _yield$all.searchQuery;\n          filterData = _yield$all.filterData;\n          baseCurrency = _yield$all.baseCurrency;\n          page = tableState.page, per_page = tableState.per_page;\n          _context2.next = 9;\n          return call(currencyApi.getList, _objectSpread({\n            base_currency_id: baseCurrency.id,\n            page: page,\n            per_page: per_page,\n            s: searchQuery\n          }, filterData));\n\n        case 9:\n          data = _context2.sent;\n          _context2.next = 12;\n          return put(commonStore.actions.setTableState({\n            total_items: data.total_items\n          }));\n\n        case 12:\n          _context2.next = 14;\n          return put(currencyStore.actions.setDataList(data.currency_list));\n\n        case 14:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, _marked2);\n}\n\nfunction fetchInitDataForCE() {\n  var _yield$select, base_currency_id, data;\n\n  return _regeneratorRuntime.wrap(function fetchInitDataForCE$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          return _context3.delegateYield(select(currencyStore.selectUserBaseCurrency), \"t0\", 1);\n\n        case 1:\n          _yield$select = _context3.t0;\n          base_currency_id = _yield$select.id;\n          _context3.next = 5;\n          return call(currencyApi.getInitDataForCE, {\n            base_currency_id: base_currency_id\n          });\n\n        case 5:\n          data = _context3.sent;\n          _context3.next = 8;\n          return put(currencyStore.actions.setInitDataForCE(data));\n\n        case 8:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, _marked3);\n}\n\nfunction fetchDetail(id) {\n  var _yield$call, currency;\n\n  return _regeneratorRuntime.wrap(function fetchDetail$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          _context4.next = 2;\n          return call(currencyApi.getDetail, id);\n\n        case 2:\n          _yield$call = _context4.sent;\n          currency = _yield$call.currency;\n          currency.rate = AppNumber.format(currency.rate, constant.currencyRateFormat);\n          _context4.next = 7;\n          return put(currencyStore.actions.setDetail(currency));\n\n        case 7:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, _marked4);\n}\n\nexport function getCurrencyList() {\n  var permissions;\n  return _regeneratorRuntime.wrap(function getCurrencyList$(_context5) {\n    while (1) {\n      switch (_context5.prev = _context5.next) {\n        case 0:\n          _context5.next = 2;\n          return put(commonStore.actions.setLoadingPage(true));\n\n        case 2:\n          _context5.prev = 2;\n          _context5.next = 5;\n          return call(fetchInitDataForList);\n\n        case 5:\n          return _context5.delegateYield(select(currencyStore.selectPermissions), \"t0\", 6);\n\n        case 6:\n          permissions = _context5.t0;\n\n          if (!(permissions === null || permissions === void 0 ? void 0 : permissions.view)) {\n            _context5.next = 10;\n            break;\n          }\n\n          _context5.next = 10;\n          return call(fetchList);\n\n        case 10:\n          _context5.next = 16;\n          break;\n\n        case 12:\n          _context5.prev = 12;\n          _context5.t1 = _context5[\"catch\"](2);\n          _context5.next = 16;\n          return put(commonStore.actions.setError(_context5.t1));\n\n        case 16:\n          _context5.next = 18;\n          return put(commonStore.actions.setLoadingPage(false));\n\n        case 18:\n        case \"end\":\n          return _context5.stop();\n      }\n    }\n  }, _marked5, null, [[2, 12]]);\n}\nexport function changeUserCurrency(_ref) {\n  var payload;\n  return _regeneratorRuntime.wrap(function changeUserCurrency$(_context6) {\n    while (1) {\n      switch (_context6.prev = _context6.next) {\n        case 0:\n          payload = _ref.payload;\n          _context6.next = 3;\n          return put(commonStore.actions.setLoadingPage(true));\n\n        case 3:\n          _context6.prev = 3;\n          _context6.next = 6;\n          return put(currencyStore.actions.setUserBaseCurrency(payload));\n\n        case 6:\n          _context6.next = 8;\n          return call(fetchList);\n\n        case 8:\n          _context6.next = 14;\n          break;\n\n        case 10:\n          _context6.prev = 10;\n          _context6.t0 = _context6[\"catch\"](3);\n          _context6.next = 14;\n          return put(commonStore.actions.setError(_context6.t0));\n\n        case 14:\n          _context6.next = 16;\n          return put(commonStore.actions.setLoadingPage(false));\n\n        case 16:\n        case \"end\":\n          return _context6.stop();\n      }\n    }\n  }, _marked6, null, [[3, 10]]);\n}\nexport function openCurrencyCreateDialog() {\n  return _regeneratorRuntime.wrap(function openCurrencyCreateDialog$(_context7) {\n    while (1) {\n      switch (_context7.prev = _context7.next) {\n        case 0:\n          _context7.next = 2;\n          return put(commonStore.actions.setLoadingPage(true));\n\n        case 2:\n          _context7.prev = 2;\n          _context7.next = 5;\n          return call(fetchInitDataForCE);\n\n        case 5:\n          _context7.next = 7;\n          return put(currencyStore.actions.setDialogStateOpen(true));\n\n        case 7:\n          _context7.next = 13;\n          break;\n\n        case 9:\n          _context7.prev = 9;\n          _context7.t0 = _context7[\"catch\"](2);\n          _context7.next = 13;\n          return put(commonStore.actions.setError(_context7.t0));\n\n        case 13:\n          _context7.next = 15;\n          return put(commonStore.actions.setLoadingPage(false));\n\n        case 15:\n        case \"end\":\n          return _context7.stop();\n      }\n    }\n  }, _marked7, null, [[2, 9]]);\n}\nexport function createCurrency(_ref2) {\n  var payload, _yield$call2, message;\n\n  return _regeneratorRuntime.wrap(function createCurrency$(_context8) {\n    while (1) {\n      switch (_context8.prev = _context8.next) {\n        case 0:\n          payload = _ref2.payload;\n          _context8.next = 3;\n          return put(currencyStore.actions.setDialogStateLoading(true));\n\n        case 3:\n          _context8.prev = 3;\n          _context8.next = 6;\n          return call(currencyApi.create, payload);\n\n        case 6:\n          _yield$call2 = _context8.sent;\n          message = _yield$call2.message;\n          _context8.next = 10;\n          return all([put(commonStore.actions.setSuccessMessage(message)), put(currencyStore.actions.resetDetail())]);\n\n        case 10:\n          _context8.next = 16;\n          break;\n\n        case 12:\n          _context8.prev = 12;\n          _context8.t0 = _context8[\"catch\"](3);\n          _context8.next = 16;\n          return put(commonStore.actions.setError(_context8.t0));\n\n        case 16:\n          _context8.next = 18;\n          return put(currencyStore.actions.setDialogStateLoading(false));\n\n        case 18:\n        case \"end\":\n          return _context8.stop();\n      }\n    }\n  }, _marked8, null, [[3, 12]]);\n}\nexport function openCurrencyUpdateDialog(_ref3) {\n  var id;\n  return _regeneratorRuntime.wrap(function openCurrencyUpdateDialog$(_context9) {\n    while (1) {\n      switch (_context9.prev = _context9.next) {\n        case 0:\n          id = _ref3.payload;\n          _context9.next = 3;\n          return put(commonStore.actions.setLoadingPage(true));\n\n        case 3:\n          _context9.prev = 3;\n          _context9.next = 6;\n          return call(fetchInitDataForCE);\n\n        case 6:\n          _context9.next = 8;\n          return call(fetchDetail, id);\n\n        case 8:\n          _context9.next = 10;\n          return put(currencyStore.actions.setDialogState({\n            open: true,\n            editMode: true\n          }));\n\n        case 10:\n          _context9.next = 16;\n          break;\n\n        case 12:\n          _context9.prev = 12;\n          _context9.t0 = _context9[\"catch\"](3);\n          _context9.next = 16;\n          return put(commonStore.actions.setError(_context9.t0));\n\n        case 16:\n          _context9.next = 18;\n          return put(commonStore.actions.setLoadingPage(false));\n\n        case 18:\n        case \"end\":\n          return _context9.stop();\n      }\n    }\n  }, _marked9, null, [[3, 12]]);\n}\nexport function updateCurrency(_ref4) {\n  var payload, id, formData, _yield$call3, message;\n\n  return _regeneratorRuntime.wrap(function updateCurrency$(_context10) {\n    while (1) {\n      switch (_context10.prev = _context10.next) {\n        case 0:\n          payload = _ref4.payload;\n          _context10.next = 3;\n          return put(currencyStore.actions.setDialogStateLoading(true));\n\n        case 3:\n          _context10.prev = 3;\n          id = payload.id, formData = payload.formData;\n          _context10.next = 7;\n          return call(currencyApi.update, id, formData);\n\n        case 7:\n          _yield$call3 = _context10.sent;\n          message = _yield$call3.message;\n          _context10.next = 11;\n          return call(closeCurrencyDialog);\n\n        case 11:\n          _context10.next = 13;\n          return put(commonStore.actions.setSuccessMessage(message));\n\n        case 13:\n          _context10.next = 19;\n          break;\n\n        case 15:\n          _context10.prev = 15;\n          _context10.t0 = _context10[\"catch\"](3);\n          _context10.next = 19;\n          return put(commonStore.actions.setError(_context10.t0));\n\n        case 19:\n          _context10.next = 21;\n          return put(currencyStore.actions.setDialogStateLoading(false));\n\n        case 21:\n        case \"end\":\n          return _context10.stop();\n      }\n    }\n  }, _marked10, null, [[3, 15]]);\n}\nexport function closeCurrencyDialog() {\n  return _regeneratorRuntime.wrap(function closeCurrencyDialog$(_context11) {\n    while (1) {\n      switch (_context11.prev = _context11.next) {\n        case 0:\n          _context11.prev = 0;\n          _context11.next = 3;\n          return put(currencyStore.actions.setDialogStateOpen(false));\n\n        case 3:\n          _context11.next = 5;\n          return call(getCurrencyList);\n\n        case 5:\n          _context11.next = 7;\n          return put(currencyStore.actions.resetDetail());\n\n        case 7:\n          _context11.next = 13;\n          break;\n\n        case 9:\n          _context11.prev = 9;\n          _context11.t0 = _context11[\"catch\"](0);\n          _context11.next = 13;\n          return put(commonStore.actions.setError(_context11.t0));\n\n        case 13:\n        case \"end\":\n          return _context11.stop();\n      }\n    }\n  }, _marked11, null, [[0, 9]]);\n}\n\nfunction currencySaga() {\n  return _regeneratorRuntime.wrap(function currencySaga$(_context12) {\n    while (1) {\n      switch (_context12.prev = _context12.next) {\n        case 0:\n          _context12.next = 2;\n          return takeEvery(currencyStore.sagaGetList, getCurrencyList);\n\n        case 2:\n          _context12.next = 4;\n          return takeEvery(currencyStore.sagaCreate, createCurrency);\n\n        case 4:\n          _context12.next = 6;\n          return takeLatest(currencyStore.sagaOpenCreateDialog, openCurrencyCreateDialog);\n\n        case 6:\n          _context12.next = 8;\n          return takeEvery(currencyStore.sagaOpenUpdateDialog, openCurrencyUpdateDialog);\n\n        case 8:\n          _context12.next = 10;\n          return takeEvery(currencyStore.sagaUpdate, updateCurrency);\n\n        case 10:\n          _context12.next = 12;\n          return takeEvery(currencyStore.sagaCloseDialog, closeCurrencyDialog);\n\n        case 12:\n          _context12.next = 14;\n          return takeEvery(currencyStore.sagaChangeUserCurrency, changeUserCurrency);\n\n        case 14:\n        case \"end\":\n          return _context12.stop();\n      }\n    }\n  }, _marked12);\n}\n\nexport default currencySaga;","map":{"version":3,"sources":["D:/TTS_Reactjs/malis-3-frontend/src/store/saga/currency.saga.ts"],"names":["fetchInitDataForList","fetchList","fetchInitDataForCE","fetchDetail","getCurrencyList","changeUserCurrency","openCurrencyCreateDialog","createCurrency","openCurrencyUpdateDialog","updateCurrency","closeCurrencyDialog","currencySaga","takeEvery","takeLatest","put","call","select","all","advancedFilterActions","commonStore","currencyStore","_","currencyApi","constant","AppNumber","selectUserBaseCurrency","userBaseCurrency","getInitDataForList","data","isNull","id","user_base_currency","actions","setInitDataForList","tableState","selectTableState","searchQuery","selectSearchQuery","filterData","selectFilterData","baseCurrency","page","per_page","getList","base_currency_id","s","setTableState","total_items","setDataList","currency_list","getInitDataForCE","setInitDataForCE","getDetail","currency","rate","format","currencyRateFormat","setDetail","setLoadingPage","selectPermissions","permissions","view","setError","payload","setUserBaseCurrency","setDialogStateOpen","setDialogStateLoading","create","message","setSuccessMessage","resetDetail","setDialogState","open","editMode","formData","update","sagaGetList","sagaCreate","sagaOpenCreateDialog","sagaOpenUpdateDialog","sagaUpdate","sagaCloseDialog","sagaChangeUserCurrency"],"mappings":"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","sourcesContent":["import { takeEvery, takeLatest, put } from 'redux-saga/effects'\n\nimport { call, select, all } from 'typed-redux-saga'\n\nimport { advancedFilterActions, commonStore, currencyStore } from '@/store/reducers'\n\nimport _ from 'lodash'\nimport currencyApi from '@/apis/currency.api'\nimport * as constant from '@/utils/constant'\nimport AppNumber from '@/helper/AppNumber'\n\nfunction* fetchInitDataForList() {\n  const userBaseCurrency = yield* select(currencyStore.selectUserBaseCurrency)\n  const data = yield call(currencyApi.getInitDataForList)\n  if (!_.isNull(userBaseCurrency.id)) {\n    data.user_base_currency = userBaseCurrency\n  }\n  yield put(currencyStore.actions.setInitDataForList(data))\n}\n\nfunction* fetchList() {\n  const { tableState, searchQuery, filterData, baseCurrency } = yield* all({\n    tableState: select(commonStore.selectTableState),\n    searchQuery: select(commonStore.selectSearchQuery),\n    filterData: select(advancedFilterActions.selectFilterData),\n    baseCurrency: select(currencyStore.selectUserBaseCurrency)\n  })\n  const { page, per_page } = tableState\n  const data = yield call(currencyApi.getList, {\n    base_currency_id: baseCurrency.id,\n    page,\n    per_page,\n    s: searchQuery,\n    ...filterData\n  })\n  yield put(commonStore.actions.setTableState({ total_items: data.total_items }))\n  yield put(currencyStore.actions.setDataList(data.currency_list))\n}\n\nfunction* fetchInitDataForCE() {\n  const { id: base_currency_id } = yield* select(currencyStore.selectUserBaseCurrency)\n  const data = yield call(currencyApi.getInitDataForCE, {\n    base_currency_id\n  })\n  yield put(currencyStore.actions.setInitDataForCE(data))\n}\n\nfunction* fetchDetail(id: number) {\n  const { currency } = yield call(currencyApi.getDetail, id)\n  currency.rate = AppNumber.format(currency.rate, constant.currencyRateFormat)\n  yield put(currencyStore.actions.setDetail(currency))\n}\n\nexport function* getCurrencyList() {\n  yield put(commonStore.actions.setLoadingPage(true))\n  try {\n    yield call(fetchInitDataForList)\n    const permissions = yield* select(currencyStore.selectPermissions)\n    if (permissions?.view) {\n      yield call(fetchList)\n    }\n  } catch (error) {\n    yield put(commonStore.actions.setError(error))\n  }\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nexport function* changeUserCurrency({ payload }: ReturnType<typeof currencyStore.sagaChangeUserCurrency>) {\n  yield put(commonStore.actions.setLoadingPage(true))\n  try {\n    yield put(currencyStore.actions.setUserBaseCurrency(payload))\n    yield call(fetchList)\n  } catch (error) {\n    yield put(commonStore.actions.setError(error))\n  }\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nexport function* openCurrencyCreateDialog() {\n  yield put(commonStore.actions.setLoadingPage(true))\n\n  try {\n    yield call(fetchInitDataForCE)\n    yield put(currencyStore.actions.setDialogStateOpen(true))\n  } catch (error) {\n    yield put(commonStore.actions.setError(error))\n  }\n\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nexport function* createCurrency({ payload }: ReturnType<typeof currencyStore.sagaCreate>) {\n  yield put(currencyStore.actions.setDialogStateLoading(true))\n\n  try {\n    const { message } = yield call(currencyApi.create, payload)\n    yield all([put(commonStore.actions.setSuccessMessage(message)), put(currencyStore.actions.resetDetail())])\n  } catch (error) {\n    yield put(commonStore.actions.setError(error))\n  }\n  yield put(currencyStore.actions.setDialogStateLoading(false))\n}\n\nexport function* openCurrencyUpdateDialog({ payload: id }: ReturnType<typeof currencyStore.sagaOpenUpdateDialog>) {\n  yield put(commonStore.actions.setLoadingPage(true))\n  try {\n    yield call(fetchInitDataForCE)\n    yield call(fetchDetail, id)\n    yield put(currencyStore.actions.setDialogState({ open: true, editMode: true }))\n  } catch (error) {\n    yield put(commonStore.actions.setError(error))\n  }\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nexport function* updateCurrency({ payload }: ReturnType<typeof currencyStore.sagaUpdate>) {\n  yield put(currencyStore.actions.setDialogStateLoading(true))\n\n  try {\n    const { id, formData } = payload\n    const { message } = yield call(currencyApi.update, id, formData)\n    yield call(closeCurrencyDialog)\n    yield put(commonStore.actions.setSuccessMessage(message))\n  } catch (error) {\n    yield put(commonStore.actions.setError(error))\n  }\n\n  yield put(currencyStore.actions.setDialogStateLoading(false))\n}\n\nexport function* closeCurrencyDialog() {\n  try {\n    yield put(currencyStore.actions.setDialogStateOpen(false))\n    yield call(getCurrencyList)\n    yield put(currencyStore.actions.resetDetail())\n  } catch (error) {\n    yield put(commonStore.actions.setError(error))\n  }\n}\n\nfunction* currencySaga() {\n  yield takeEvery(currencyStore.sagaGetList, getCurrencyList)\n  yield takeEvery(currencyStore.sagaCreate, createCurrency)\n  yield takeLatest(currencyStore.sagaOpenCreateDialog, openCurrencyCreateDialog)\n  yield takeEvery(currencyStore.sagaOpenUpdateDialog, openCurrencyUpdateDialog)\n  yield takeEvery(currencyStore.sagaUpdate, updateCurrency)\n  yield takeEvery(currencyStore.sagaCloseDialog, closeCurrencyDialog)\n  yield takeEvery(currencyStore.sagaChangeUserCurrency, changeUserCurrency)\n}\n\nexport default currencySaga\n"]},"metadata":{},"sourceType":"module"}