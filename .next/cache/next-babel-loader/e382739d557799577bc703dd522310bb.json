{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useFormContext } from 'react-hook-form';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Grid } from '@material-ui/core';\nimport { TableMultilingualDescription, AppAutocompleteAsync, FormControllerAutocomplete, FormControllerTextField, SectionTimezone, AppAutocomplete, DropdownIcon } from '@/components';\nimport { Unless } from 'react-if';\nimport _ from 'lodash';\nimport AppNumber from '@/helper/AppNumber';\nimport { partStore, commonStore } from '@/store/reducers';\n\nconst TabGeneral = () => {\n  var _assemblyForm$errors$, _assemblyForm$errors$2;\n\n  const assemblyForm = useFormContext();\n  const formAssemblyData = assemblyForm.getValues();\n  const watchId = assemblyForm.watch('id', null);\n  const watchDrawingId = assemblyForm.watch('drawing_id', null);\n\n  const isCreating = _.isNil(watchId);\n\n  const dispatch = useDispatch();\n  const parameters = useSelector(partStore.selectParameters);\n  const entity = useSelector(commonStore.selectEntity);\n  const userJob = useSelector(commonStore.selectUserValueJob);\n\n  const handleChangeDrawingId = (event, optionValue) => {\n    const formData = assemblyForm.getValues();\n    dispatch(partStore.sagaChangeDrawing({\n      formData,\n      drawing: optionValue,\n      entity: 'assembly'\n    }));\n  };\n\n  const handleBlur = event => {\n    const {\n      value\n    } = event.target;\n\n    if (AppNumber.isNumber(value) && AppNumber.isPositiveNumber(value)) {\n      const formatValue = 'G' + value.padStart(3, '0');\n      assemblyForm.setValue('dpn', formatValue);\n    }\n  };\n\n  return /*#__PURE__*/_jsxs(Grid, {\n    container: true,\n    spacing: 2,\n    children: [/*#__PURE__*/_jsx(Grid, {\n      item: true,\n      xs: 6,\n      children: /*#__PURE__*/_jsxs(Grid, {\n        container: true,\n        spacing: 2,\n        children: [/*#__PURE__*/_jsx(Grid, {\n          item: true,\n          xs: 12,\n          children: /*#__PURE__*/_jsx(AppAutocomplete, {\n            helperText: (_assemblyForm$errors$ = assemblyForm.errors.job_id) === null || _assemblyForm$errors$ === void 0 ? void 0 : _assemblyForm$errors$.message,\n            error: Boolean(assemblyForm.errors.job_id),\n            value: userJob,\n            popupIcon: null,\n            disabled: true,\n            label: \"Job\",\n            required: true,\n            primaryKeyOption: \"value\",\n            options: [],\n            renderOption: option => option.description\n          })\n        }), /*#__PURE__*/_jsx(Grid, {\n          item: true,\n          xs: 12,\n          children: /*#__PURE__*/_jsx(AppAutocompleteAsync, {\n            popupIcon: entity === 'drawing' ? null : /*#__PURE__*/_jsx(DropdownIcon, {}),\n            helperText: (_assemblyForm$errors$2 = assemblyForm.errors.drawing_id) === null || _assemblyForm$errors$2 === void 0 ? void 0 : _assemblyForm$errors$2.message,\n            error: Boolean(assemblyForm.errors.drawing_id),\n            disabled: !isCreating || entity === 'drawing',\n            value: watchDrawingId,\n            compName: \"drawing_list\",\n            additionalData: {\n              limit_to_job: userJob.value\n            },\n            required: true,\n            label: \"Drawing #\",\n            onChange: handleChangeDrawingId\n          })\n        }), /*#__PURE__*/_jsx(Grid, {\n          item: true,\n          xs: 12,\n          children: /*#__PURE__*/_jsx(FormControllerTextField, {\n            disabled: !isCreating,\n            control: assemblyForm.control,\n            label: \"Assembly #\",\n            required: true,\n            name: \"dpn\",\n            onBlur: handleBlur\n          })\n        }), /*#__PURE__*/_jsx(Grid, {\n          item: true,\n          xs: 12,\n          children: /*#__PURE__*/_jsx(FormControllerAutocomplete, {\n            control: assemblyForm.control,\n            label: \"Unit\",\n            name: \"unit\",\n            options: parameters.UNIT,\n            primaryKeyOption: \"value\",\n            required: true\n          })\n        }), /*#__PURE__*/_jsx(Unless, {\n          condition: isCreating,\n          children: /*#__PURE__*/_jsx(SectionTimezone, {\n            value: formAssemblyData\n          })\n        })]\n      })\n    }), /*#__PURE__*/_jsx(Grid, {\n      item: true,\n      xs: 6,\n      children: /*#__PURE__*/_jsx(TableMultilingualDescription, {\n        languageList: parameters.PLLA,\n        editMode: !isCreating,\n        name: \"descriptions\",\n        tableHeight: 280,\n        control: assemblyForm.control,\n        copyable: true,\n        copyDialogProps: {\n          checkboxesToSelect: [{\n            label: 'Drawing',\n            value: 'drawing_list',\n            entity: 'drawings'\n          }, {\n            label: 'Item/Assembly',\n            value: 'part_list',\n            entity: 'parts',\n            default: true\n          }]\n        }\n      })\n    })]\n  });\n};\n\nexport default TabGeneral;","map":null,"metadata":{},"sourceType":"module"}