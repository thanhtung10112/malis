{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"D:\\\\TTS_Reactjs\\\\malis-3-frontend\\\\src\\\\components\\\\Dialog\\\\Module\\\\Equivalence\\\\CreateEdit.tsx\",\n    _s = $RefreshSig$();\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState, useMemo, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useForm } from 'react-hook-form';\nimport { useTranslation } from 'next-i18next';\nimport useStyles from './styles';\nimport { Grid, Button, Paper, Tooltip, Checkbox, Typography } from '@material-ui/core';\nimport { Alert } from '@material-ui/lab';\nimport { Backup as BackupIcon, HighlightOffOutlined as HighlightOffOutlinedIcon } from '@material-ui/icons';\nimport { DataTable, FormControllerTextField, DataTableTextField, SectionTimezone, DialogMain, CreateIcon, DeleteIcon, DataTableAutocomplete, AppAutocomplete, AppImageField, BtnHelp, FormControllerNumberField } from '@/components';\nimport { Unless, When } from 'react-if';\nimport immer from 'immer';\nimport _ from 'lodash';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport * as columnProperties from '@/utils/columnProperties';\nimport getValidationSchema from './validationSchema';\nimport { removalProperties } from '@/utils/constant';\nimport { equivalenceStore } from '@/store/reducers';\n\nfunction StandardEquivalenceCreateEdit() {\n  _s();\n\n  var _equivalenceForm$erro, _equivalenceForm$erro2, _equivalenceForm$erro3;\n\n  var _useTranslation = useTranslation('equivalence'),\n      t = _useTranslation.t;\n\n  var validationSchema = useMemo(function () {\n    return getValidationSchema(t);\n  }, []);\n  var equivalenceForm = useForm({\n    shouldUnregister: false,\n    resolver: yupResolver(validationSchema)\n  });\n  var watchEquivalentStandards = equivalenceForm.watch('standards', []);\n  var watchImage = equivalenceForm.watch('image', '');\n  var refFileInput = null;\n\n  var setInputELement = function setInputELement(element) {\n    refFileInput = element;\n  };\n\n  var _useState = useState([]),\n      selectedRows = _useState[0],\n      setSelectedRows = _useState[1];\n\n  var _useState2 = useState(''),\n      idUploadImage = _useState2[0],\n      setIdUploadImage = _useState2[1];\n\n  var _useState3 = useState([]),\n      selectedStandards = _useState3[0],\n      setSelectedStandards = _useState3[1];\n\n  var dispatch = useDispatch();\n  var dialogState = useSelector(equivalenceStore.selectDialogState);\n  var equivalenceType = useSelector(equivalenceStore.selectEquivalenceType);\n  var equivalenceDetail = useSelector(equivalenceStore.selectDetail);\n\n  var _useSelector = useSelector(equivalenceStore.selectInitDataForCE),\n      parameters = _useSelector.parameters,\n      wiki_page = _useSelector.wiki_page;\n\n  var permissions = useSelector(equivalenceStore.selectPermissions);\n\n  var isCreating = _.isNil(equivalenceDetail.id);\n\n  var classes = useStyles({\n    editMode: !isCreating\n  });\n  var standardErrorMessage = useMemo(function () {\n    var errors = equivalenceForm.errors;\n\n    if (!errors.standards) {\n      return '';\n    }\n\n    errors.standards = errors.standards.filter(function (err) {\n      return err;\n    });\n    return _.get(errors, 'standards[0].organization.message') || _.get(errors, 'standards[0].standard.message');\n  }, [equivalenceForm.errors.standards]);\n  var title = useMemo(function () {\n    var action = isCreating ? 'Create' : 'Update';\n    var type = equivalenceType === 'manufacturing_standard' ? 'Manufacturing Standards Equivalence' : 'Material Standards Equivalence';\n    return \"\".concat(action, \" \").concat(type);\n  }, [isCreating, equivalenceType]);\n  useEffect(function () {\n    equivalenceForm.reset(_objectSpread({}, equivalenceDetail));\n  }, [equivalenceDetail]);\n\n  var onCloseDialog = function onCloseDialog() {\n    dispatch(equivalenceStore.sagaCloseDialog());\n    equivalenceForm.clearErrors();\n  };\n\n  var getStandard = function getStandard(value) {\n    var option = _.find(parameters.PLNO, {\n      value: value\n    });\n\n    return option;\n  };\n\n  var onSelectStandard = function onSelectStandard(event, valueOptions) {\n    setSelectedStandards(valueOptions);\n  };\n\n  var onAddEquivalentStandards = function onAddEquivalentStandards() {\n    var standards = _.map(selectedStandards, function (item) {\n      return {\n        organization: item.value,\n        standard: '',\n        preferred: false,\n        image: null\n      };\n    });\n\n    equivalenceForm.setValue('standards', [].concat(_toConsumableArray(watchEquivalentStandards), _toConsumableArray(standards)));\n    setSelectedStandards([]);\n  };\n\n  var onSelectRows = function onSelectRows(_ref) {\n    var selectionModel = _ref.selectionModel;\n    setSelectedRows(selectionModel);\n  };\n\n  var onRemoveEquivalentStandards = function onRemoveEquivalentStandards() {\n    var removalItems = _.filter(watchEquivalentStandards, function (item) {\n      return !selectedRows.includes(item.organization);\n    });\n\n    equivalenceForm.setValue('standards', removalItems);\n    setSelectedRows([]);\n  };\n\n  var onChangePreferred = function onChangePreferred(organization) {\n    return function (event, checked) {\n      var newStandards = immer(watchEquivalentStandards, function (draft) {\n        var index = _.findIndex(watchEquivalentStandards, {\n          organization: organization\n        });\n\n        draft[index].preferred = checked;\n      });\n      equivalenceForm.setValue('standards', newStandards);\n    };\n  };\n\n  var onChangeStandard = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(organization, value) {\n      var newStandards;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              newStandards = immer(watchEquivalentStandards, function (draft) {\n                var index = _.findIndex(watchEquivalentStandards, {\n                  organization: organization\n                });\n\n                draft[index].standard = value;\n              });\n              equivalenceForm.setValue('standards', newStandards);\n              _context.t0 = equivalenceForm.errors.standards;\n\n              if (!_context.t0) {\n                _context.next = 6;\n                break;\n              }\n\n              _context.next = 6;\n              return equivalenceForm.trigger('standards');\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function onChangeStandard(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var onChangeOrganization = function onChangeOrganization(id) {\n    return /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event, organization) {\n        var newStandards;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                newStandards = immer(watchEquivalentStandards, function (draft) {\n                  var index = _.findIndex(draft, {\n                    organization: id\n                  });\n\n                  if (index !== -1) {\n                    draft[index].organization = organization.value;\n                  }\n                });\n                equivalenceForm.setValue('standards', newStandards);\n\n              case 2:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x3, _x4) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n  };\n\n  var onChangeFiles = function onChangeFiles(event) {\n    var files = event.target.files;\n    equivalenceForm.setValue('standards', immer(watchEquivalentStandards, function (draft) {\n      var index = _.findIndex(watchEquivalentStandards, {\n        id: idUploadImage\n      });\n\n      draft[index].image = files[0];\n    }));\n  };\n\n  var filterOrganizationOption = function filterOrganizationOption(options) {\n    return _.differenceWith(options, watchEquivalentStandards, function (option, standard) {\n      return option.value === standard.organization;\n    });\n  };\n\n  var onClickToUploadImage = function onClickToUploadImage(id) {\n    return function () {\n      setIdUploadImage(id);\n      refFileInput.value = '';\n      refFileInput.click();\n    };\n  };\n\n  var onRemoveImage = function onRemoveImage(id) {\n    return function (event) {\n      event.stopPropagation();\n      equivalenceForm.setValue('standards', immer(watchEquivalentStandards, function (draft) {\n        var index = _.findIndex(watchEquivalentStandards, {\n          id: id\n        });\n\n        draft[index].image = '';\n      }));\n    };\n  };\n\n  var onSubmitForm = equivalenceForm.handleSubmit(function (data) {\n    data.equiv_type = equivalenceType === 'manufacturing_standard' ? 1 : 0;\n\n    var payload = _.omit(data, _toConsumableArray(removalProperties));\n\n    var formData = new FormData();\n\n    if (payload.image && payload.image instanceof File) {\n      formData.append('equiv_image', payload.image);\n    }\n\n    delete payload.image;\n    var std_for_remove_img = [];\n\n    var _iterator = _createForOfIteratorHelper(payload.standards),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var std = _step.value;\n\n        if (std.image && std.image instanceof File) {\n          formData.append(\"std_\".concat(std.organization), std.image);\n        } else {\n          // formData.append(`std_${std.organization}`, null as File)\n          std_for_remove_img.push(std.organization);\n        }\n\n        delete std.image;\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    formData.append('equiv_info', JSON.stringify(_objectSpread(_objectSpread({}, payload), {}, {\n      standards_for_remove_img: std_for_remove_img\n    })));\n\n    if (isCreating) {\n      dispatch(equivalenceStore.sagaCreate(formData));\n    } else {\n      dispatch(equivalenceStore.sagaUpdate({\n        id: data.id,\n        formData: formData\n      }));\n    }\n  });\n\n  var onGetNextCode = function onGetNextCode() {\n    var currentValues = equivalenceForm.getValues();\n    dispatch(equivalenceStore.sagaGetNextCode(currentValues));\n  };\n\n  var handleChangeImage = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(image) {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              equivalenceForm.setValue('image', image.file);\n              _context3.next = 3;\n              return equivalenceForm.trigger('image');\n\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleChangeImage(_x5) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(DialogMain, {\n    open: dialogState.open,\n    maxWidth: \"md\",\n    loading: dialogState.loading,\n    onOk: onSubmitForm,\n    onClose: onCloseDialog,\n    title: /*#__PURE__*/_jsxDEV(BtnHelp, {\n      title: title,\n      href: wiki_page\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 14\n    }, this),\n    height: isCreating ? 500 : 540,\n    classes: {\n      paperWidthMd: classes.paperRoot\n    },\n    okText: isCreating ? t('common:button.create') : t('common:button.update'),\n    okButtonProps: {\n      disabled: dialogState.loading || !(permissions === null || permissions === void 0 ? void 0 : permissions.edit) && !isCreating\n    },\n    children: /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      spacing: 2,\n      className: classes.gridMarginTop,\n      children: [/*#__PURE__*/_jsxDEV(When, {\n        condition: Boolean((_equivalenceForm$erro = equivalenceForm.errors) === null || _equivalenceForm$erro === void 0 ? void 0 : _equivalenceForm$erro.standards),\n        children: /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          children: /*#__PURE__*/_jsxDEV(Alert, {\n            severity: \"error\",\n            children: standardErrorMessage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 9,\n        spacing: 2,\n        children: /*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          spacing: 2,\n          children: [/*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 12,\n            spacing: 3,\n            children: /*#__PURE__*/_jsxDEV(FormControllerNumberField, {\n              label: \"Equivalence #\",\n              name: \"equiv_id\",\n              control: equivalenceForm.control,\n              required: true,\n              decimalScale: 0,\n              fixedDecimalScale: false,\n              generateCode: true,\n              disabled: !isCreating,\n              loading: dialogState.loading,\n              onGenerateCode: onGetNextCode\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 255,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 12,\n            children: /*#__PURE__*/_jsxDEV(FormControllerTextField, {\n              required: true,\n              label: \"Description\",\n              name: \"description\",\n              control: equivalenceForm.control\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 3,\n        style: {\n          height: 88\n        },\n        children: /*#__PURE__*/_jsxDEV(AppImageField, {\n          image: watchImage,\n          onChange: handleChangeImage,\n          error: ((_equivalenceForm$erro2 = equivalenceForm.errors.image) === null || _equivalenceForm$erro2 === void 0 ? void 0 : _equivalenceForm$erro2.message) || ''\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 9,\n        children: /*#__PURE__*/_jsxDEV(AppAutocomplete, {\n          label: \"Equivalent standards per organization\",\n          value: selectedStandards,\n          multiple: true,\n          limitTags: 2,\n          disableCloseOnSelect: true,\n          options: parameters.PLNO,\n          renderOption: function renderOption(option) {\n            return option.description;\n          },\n          filterOptions: filterOrganizationOption,\n          onChange: onSelectStandard\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 3,\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          startIcon: /*#__PURE__*/_jsxDEV(CreateIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 24\n          }, this),\n          onClick: onAddEquivalentStandards,\n          disabled: selectedStandards.length === 0,\n          style: {\n            textTransform: 'capitalize'\n          },\n          children: \"Add\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          startIcon: /*#__PURE__*/_jsxDEV(DeleteIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 24\n          }, this),\n          onClick: onRemoveEquivalentStandards,\n          disabled: selectedRows.length <= 0,\n          style: {\n            textTransform: 'capitalize'\n          },\n          children: \"Remove\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        onChange: onChangeFiles,\n        ref: setInputELement,\n        className: classes.input,\n        accept: ['image/png', 'image/jpg', 'image/jpeg'].join(',')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 12,\n        children: [/*#__PURE__*/_jsxDEV(Paper, {\n          children: /*#__PURE__*/_jsxDEV(DataTable, {\n            tableHeight: ((_equivalenceForm$erro3 = equivalenceForm.errors) === null || _equivalenceForm$erro3 === void 0 ? void 0 : _equivalenceForm$erro3.standards) ? 263 : 335,\n            hideFooter: true,\n            checkboxSelection: true,\n            disableColumnMenu: true,\n            disableSelectionOnClick: true,\n            rows: watchEquivalentStandards,\n            selectionModel: selectedRows,\n            getRowId: function getRowId(param) {\n              return param.organization;\n            },\n            onSelectionModelChange: onSelectRows,\n            columns: [_objectSpread(_objectSpread({}, columnProperties.editCell('Organization')), {}, {\n              sortable: false,\n              field: 'organization',\n              headerName: 'Organization',\n              flex: 0.5,\n              valueGetter: function valueGetter(params) {\n                var value = getStandard(params.value);\n                return value;\n              },\n              valueFormatter: function valueFormatter(params) {\n                var _params$value;\n\n                return (_params$value = params.value) === null || _params$value === void 0 ? void 0 : _params$value.description;\n              },\n              renderEditCell: function renderEditCell(params) {\n                return /*#__PURE__*/_jsxDEV(DataTableAutocomplete, {\n                  params: params,\n                  options: parameters.PLNO,\n                  onChange: onChangeOrganization(params.id),\n                  filterOptions: filterOrganizationOption\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 358,\n                  columnNumber: 23\n                }, this);\n              }\n            }), _objectSpread(_objectSpread(_objectSpread({}, columnProperties.defaultProperties), columnProperties.editCell('Standard')), {}, {\n              field: 'standard',\n              flex: 0.4,\n              renderEditCell: function renderEditCell(params) {\n                return /*#__PURE__*/_jsxDEV(DataTableTextField, {\n                  params: params,\n                  onChangeValue: onChangeStandard\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 373,\n                  columnNumber: 28\n                }, this);\n              }\n            }), _objectSpread(_objectSpread({}, columnProperties.defaultProperties), {}, {\n              field: 'preferred',\n              headerName: 'Preferred',\n              width: 100,\n              align: 'center',\n              headerAlign: 'center',\n              renderCell: function renderCell(params) {\n                return /*#__PURE__*/_jsxDEV(Checkbox, {\n                  color: \"primary\",\n                  style: {\n                    padding: 0\n                  },\n                  checked: params.value,\n                  onChange: onChangePreferred(params.id)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 385,\n                  columnNumber: 23\n                }, this);\n              }\n            }), {\n              field: 'image',\n              headerName: 'Image',\n              sortable: false,\n              width: 150,\n              align: 'center',\n              headerAlign: 'center',\n              renderCell: function renderCell(params) {\n                if (params.value) {\n                  return /*#__PURE__*/_jsxDEV(Tooltip, {\n                    title: /*#__PURE__*/_jsxDEV(\"img\", {\n                      src: params.value instanceof File ? URL.createObjectURL(params.value) : params.value,\n                      style: {\n                        height: '150px'\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 406,\n                      columnNumber: 29\n                    }, this),\n                    placement: \"top-end\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        display: 'flex'\n                      },\n                      onClick: onClickToUploadImage(params.id),\n                      children: [/*#__PURE__*/_jsxDEV(Typography, {\n                        noWrap: true,\n                        component: \"div\",\n                        style: {\n                          width: 100\n                        },\n                        children: params.value.name || params.value\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 416,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(HighlightOffOutlinedIcon, {\n                        onClick: onRemoveImage(params.id)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 419,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 415,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 404,\n                    columnNumber: 25\n                  }, this);\n                }\n\n                return /*#__PURE__*/_jsxDEV(Tooltip, {\n                  title: \"Only PNG, JPG, JPEG files are allowed!\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      display: 'flex',\n                      alignItems: 'center'\n                    },\n                    onClick: onClickToUploadImage(params.id),\n                    children: /*#__PURE__*/_jsxDEV(BackupIcon, {\n                      style: {\n                        color: '#0A65FF'\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 430,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 426,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 425,\n                  columnNumber: 23\n                }, this);\n              }\n            }]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 331,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Unless, {\n          condition: isCreating,\n          children: /*#__PURE__*/_jsxDEV(SectionTimezone, {\n            value: equivalenceDetail\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 441,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 231,\n    columnNumber: 5\n  }, this);\n}\n\n_s(StandardEquivalenceCreateEdit, \"tlLPK4UYrb4oiSkH8QgAtIkp/Oo=\", false, function () {\n  return [useTranslation, useForm, useDispatch, useSelector, useSelector, useSelector, useSelector, useSelector, useStyles];\n});\n\n_c = StandardEquivalenceCreateEdit;\nexport default StandardEquivalenceCreateEdit;\n\nvar _c;\n\n$RefreshReg$(_c, \"StandardEquivalenceCreateEdit\");","map":{"version":3,"sources":["D:/TTS_Reactjs/malis-3-frontend/src/components/Dialog/Module/Equivalence/CreateEdit.tsx"],"names":["useState","useMemo","useEffect","useDispatch","useSelector","useForm","useTranslation","useStyles","Grid","Button","Paper","Tooltip","Checkbox","Typography","Alert","Backup","BackupIcon","HighlightOffOutlined","HighlightOffOutlinedIcon","DataTable","FormControllerTextField","DataTableTextField","SectionTimezone","DialogMain","CreateIcon","DeleteIcon","DataTableAutocomplete","AppAutocomplete","AppImageField","BtnHelp","FormControllerNumberField","Unless","When","immer","_","yupResolver","columnProperties","getValidationSchema","removalProperties","equivalenceStore","StandardEquivalenceCreateEdit","t","validationSchema","equivalenceForm","shouldUnregister","resolver","watchEquivalentStandards","watch","watchImage","refFileInput","setInputELement","element","selectedRows","setSelectedRows","idUploadImage","setIdUploadImage","selectedStandards","setSelectedStandards","dispatch","dialogState","selectDialogState","equivalenceType","selectEquivalenceType","equivalenceDetail","selectDetail","selectInitDataForCE","parameters","wiki_page","permissions","selectPermissions","isCreating","isNil","id","classes","editMode","standardErrorMessage","errors","standards","filter","err","get","title","action","type","reset","onCloseDialog","sagaCloseDialog","clearErrors","getStandard","value","option","find","PLNO","onSelectStandard","event","valueOptions","onAddEquivalentStandards","map","item","organization","standard","preferred","image","setValue","onSelectRows","selectionModel","onRemoveEquivalentStandards","removalItems","includes","onChangePreferred","checked","newStandards","draft","index","findIndex","onChangeStandard","trigger","onChangeOrganization","onChangeFiles","files","target","filterOrganizationOption","options","differenceWith","onClickToUploadImage","click","onRemoveImage","stopPropagation","onSubmitForm","handleSubmit","data","equiv_type","payload","omit","formData","FormData","File","append","std_for_remove_img","std","push","JSON","stringify","standards_for_remove_img","sagaCreate","sagaUpdate","onGetNextCode","currentValues","getValues","sagaGetNextCode","handleChangeImage","file","open","loading","paperWidthMd","paperRoot","disabled","edit","gridMarginTop","Boolean","control","height","message","description","length","textTransform","input","join","param","editCell","sortable","field","headerName","flex","valueGetter","params","valueFormatter","renderEditCell","defaultProperties","width","align","headerAlign","renderCell","padding","URL","createObjectURL","display","name","alignItems","color"],"mappings":"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","sourcesContent":["import { useState, useMemo, useEffect } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { useForm } from 'react-hook-form'\nimport { useTranslation } from 'next-i18next'\nimport useStyles from './styles'\n\nimport { Grid, Button, Paper, Tooltip, Checkbox, Typography } from '@material-ui/core'\nimport { Alert } from '@material-ui/lab'\nimport { Backup as BackupIcon, HighlightOffOutlined as HighlightOffOutlinedIcon } from '@material-ui/icons'\nimport {\n  DataTable,\n  FormControllerTextField,\n  DataTableTextField,\n  SectionTimezone,\n  DialogMain,\n  CreateIcon,\n  DeleteIcon,\n  DataTableAutocomplete,\n  AppAutocomplete,\n  AppImageField,\n  BtnHelp,\n  FormControllerNumberField\n} from '@/components'\nimport { Unless, When } from 'react-if'\n\nimport immer from 'immer'\nimport _ from 'lodash'\nimport { yupResolver } from '@hookform/resolvers/yup'\nimport * as columnProperties from '@/utils/columnProperties'\nimport getValidationSchema from './validationSchema'\nimport { removalProperties } from '@/utils/constant'\nimport { equivalenceStore } from '@/store/reducers'\n\nimport type { EquivalenceDetail } from '@/types/Equivalence'\nimport type { ParameterOption } from '@/types/Common'\n\nfunction StandardEquivalenceCreateEdit() {\n  const { t } = useTranslation('equivalence')\n\n  const validationSchema = useMemo(() => getValidationSchema(t), [])\n  const equivalenceForm = useForm<EquivalenceDetail>({\n    shouldUnregister: false,\n    resolver: yupResolver(validationSchema)\n  })\n  const watchEquivalentStandards = equivalenceForm.watch('standards', [])\n  const watchImage = equivalenceForm.watch('image', '')\n\n  let refFileInput: HTMLInputElement = null\n  const setInputELement = (element: HTMLInputElement) => {\n    refFileInput = element\n  }\n\n  const [selectedRows, setSelectedRows] = useState([])\n  const [idUploadImage, setIdUploadImage] = useState('')\n  const [selectedStandards, setSelectedStandards] = useState([])\n\n  const dispatch = useDispatch()\n  const dialogState = useSelector(equivalenceStore.selectDialogState)\n  const equivalenceType = useSelector(equivalenceStore.selectEquivalenceType)\n  const equivalenceDetail = useSelector(equivalenceStore.selectDetail)\n  const { parameters, wiki_page } = useSelector(equivalenceStore.selectInitDataForCE)\n  const permissions = useSelector(equivalenceStore.selectPermissions)\n\n  const isCreating = _.isNil(equivalenceDetail.id)\n\n  const classes = useStyles({ editMode: !isCreating })\n  const standardErrorMessage = useMemo(() => {\n    const { errors } = equivalenceForm\n    if (!errors.standards) {\n      return ''\n    }\n    errors.standards = errors.standards.filter((err) => err)\n    return _.get(errors, 'standards[0].organization.message') || _.get(errors, 'standards[0].standard.message')\n  }, [equivalenceForm.errors.standards])\n\n  const title = useMemo(() => {\n    const action = isCreating ? 'Create' : 'Update'\n    const type =\n      equivalenceType === 'manufacturing_standard'\n        ? 'Manufacturing Standards Equivalence'\n        : 'Material Standards Equivalence'\n    return `${action} ${type}`\n  }, [isCreating, equivalenceType])\n\n  useEffect(() => {\n    equivalenceForm.reset({ ...equivalenceDetail })\n  }, [equivalenceDetail])\n\n  const onCloseDialog = () => {\n    dispatch(equivalenceStore.sagaCloseDialog())\n    equivalenceForm.clearErrors()\n  }\n\n  const getStandard = (value: number) => {\n    const option = _.find(parameters.PLNO, { value })\n    return option\n  }\n\n  const onSelectStandard = (event, valueOptions) => {\n    setSelectedStandards(valueOptions)\n  }\n\n  const onAddEquivalentStandards = () => {\n    const standards = _.map(selectedStandards, (item) => ({\n      organization: item.value,\n      standard: '',\n      preferred: false,\n      image: null\n    }))\n    equivalenceForm.setValue('standards', [...watchEquivalentStandards, ...standards])\n    setSelectedStandards([])\n  }\n  const onSelectRows = ({ selectionModel }) => {\n    setSelectedRows(selectionModel)\n  }\n\n  const onRemoveEquivalentStandards = () => {\n    const removalItems = _.filter(watchEquivalentStandards, (item) => !selectedRows.includes(item.organization))\n    equivalenceForm.setValue('standards', removalItems)\n    setSelectedRows([])\n  }\n\n  const onChangePreferred = (organization) => (event, checked) => {\n    const newStandards = immer(watchEquivalentStandards, (draft) => {\n      const index = _.findIndex(watchEquivalentStandards, { organization })\n      draft[index].preferred = checked\n    })\n    equivalenceForm.setValue('standards', newStandards)\n  }\n\n  const onChangeStandard = async (organization, value) => {\n    const newStandards = immer(watchEquivalentStandards, (draft) => {\n      const index = _.findIndex(watchEquivalentStandards, { organization })\n      draft[index].standard = value\n    })\n    equivalenceForm.setValue('standards', newStandards)\n    equivalenceForm.errors.standards && (await equivalenceForm.trigger('standards'))\n  }\n\n  const onChangeOrganization = (id) => async (event, organization) => {\n    const newStandards = immer(watchEquivalentStandards, (draft) => {\n      const index = _.findIndex(draft, { organization: id })\n      if (index !== -1) {\n        draft[index].organization = organization.value\n      }\n    })\n    equivalenceForm.setValue('standards', newStandards)\n  }\n\n  const onChangeFiles = (event) => {\n    const { files } = event.target\n    equivalenceForm.setValue(\n      'standards',\n      immer(watchEquivalentStandards, (draft) => {\n        const index = _.findIndex(watchEquivalentStandards, {\n          id: idUploadImage\n        })\n        draft[index].image = files[0]\n      })\n    )\n  }\n\n  const filterOrganizationOption = (options: ParameterOption[]) =>\n    _.differenceWith(options, watchEquivalentStandards, (option, standard) => option.value === standard.organization)\n\n  const onClickToUploadImage = (id) => () => {\n    setIdUploadImage(id)\n    refFileInput.value = ''\n    refFileInput.click()\n  }\n\n  const onRemoveImage = (id) => (event) => {\n    event.stopPropagation()\n    equivalenceForm.setValue(\n      'standards',\n      immer(watchEquivalentStandards, (draft) => {\n        const index = _.findIndex(watchEquivalentStandards, { id })\n        draft[index].image = ''\n      })\n    )\n  }\n\n  const onSubmitForm = equivalenceForm.handleSubmit((data) => {\n    data.equiv_type = equivalenceType === 'manufacturing_standard' ? 1 : 0\n    const payload = _.omit(data, [...removalProperties])\n    const formData = new FormData()\n    if (payload.image && payload.image instanceof File) {\n      formData.append('equiv_image', payload.image)\n    }\n    delete payload.image\n    const std_for_remove_img = []\n    for (const std of payload.standards) {\n      if (std.image && std.image instanceof File) {\n        formData.append(`std_${std.organization}`, std.image)\n      } else {\n        // formData.append(`std_${std.organization}`, null as File)\n        std_for_remove_img.push(std.organization)\n      }\n      delete std.image\n    }\n    formData.append(\n      'equiv_info',\n      JSON.stringify({\n        ...payload,\n        standards_for_remove_img: std_for_remove_img\n      })\n    )\n    if (isCreating) {\n      dispatch(equivalenceStore.sagaCreate(formData))\n    } else {\n      dispatch(\n        equivalenceStore.sagaUpdate({\n          id: data.id,\n          formData\n        })\n      )\n    }\n  })\n\n  const onGetNextCode = () => {\n    const currentValues = equivalenceForm.getValues()\n    dispatch(equivalenceStore.sagaGetNextCode(currentValues))\n  }\n\n  const handleChangeImage = async (image) => {\n    equivalenceForm.setValue('image', image.file)\n    await equivalenceForm.trigger('image')\n  }\n\n  return (\n    <DialogMain\n      open={dialogState.open}\n      maxWidth=\"md\"\n      loading={dialogState.loading}\n      onOk={onSubmitForm}\n      onClose={onCloseDialog}\n      title={<BtnHelp title={title} href={wiki_page} />}\n      height={isCreating ? 500 : 540}\n      classes={{ paperWidthMd: classes.paperRoot }}\n      okText={isCreating ? t('common:button.create') : t('common:button.update')}\n      okButtonProps={{\n        disabled: dialogState.loading || (!permissions?.edit && !isCreating)\n      }}\n    >\n      <Grid container spacing={2} className={classes.gridMarginTop}>\n        <When condition={Boolean(equivalenceForm.errors?.standards)}>\n          <Grid item xs={12}>\n            <Alert severity=\"error\">{standardErrorMessage}</Alert>\n          </Grid>\n        </When>\n\n        <Grid item xs={9} spacing={2}>\n          <Grid container spacing={2}>\n            <Grid item xs={12} spacing={3}>\n              <FormControllerNumberField\n                label=\"Equivalence #\"\n                name=\"equiv_id\"\n                control={equivalenceForm.control}\n                required\n                decimalScale={0}\n                fixedDecimalScale={false}\n                generateCode\n                disabled={!isCreating}\n                loading={dialogState.loading}\n                onGenerateCode={onGetNextCode}\n              />\n            </Grid>\n\n            <Grid item xs={12}>\n              <FormControllerTextField\n                required\n                label=\"Description\"\n                name=\"description\"\n                control={equivalenceForm.control}\n              />\n            </Grid>\n          </Grid>\n        </Grid>\n\n        <Grid item xs={3} style={{ height: 88 }}>\n          <AppImageField\n            image={watchImage as string}\n            onChange={handleChangeImage}\n            error={equivalenceForm.errors.image?.message || ''}\n          />\n        </Grid>\n\n        <Grid item xs={9}>\n          <AppAutocomplete\n            label=\"Equivalent standards per organization\"\n            value={selectedStandards}\n            multiple\n            limitTags={2}\n            disableCloseOnSelect\n            options={parameters.PLNO}\n            renderOption={(option) => option.description}\n            filterOptions={filterOrganizationOption}\n            onChange={onSelectStandard}\n          />\n        </Grid>\n\n        <Grid item xs={3}>\n          <Button\n            startIcon={<CreateIcon />}\n            onClick={onAddEquivalentStandards}\n            disabled={selectedStandards.length === 0}\n            style={{ textTransform: 'capitalize' }}\n          >\n            Add\n          </Button>\n          <Button\n            startIcon={<DeleteIcon />}\n            onClick={onRemoveEquivalentStandards}\n            disabled={selectedRows.length <= 0}\n            style={{ textTransform: 'capitalize' }}\n          >\n            Remove\n          </Button>\n        </Grid>\n\n        <input\n          type=\"file\"\n          onChange={onChangeFiles}\n          ref={setInputELement}\n          className={classes.input}\n          accept={['image/png', 'image/jpg', 'image/jpeg'].join(',')}\n        />\n\n        <Grid item xs={12}>\n          <Paper>\n            <DataTable\n              tableHeight={equivalenceForm.errors?.standards ? 263 : 335}\n              hideFooter\n              checkboxSelection\n              disableColumnMenu\n              disableSelectionOnClick\n              rows={watchEquivalentStandards}\n              selectionModel={selectedRows}\n              getRowId={(param) => param.organization}\n              onSelectionModelChange={onSelectRows}\n              columns={[\n                {\n                  // ...columnProperties.defaultProperties,\n                  ...columnProperties.editCell('Organization'),\n                  sortable: false,\n                  field: 'organization',\n                  headerName: 'Organization',\n                  flex: 0.5,\n                  valueGetter(params) {\n                    const value = getStandard(params.value as number)\n                    return value\n                  },\n                  valueFormatter(params: any) {\n                    return params.value?.description\n                  },\n                  renderEditCell(params) {\n                    return (\n                      <DataTableAutocomplete\n                        params={params}\n                        options={parameters.PLNO}\n                        onChange={onChangeOrganization(params.id)}\n                        filterOptions={filterOrganizationOption}\n                      />\n                    )\n                  }\n                },\n                {\n                  ...columnProperties.defaultProperties,\n                  ...columnProperties.editCell('Standard'),\n                  field: 'standard',\n                  flex: 0.4,\n                  renderEditCell(params) {\n                    return <DataTableTextField params={params} onChangeValue={onChangeStandard} />\n                  }\n                },\n                {\n                  ...columnProperties.defaultProperties,\n                  field: 'preferred',\n                  headerName: 'Preferred',\n                  width: 100,\n                  align: 'center',\n                  headerAlign: 'center',\n                  renderCell(params) {\n                    return (\n                      <Checkbox\n                        color=\"primary\"\n                        style={{ padding: 0 }}\n                        checked={params.value as boolean}\n                        onChange={onChangePreferred(params.id)}\n                      />\n                    )\n                  }\n                },\n                {\n                  field: 'image',\n                  headerName: 'Image',\n                  sortable: false,\n                  width: 150,\n                  align: 'center',\n                  headerAlign: 'center',\n                  renderCell(params) {\n                    if (params.value) {\n                      return (\n                        <Tooltip\n                          title={\n                            <img\n                              src={\n                                params.value instanceof File ? URL.createObjectURL(params.value) : (params.value as any)\n                              }\n                              style={{ height: '150px' }}\n                            />\n                          }\n                          placement=\"top-end\"\n                        >\n                          <div style={{ display: 'flex' }} onClick={onClickToUploadImage(params.id)}>\n                            <Typography noWrap component=\"div\" style={{ width: 100 }}>\n                              {(params.value as any).name || params.value}\n                            </Typography>\n                            <HighlightOffOutlinedIcon onClick={onRemoveImage(params.id)} />\n                          </div>\n                        </Tooltip>\n                      )\n                    }\n                    return (\n                      <Tooltip title=\"Only PNG, JPG, JPEG files are allowed!\">\n                        <div\n                          style={{ display: 'flex', alignItems: 'center' }}\n                          onClick={onClickToUploadImage(params.id)}\n                        >\n                          <BackupIcon style={{ color: '#0A65FF' }} />\n                        </div>\n                      </Tooltip>\n                    )\n                  }\n                }\n              ]}\n            />\n          </Paper>\n\n          <Unless condition={isCreating}>\n            <SectionTimezone value={equivalenceDetail} />\n          </Unless>\n        </Grid>\n      </Grid>\n    </DialogMain>\n  )\n}\n\nexport default StandardEquivalenceCreateEdit\n"]},"metadata":{},"sourceType":"module"}