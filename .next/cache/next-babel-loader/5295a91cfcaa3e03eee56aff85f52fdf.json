{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport { put, takeEvery, takeLatest } from 'redux-saga/effects';\nimport { select, all, call } from 'typed-redux-saga';\nimport { authStore, advancedFilterActions, commonStore } from '@/store/reducers';\nimport { createAction } from '@reduxjs/toolkit';\nimport * as errorSaga from '@/store/saga/errorSaga';\nimport afApi from '@/apis/advancedFilter.api';\nimport { StatusCode } from '@/utils/StatusCode';\nimport { actionTypes } from '@/utils/constant';\n\nfunction* getEntity() {\n  const entity = yield* select(commonStore.selectEntity);\n  return entity;\n}\n\nfunction* fetchDefaultFilter() {\n  const entity = yield getEntity();\n  const data = yield call(afApi.getInitDataForList, entity);\n  yield put(advancedFilterActions.setDefaultFilter(data.default_filter));\n  yield put(advancedFilterActions.setPermissions(data.permissions.advanced_filters));\n  yield put(advancedFilterActions.setSystemPreset(data.system_default_filter));\n}\n\nfunction* fetchFilterList(filterType = '') {\n  let type = filterType;\n\n  if (!type) {\n    type = yield* select(advancedFilterActions.selectFilterType);\n  }\n\n  const entity = yield getEntity();\n  const {\n    filter_preset_list\n  } = yield call(afApi.getList, {\n    entity,\n    type\n  });\n  yield put(advancedFilterActions.setFilterPresetList(filter_preset_list));\n}\n\nfunction* fetchInitDataForCreateEdit() {\n  const entity = yield getEntity();\n  const data = yield call(afApi.getInitDataForCE, entity);\n  yield put(advancedFilterActions.setInitData(data));\n}\n\nfunction* fetchFilterDetail(id) {\n  const {\n    filter_preset\n  } = yield call(afApi.getDetail, id);\n  const filterType = yield* select(advancedFilterActions.selectFilterType);\n\n  if (filterType === 'shared') {\n    filter_preset.is_user_default = false;\n  }\n\n  yield put(advancedFilterActions.setFilterDetail(filter_preset));\n}\n\nfunction* open() {\n  yield put(advancedFilterActions.setOpenAdvanceSearch(true));\n  yield put(advancedFilterActions.setLoadingSection(true));\n\n  try {\n    yield all([call(fetchDefaultFilter), call(fetchFilterList), call(fetchInitDataForCreateEdit)]);\n    const {\n      user,\n      defaultFilter\n    } = yield* all({\n      user: select(authStore.selectProfile),\n      defaultFilter: select(advancedFilterActions.selectDefaultFilter)\n    });\n\n    if (user.user_id === defaultFilter.created_by) {\n      yield put(advancedFilterActions.setEditMode(true));\n    }\n\n    yield call(fetchFilterDetail, defaultFilter.id);\n    yield put(advancedFilterActions.setExpandedSection(true));\n  } catch (error) {\n    yield errorSaga.handleError(error);\n  }\n\n  yield put(advancedFilterActions.setLoadingSection(false));\n}\n\nfunction* changeFilterType({\n  payload: filterType\n}) {\n  yield put(advancedFilterActions.setLoadingTable(true));\n\n  try {\n    yield call(fetchFilterList, filterType);\n    yield put(advancedFilterActions.setFilterType(filterType));\n  } catch (error) {\n    yield errorSaga.handleError(error);\n  }\n\n  yield put(advancedFilterActions.setLoadingTable(false));\n}\n\nfunction* getList() {\n  yield put(commonStore.actions.setLoadingPage(true));\n\n  try {\n    yield call(fetchFilterList);\n  } catch (error) {\n    yield errorSaga.handleError(error);\n  }\n\n  yield put(commonStore.actions.setLoadingPage(false));\n}\n\nfunction* getDefaultFilter() {\n  yield put(commonStore.actions.setLoadingPage(true));\n\n  try {\n    yield call(fetchDefaultFilter);\n  } catch (error) {\n    yield errorSaga.handleError(error);\n  }\n\n  yield put(commonStore.actions.setLoadingPage(false));\n}\n\nfunction* create() {\n  yield put(commonStore.actions.setLoadingPage(true));\n\n  try {\n    const _yield$select = yield select(advancedFilterActions.selectFilterDetail),\n          {\n      id,\n      created_at,\n      created_by,\n      updated_at,\n      updated_by,\n      is_system_default\n    } = _yield$select,\n          filterDetail = _objectWithoutProperties(_yield$select, [\"id\", \"created_at\", \"created_by\", \"updated_at\", \"updated_by\", \"is_system_default\"]);\n\n    const data = yield call(afApi.create, filterDetail);\n    yield all([call(fetchDefaultFilter), call(fetchFilterList)]);\n    const userInfo = yield select(authStore.selectProfile);\n    yield put(advancedFilterActions.setEditMode(true));\n    yield put(advancedFilterActions.setFilterDetail({\n      id: data.id,\n      created_by: userInfo.user_id,\n      is_system_default: false\n    }));\n    yield put(commonStore.actions.setSuccessMessage(data.message));\n    yield put(advancedFilterActions.setAfForm({\n      clearError: true,\n      error: ''\n    }));\n  } catch (error) {\n    const {\n      response: {\n        data,\n        status\n      }\n    } = error;\n\n    if (status === StatusCode.BAD_REQUEST) {\n      const error = data.message;\n      yield put(advancedFilterActions.setAfForm({\n        error\n      }));\n    } else {\n      yield errorSaga.handleError(error);\n    }\n  }\n\n  yield put(advancedFilterActions.setAfForm({\n    clearError: false,\n    error: ''\n  }));\n  yield put(commonStore.actions.setLoadingPage(false));\n}\n\nfunction* update() {\n  yield put(commonStore.actions.setLoadingPage(true));\n\n  try {\n    const _yield$select2 = yield select(advancedFilterActions.selectFilterDetail),\n          {\n      id,\n      created_at,\n      created_by,\n      updated_at,\n      updated_by,\n      is_system_default\n    } = _yield$select2,\n          filterDetail = _objectWithoutProperties(_yield$select2, [\"id\", \"created_at\", \"created_by\", \"updated_at\", \"updated_by\", \"is_system_default\"]);\n\n    const {\n      message\n    } = yield call(afApi.update, id, filterDetail);\n    yield all([call(fetchDefaultFilter), call(fetchFilterList)]);\n    yield put(commonStore.actions.setSuccessMessage(message));\n    yield put(advancedFilterActions.setAfForm({\n      clearError: true,\n      error: ''\n    }));\n  } catch (error) {\n    const {\n      response: {\n        data,\n        status\n      }\n    } = error;\n\n    if (status === StatusCode.BAD_REQUEST) {\n      const error = data.message;\n      yield put(advancedFilterActions.setAfForm({\n        error\n      }));\n    } else {\n      yield errorSaga.handleError(error);\n    }\n  }\n\n  yield put(advancedFilterActions.setAfForm({\n    clearError: false,\n    error: ''\n  }));\n  yield put(commonStore.actions.setLoadingPage(false));\n}\n\nfunction* share({\n  payload\n}) {\n  yield put(advancedFilterActions.setLoadingTable(true));\n\n  try {\n    const {\n      id,\n      is_shared\n    } = payload;\n    const {\n      message\n    } = yield call(afApi.share, id, is_shared);\n    yield call(fetchFilterList);\n    yield put(commonStore.actions.setSuccessMessage(message));\n  } catch (error) {\n    yield errorSaga.handleError(error);\n  }\n\n  yield put(advancedFilterActions.setLoadingTable(false));\n}\n\nfunction* getDetail({\n  payload: id\n}) {\n  yield put(commonStore.actions.setLoadingPage(true));\n\n  try {\n    yield all([call(fetchInitDataForCreateEdit), call(fetchFilterDetail, id)]);\n    yield put(advancedFilterActions.setEditMode(true));\n  } catch (error) {\n    yield errorSaga.handleError(error);\n  }\n\n  yield put(commonStore.actions.setLoadingPage(false));\n}\n\nfunction* remove() {\n  yield put(commonStore.actions.setLoadingPage(true));\n\n  try {\n    const {\n      id\n    } = yield select(advancedFilterActions.selectFilterDetail);\n    const {\n      message\n    } = yield call(afApi.remove, id);\n    yield all([call(fetchDefaultFilter), call(fetchFilterList)]);\n    const defaultFilter = yield select(advancedFilterActions.selectDefaultFilter);\n    yield call(fetchFilterDetail, defaultFilter.id);\n    yield put(commonStore.actions.setSuccessMessage(message));\n  } catch (error) {\n    yield errorSaga.handleError(error);\n  }\n\n  yield put(commonStore.actions.setLoadingPage(false));\n}\n\nfunction* clearDefaultFilter() {\n  yield put(commonStore.actions.setLoadingPage(true));\n\n  try {\n    const entity = yield getEntity();\n    const {\n      message\n    } = yield call(afApi.clearDefault, entity);\n    yield call(fetchDefaultFilter);\n    const filterDefault = yield select(advancedFilterActions.selectDefaultFilter);\n    yield put(advancedFilterActions.setFilterDetail(filterDefault));\n    yield put(commonStore.actions.setSuccessMessage(message));\n  } catch (error) {\n    yield errorSaga.handleError(error);\n  }\n\n  yield put(commonStore.actions.setLoadingPage(false));\n}\n\nfunction* saveAs({\n  payload: name\n}) {\n  yield put(advancedFilterActions.setLoadingDialog(true));\n\n  try {\n    const _yield$select3 = yield select(advancedFilterActions.selectFilterDetail),\n          {\n      id,\n      created_at,\n      created_by,\n      updated_at,\n      updated_by,\n      is_system_default\n    } = _yield$select3,\n          filterDetail = _objectWithoutProperties(_yield$select3, [\"id\", \"created_at\", \"created_by\", \"updated_at\", \"updated_by\", \"is_system_default\"]);\n\n    const copyFilterDetail = _objectSpread(_objectSpread({}, filterDetail), {}, {\n      name\n    });\n\n    const data = yield call(afApi.create, copyFilterDetail);\n    yield all([call(fetchDefaultFilter), call(fetchFilterList)]);\n    const userInfo = yield select(authStore.selectProfile);\n    yield put(advancedFilterActions.setEditMode(true));\n    yield put(advancedFilterActions.setFilterDetail({\n      id: data.id,\n      created_by: userInfo.user_id,\n      is_system_default: false,\n      name\n    }));\n    yield put(commonStore.actions.setSuccessMessage(data.message));\n    yield put(advancedFilterActions.setSaveAsForm({\n      open: false,\n      clearError: true,\n      error: ''\n    }));\n  } catch (error) {\n    const {\n      response: {\n        data,\n        status\n      }\n    } = error;\n\n    if (status === StatusCode.BAD_REQUEST) {\n      const error = data.message;\n      yield put(advancedFilterActions.setSaveAsForm({\n        error\n      }));\n    } else {\n      yield errorSaga.handleError(error);\n    }\n  }\n\n  yield put(advancedFilterActions.setSaveAsForm({\n    clearError: false,\n    error: ''\n  }));\n  yield put(advancedFilterActions.setLoadingDialog(false));\n}\n\nfunction* apply() {\n  let entity = yield* getEntity();\n\n  if (entity === 'manufacturing_standard' || entity === 'material_standard') {\n    entity = 'equivalence';\n  }\n\n  const getListAction = createAction(`${entity}/${actionTypes.GET_LIST}`);\n  yield put(commonStore.actions.setTableState({\n    page: 1\n  }));\n  yield put(getListAction());\n  yield put(commonStore.actions.setSuccessMessage('The filter preset is applied successfully! This result is temporary'));\n}\n\nfunction* close() {\n  let entity = yield* getEntity();\n\n  if (entity === 'manufacturing_standard' || entity === 'material_standard') {\n    entity = 'equivalence';\n  }\n\n  const getListAction = createAction(`${entity}/${actionTypes.GET_LIST}`);\n  yield put(getListAction());\n}\n\nfunction* advancedFilterSaga() {\n  yield takeEvery(advancedFilterActions.getList, getList);\n  yield takeEvery(advancedFilterActions.create, create);\n  yield takeEvery(advancedFilterActions.update, update);\n  yield takeEvery(advancedFilterActions.getDetail, getDetail);\n  yield takeEvery(advancedFilterActions.share, share);\n  yield takeLatest(advancedFilterActions.remove, remove);\n  yield takeLatest(advancedFilterActions.clearDefaultFilter, clearDefaultFilter);\n  yield takeEvery(advancedFilterActions.getDefaultFilter, getDefaultFilter);\n  yield takeEvery(advancedFilterActions.changeFilterType, changeFilterType);\n  yield takeEvery(advancedFilterActions.saveAs, saveAs);\n  yield takeEvery(advancedFilterActions.open, open);\n  yield takeEvery(advancedFilterActions.apply, apply);\n  yield takeEvery(advancedFilterActions.close, close);\n}\n\nexport default advancedFilterSaga;","map":{"version":3,"sources":["D:/TTS_Reactjs/malis-3-frontend/src/store/saga/advancedFilter.saga.ts"],"names":["put","takeEvery","takeLatest","select","all","call","authStore","advancedFilterActions","commonStore","createAction","errorSaga","afApi","StatusCode","actionTypes","getEntity","entity","selectEntity","fetchDefaultFilter","data","getInitDataForList","setDefaultFilter","default_filter","setPermissions","permissions","advanced_filters","setSystemPreset","system_default_filter","fetchFilterList","filterType","type","selectFilterType","filter_preset_list","getList","setFilterPresetList","fetchInitDataForCreateEdit","getInitDataForCE","setInitData","fetchFilterDetail","id","filter_preset","getDetail","is_user_default","setFilterDetail","open","setOpenAdvanceSearch","setLoadingSection","user","defaultFilter","selectProfile","selectDefaultFilter","user_id","created_by","setEditMode","setExpandedSection","error","handleError","changeFilterType","payload","setLoadingTable","setFilterType","actions","setLoadingPage","getDefaultFilter","create","selectFilterDetail","created_at","updated_at","updated_by","is_system_default","filterDetail","userInfo","setSuccessMessage","message","setAfForm","clearError","response","status","BAD_REQUEST","update","share","is_shared","remove","clearDefaultFilter","clearDefault","filterDefault","saveAs","name","setLoadingDialog","copyFilterDetail","setSaveAsForm","apply","getListAction","GET_LIST","setTableState","page","close","advancedFilterSaga"],"mappings":"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","sourcesContent":["import { put, takeEvery, takeLatest } from 'redux-saga/effects'\n\nimport { select, all, call } from 'typed-redux-saga'\n\nimport { authStore, advancedFilterActions, commonStore } from '@/store/reducers'\n\nimport { createAction } from '@reduxjs/toolkit'\n\nimport * as errorSaga from '@/store/saga/errorSaga'\n\nimport afApi from '@/apis/advancedFilter.api'\nimport { StatusCode } from '@/utils/StatusCode'\nimport { actionTypes } from '@/utils/constant'\n\nfunction* getEntity() {\n  const entity = yield* select(commonStore.selectEntity)\n  return entity\n}\n\nfunction* fetchDefaultFilter() {\n  const entity = yield getEntity()\n  const data = yield call(afApi.getInitDataForList, entity)\n  yield put(advancedFilterActions.setDefaultFilter(data.default_filter))\n  yield put(advancedFilterActions.setPermissions(data.permissions.advanced_filters))\n  yield put(advancedFilterActions.setSystemPreset(data.system_default_filter))\n}\n\nfunction* fetchFilterList(filterType = '') {\n  let type = filterType\n  if (!type) {\n    type = yield* select(advancedFilterActions.selectFilterType)\n  }\n  const entity = yield getEntity()\n  const { filter_preset_list } = yield call(afApi.getList, { entity, type })\n  yield put(advancedFilterActions.setFilterPresetList(filter_preset_list))\n}\n\nfunction* fetchInitDataForCreateEdit() {\n  const entity = yield getEntity()\n  const data = yield call(afApi.getInitDataForCE, entity)\n  yield put(advancedFilterActions.setInitData(data))\n}\n\nfunction* fetchFilterDetail(id: number) {\n  const { filter_preset } = yield call(afApi.getDetail, id)\n  const filterType = yield* select(advancedFilterActions.selectFilterType)\n  if (filterType === 'shared') {\n    filter_preset.is_user_default = false\n  }\n  yield put(advancedFilterActions.setFilterDetail(filter_preset))\n}\n\nfunction* open() {\n  yield put(advancedFilterActions.setOpenAdvanceSearch(true))\n  yield put(advancedFilterActions.setLoadingSection(true))\n\n  try {\n    yield all([call(fetchDefaultFilter), call(fetchFilterList), call(fetchInitDataForCreateEdit)])\n    const { user, defaultFilter } = yield* all({\n      user: select(authStore.selectProfile),\n      defaultFilter: select(advancedFilterActions.selectDefaultFilter)\n    })\n    if (user.user_id === defaultFilter.created_by) {\n      yield put(advancedFilterActions.setEditMode(true))\n    }\n    yield call(fetchFilterDetail, defaultFilter.id)\n    yield put(advancedFilterActions.setExpandedSection(true))\n  } catch (error) {\n    yield errorSaga.handleError(error)\n  }\n  yield put(advancedFilterActions.setLoadingSection(false))\n}\n\nfunction* changeFilterType({ payload: filterType }) {\n  yield put(advancedFilterActions.setLoadingTable(true))\n  try {\n    yield call(fetchFilterList, filterType)\n    yield put(advancedFilterActions.setFilterType(filterType))\n  } catch (error) {\n    yield errorSaga.handleError(error)\n  }\n  yield put(advancedFilterActions.setLoadingTable(false))\n}\n\nfunction* getList() {\n  yield put(commonStore.actions.setLoadingPage(true))\n\n  try {\n    yield call(fetchFilterList)\n  } catch (error) {\n    yield errorSaga.handleError(error)\n  }\n\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nfunction* getDefaultFilter() {\n  yield put(commonStore.actions.setLoadingPage(true))\n  try {\n    yield call(fetchDefaultFilter)\n  } catch (error) {\n    yield errorSaga.handleError(error)\n  }\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nfunction* create() {\n  yield put(commonStore.actions.setLoadingPage(true))\n  try {\n    const { id, created_at, created_by, updated_at, updated_by, is_system_default, ...filterDetail } = yield select(\n      advancedFilterActions.selectFilterDetail\n    )\n    const data = yield call(afApi.create, filterDetail)\n    yield all([call(fetchDefaultFilter), call(fetchFilterList)])\n    const userInfo = yield select(authStore.selectProfile)\n    yield put(advancedFilterActions.setEditMode(true))\n    yield put(\n      advancedFilterActions.setFilterDetail({\n        id: data.id,\n        created_by: userInfo.user_id,\n        is_system_default: false\n      })\n    )\n    yield put(commonStore.actions.setSuccessMessage(data.message))\n    yield put(\n      advancedFilterActions.setAfForm({\n        clearError: true,\n        error: ''\n      })\n    )\n  } catch (error) {\n    const {\n      response: { data, status }\n    } = error\n    if (status === StatusCode.BAD_REQUEST) {\n      const error = data.message\n      yield put(advancedFilterActions.setAfForm({ error }))\n    } else {\n      yield errorSaga.handleError(error)\n    }\n  }\n  yield put(advancedFilterActions.setAfForm({ clearError: false, error: '' }))\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nfunction* update() {\n  yield put(commonStore.actions.setLoadingPage(true))\n  try {\n    const { id, created_at, created_by, updated_at, updated_by, is_system_default, ...filterDetail } = yield select(\n      advancedFilterActions.selectFilterDetail\n    )\n    const { message } = yield call(afApi.update, id, filterDetail)\n    yield all([call(fetchDefaultFilter), call(fetchFilterList)])\n    yield put(commonStore.actions.setSuccessMessage(message))\n    yield put(\n      advancedFilterActions.setAfForm({\n        clearError: true,\n        error: ''\n      })\n    )\n  } catch (error) {\n    const {\n      response: { data, status }\n    } = error\n    if (status === StatusCode.BAD_REQUEST) {\n      const error = data.message\n      yield put(advancedFilterActions.setAfForm({ error }))\n    } else {\n      yield errorSaga.handleError(error)\n    }\n  }\n  yield put(advancedFilterActions.setAfForm({ clearError: false, error: '' }))\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nfunction* share({ payload }: ReturnType<typeof advancedFilterActions.share>) {\n  yield put(advancedFilterActions.setLoadingTable(true))\n  try {\n    const { id, is_shared } = payload\n    const { message } = yield call(afApi.share, id, is_shared)\n    yield call(fetchFilterList)\n    yield put(commonStore.actions.setSuccessMessage(message))\n  } catch (error) {\n    yield errorSaga.handleError(error)\n  }\n  yield put(advancedFilterActions.setLoadingTable(false))\n}\n\nfunction* getDetail({ payload: id }) {\n  yield put(commonStore.actions.setLoadingPage(true))\n  try {\n    yield all([call(fetchInitDataForCreateEdit), call(fetchFilterDetail, id)])\n    yield put(advancedFilterActions.setEditMode(true))\n  } catch (error) {\n    yield errorSaga.handleError(error)\n  }\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nfunction* remove() {\n  yield put(commonStore.actions.setLoadingPage(true))\n  try {\n    const { id } = yield select(advancedFilterActions.selectFilterDetail)\n    const { message } = yield call(afApi.remove, id)\n    yield all([call(fetchDefaultFilter), call(fetchFilterList)])\n    const defaultFilter = yield select(advancedFilterActions.selectDefaultFilter)\n    yield call(fetchFilterDetail, defaultFilter.id)\n    yield put(commonStore.actions.setSuccessMessage(message))\n  } catch (error) {\n    yield errorSaga.handleError(error)\n  }\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nfunction* clearDefaultFilter() {\n  yield put(commonStore.actions.setLoadingPage(true))\n  try {\n    const entity = yield getEntity()\n    const { message } = yield call(afApi.clearDefault, entity)\n    yield call(fetchDefaultFilter)\n    const filterDefault = yield select(advancedFilterActions.selectDefaultFilter)\n    yield put(advancedFilterActions.setFilterDetail(filterDefault))\n    yield put(commonStore.actions.setSuccessMessage(message))\n  } catch (error) {\n    yield errorSaga.handleError(error)\n  }\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nfunction* saveAs({ payload: name }) {\n  yield put(advancedFilterActions.setLoadingDialog(true))\n  try {\n    const { id, created_at, created_by, updated_at, updated_by, is_system_default, ...filterDetail } = yield select(\n      advancedFilterActions.selectFilterDetail\n    )\n    const copyFilterDetail = { ...filterDetail, name }\n    const data = yield call(afApi.create, copyFilterDetail)\n    yield all([call(fetchDefaultFilter), call(fetchFilterList)])\n    const userInfo = yield select(authStore.selectProfile)\n    yield put(advancedFilterActions.setEditMode(true))\n    yield put(\n      advancedFilterActions.setFilterDetail({\n        id: data.id,\n        created_by: userInfo.user_id,\n        is_system_default: false,\n        name\n      })\n    )\n    yield put(commonStore.actions.setSuccessMessage(data.message))\n    yield put(\n      advancedFilterActions.setSaveAsForm({\n        open: false,\n        clearError: true,\n        error: ''\n      })\n    )\n  } catch (error) {\n    const {\n      response: { data, status }\n    } = error\n    if (status === StatusCode.BAD_REQUEST) {\n      const error = data.message\n      yield put(advancedFilterActions.setSaveAsForm({ error }))\n    } else {\n      yield errorSaga.handleError(error)\n    }\n  }\n  yield put(advancedFilterActions.setSaveAsForm({ clearError: false, error: '' }))\n  yield put(advancedFilterActions.setLoadingDialog(false))\n}\n\nfunction* apply() {\n  let entity = yield* getEntity()\n  if (entity === 'manufacturing_standard' || entity === 'material_standard') {\n    entity = 'equivalence'\n  }\n  const getListAction = createAction(`${entity}/${actionTypes.GET_LIST}`)\n  yield put(commonStore.actions.setTableState({ page: 1 }))\n  yield put(getListAction())\n  yield put(\n    commonStore.actions.setSuccessMessage('The filter preset is applied successfully! This result is temporary')\n  )\n}\n\nfunction* close() {\n  let entity = yield* getEntity()\n  if (entity === 'manufacturing_standard' || entity === 'material_standard') {\n    entity = 'equivalence'\n  }\n  const getListAction = createAction(`${entity}/${actionTypes.GET_LIST}`)\n  yield put(getListAction())\n}\n\nfunction* advancedFilterSaga() {\n  yield takeEvery(advancedFilterActions.getList, getList)\n  yield takeEvery(advancedFilterActions.create, create)\n  yield takeEvery(advancedFilterActions.update, update)\n  yield takeEvery(advancedFilterActions.getDetail, getDetail)\n  yield takeEvery(advancedFilterActions.share, share)\n  yield takeLatest(advancedFilterActions.remove, remove)\n  yield takeLatest(advancedFilterActions.clearDefaultFilter, clearDefaultFilter)\n  yield takeEvery(advancedFilterActions.getDefaultFilter, getDefaultFilter)\n  yield takeEvery(advancedFilterActions.changeFilterType, changeFilterType)\n  yield takeEvery(advancedFilterActions.saveAs, saveAs)\n  yield takeEvery(advancedFilterActions.open, open)\n  yield takeEvery(advancedFilterActions.apply, apply)\n  yield takeEvery(advancedFilterActions.close, close)\n}\n\nexport default advancedFilterSaga\n"]},"metadata":{},"sourceType":"module"}