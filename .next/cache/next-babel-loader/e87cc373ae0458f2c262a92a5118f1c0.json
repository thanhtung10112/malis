{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"D:\\\\TTS_Reactjs\\\\malis-3-frontend\\\\src\\\\components\\\\Dialog\\\\Module\\\\Material\\\\CreateEdit.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport { useEffect, useMemo } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { useTranslation } from 'react-i18next';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { DialogMain, FormControllerTabs, TableExtendedProperties, BtnHelp } from '@/components';\nimport TabGeneral from './TabGeneral';\nimport { commonStore, materialStore } from '@/store/reducers';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport getValidationSchema from './validationSchema';\n\nvar DialogMaterialCE = function DialogMaterialCE() {\n  _s();\n\n  var _permissions;\n\n  var _useTranslation = useTranslation('material'),\n      t = _useTranslation.t;\n\n  var dispatch = useDispatch();\n  var dialogState = useSelector(materialStore.selectDialogState);\n  var specificationDetail = useSelector(materialStore.selectDetail);\n  var userDrawing = useSelector(commonStore.selectUserValueDrawing);\n  var vaidationSchema = useMemo(function () {\n    return getValidationSchema(t);\n  }, []);\n  var specificationForm = useForm({\n    shouldUnregister: false,\n    resolver: yupResolver(vaidationSchema)\n  });\n  useEffect(function () {\n    specificationForm.reset(specificationDetail);\n  }, [specificationDetail]);\n  useEffect(function () {\n    if (userDrawing.value === -1) {\n      dispatch(materialStore.actions.setDetail({\n        drawing_id: null\n      }));\n    } else {\n      dispatch(materialStore.actions.setDetail({\n        drawing_id: userDrawing\n      }));\n    }\n  }, [userDrawing]);\n  var handleSubmitForm = specificationForm.handleSubmit(function (formData) {\n    console.warn('formData', '>>>', formData);\n  });\n\n  var handleClose = function handleClose() {\n    dispatch(materialStore.actions.setDialogStateOpen(false));\n  };\n\n  var handleChangeTab = function handleChangeTab(event, nextTab) {\n    dispatch(materialStore.actions.setDialogStateTab(nextTab));\n  };\n\n  var generalTab = {\n    label: t('common:tab.general'),\n    panel: /*#__PURE__*/_jsxDEV(TabGeneral, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 12\n    }, _this),\n    errorKey: ['drawing_id', 'spec_id', 'job_id']\n  };\n  var extendedPropertyTab = {\n    label: t('common:tab.extended_properties'),\n    panel: /*#__PURE__*/_jsxDEV(TableExtendedProperties, {\n      control: specificationForm.control,\n      name: \"additional_attributes\",\n      editMode: !isCreating,\n      propertiesList: parameters.SSAT,\n      tableHeight: 335,\n      parameterName: \"SSAT\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, _this)\n  };\n  var tabs = [generalTab, extendedPropertyTab, historyTab];\n  return /*#__PURE__*/_jsxDEV(DialogMain, {\n    fullWidth: true,\n    maxWidth: \"md\",\n    open: dialogState.open,\n    loading: dialogState.loading,\n    title: /*#__PURE__*/_jsxDEV(BtnHelp, {\n      title: isCreating ? t('form.title.create_specification') : t('form.title.update_specification'),\n      href: wiki_page\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }, _this),\n    onOk: handleSubmitForm,\n    onClose: handleClose,\n    okText: isCreating ? t('common:button.create') : t('common:button.update'),\n    okButtonProps: {\n      disabled: dialogState.loading || !((_permissions = permissions) === null || _permissions === void 0 ? void 0 : _permissions.edit) && !isCreating\n    },\n    children: /*#__PURE__*/_jsxDEV(FormControllerTabs, {\n      form: specificationForm,\n      value: dialogState.tab,\n      onChange: handleChangeTab,\n      tabs: tabs\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(DialogMaterialCE, \"X7bs64xrOvV4sjsiywHlHeG6F0g=\", false, function () {\n  return [useTranslation, useDispatch, useSelector, useSelector, useSelector, useForm];\n});\n\n_c = DialogMaterialCE;\nexport default DialogMaterialCE;\n\nvar _c;\n\n$RefreshReg$(_c, \"DialogMaterialCE\");","map":{"version":3,"sources":["D:/TTS_Reactjs/malis-3-frontend/src/components/Dialog/Module/Material/CreateEdit.tsx"],"names":["useEffect","useMemo","useForm","useTranslation","useDispatch","useSelector","DialogMain","FormControllerTabs","TableExtendedProperties","BtnHelp","TabGeneral","commonStore","materialStore","yupResolver","getValidationSchema","DialogMaterialCE","t","dispatch","dialogState","selectDialogState","specificationDetail","selectDetail","userDrawing","selectUserValueDrawing","vaidationSchema","specificationForm","shouldUnregister","resolver","reset","value","actions","setDetail","drawing_id","handleSubmitForm","handleSubmit","formData","console","warn","handleClose","setDialogStateOpen","handleChangeTab","event","nextTab","setDialogStateTab","generalTab","label","panel","errorKey","extendedPropertyTab","control","isCreating","parameters","SSAT","tabs","historyTab","open","loading","wiki_page","disabled","permissions","edit","tab"],"mappings":"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","sourcesContent":["import { useEffect, useMemo } from 'react'\nimport { useForm } from 'react-hook-form'\nimport { useTranslation } from 'react-i18next'\nimport { useDispatch, useSelector } from 'react-redux'\n\nimport { DialogMain, FormControllerTabs, AppTabHistoryLog, TableExtendedProperties, BtnHelp } from '@/components'\nimport TabGeneral from './TabGeneral'\n\nimport { commonStore, materialStore } from '@/store/reducers'\nimport { yupResolver } from '@hookform/resolvers/yup'\nimport _ from 'lodash'\nimport getValidationSchema from './validationSchema'\n\nimport type { SpecificationDetail } from '@/types/Specification'\nimport type { DataForDropdown, HistoryLog } from '@/types/Common'\n\nconst DialogMaterialCE = () => {\n  const { t } = useTranslation('material')\n\n  const dispatch = useDispatch()\n\n  const dialogState = useSelector(materialStore.selectDialogState)\n  const specificationDetail = useSelector(materialStore.selectDetail)\n  const userDrawing = useSelector(commonStore.selectUserValueDrawing)\n\n  const vaidationSchema = useMemo(() => getValidationSchema(t), [])\n  const specificationForm = useForm<SpecificationDetail>({\n    shouldUnregister: false,\n    resolver: yupResolver(vaidationSchema)\n  })\n\n  useEffect(() => {\n    specificationForm.reset(specificationDetail)\n  }, [specificationDetail])\n\n  useEffect(() => {\n    if (userDrawing.value === -1) {\n      dispatch(materialStore.actions.setDetail({ drawing_id: null }))\n    } else {\n      dispatch(materialStore.actions.setDetail({ drawing_id: userDrawing }))\n    }\n  }, [userDrawing])\n\n  const handleSubmitForm = specificationForm.handleSubmit((formData) => {\n    console.warn('formData', '>>>', formData)\n  })\n\n  const handleClose = () => {\n    dispatch(materialStore.actions.setDialogStateOpen(false))\n  }\n\n  const handleChangeTab = (event, nextTab: number) => {\n    dispatch(materialStore.actions.setDialogStateTab(nextTab))\n  }\n\n  const generalTab = {\n    label: t('common:tab.general'),\n    panel: <TabGeneral />,\n    errorKey: ['drawing_id', 'spec_id', 'job_id']\n  }\n\n  const extendedPropertyTab = {\n    label: t('common:tab.extended_properties'),\n    panel: (\n      <TableExtendedProperties\n        control={specificationForm.control}\n        name=\"additional_attributes\"\n        editMode={!isCreating}\n        propertiesList={parameters.SSAT}\n        tableHeight={335}\n        parameterName=\"SSAT\"\n      />\n    )\n  }\n\n  const tabs = [generalTab, extendedPropertyTab, historyTab]\n\n  return (\n    <DialogMain\n      fullWidth\n      maxWidth=\"md\"\n      open={dialogState.open}\n      loading={dialogState.loading}\n      title={\n        <BtnHelp\n          title={isCreating ? t('form.title.create_specification') : t('form.title.update_specification')}\n          href={wiki_page}\n        />\n      }\n      onOk={handleSubmitForm}\n      onClose={handleClose}\n      okText={isCreating ? t('common:button.create') : t('common:button.update')}\n      okButtonProps={{\n        disabled: dialogState.loading || (!permissions?.edit && !isCreating)\n      }}\n    >\n      <FormControllerTabs form={specificationForm} value={dialogState.tab} onChange={handleChangeTab} tabs={tabs} />\n    </DialogMain>\n  )\n}\n\nexport default DialogMaterialCE\n"]},"metadata":{},"sourceType":"module"}