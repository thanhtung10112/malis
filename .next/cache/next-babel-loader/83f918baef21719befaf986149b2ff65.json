{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\Fersher\\\\TTS_Reactjs\\\\malis-3-frontend\\\\src\\\\components\\\\Dialog\\\\Common\\\\SSEProcess\\\\index.tsx\";\nimport React from 'react';\nimport { CircularProgress, Typography } from '@material-ui/core';\nimport { CheckCircleRounded, HighlightOffOutlined } from '@material-ui/icons';\nimport { Case, Default, Switch } from 'react-if';\nimport { DialogMain, useConfirm } from '@/components/index';\nimport { useDispatch } from 'react-redux';\nimport useSSE from '@/hooks/useSSE';\nimport _ from 'lodash';\nimport { commonStore } from '@/store/reducers';\n\nfunction DialogSSEProcess(props) {\n  const {\n    open,\n    operationId,\n    onClose,\n    onSuccess,\n    onError\n  } = props;\n  const {\n    dataSSE,\n    setDataSSE\n  } = useSSE(operationId);\n  const {\n    confirm,\n    handleClose: handleCloseConfirm\n  } = useConfirm();\n  const dispatch = useDispatch();\n  const isCompleted = React.useMemo(() => dataSSE.status === 'SUCCESS' || dataSSE.status === 'ERROR', [dataSSE.status]);\n  React.useEffect(() => {\n    if (isCompleted) {\n      handleCloseConfirm();\n      onClose();\n\n      if (_.isFunction(onSuccess) && dataSSE.status === 'SUCCESS') {\n        onSuccess(operationId, dataSSE);\n      }\n\n      if (_.isFunction(onError) && dataSSE.status === 'ERROR') {\n        onError(operationId, dataSSE);\n      }\n    }\n  }, [isCompleted]);\n  /**\n   * This hook to reset state if open = false\n   */\n\n  React.useEffect(() => {\n    if (!open) {\n      setDataSSE({\n        message: 'Initializing...',\n        status: null,\n        operation_result: null\n      });\n    }\n  }, [open]);\n\n  const handleCancelProcess = async () => {\n    const result = await confirm({\n      title: 'Confirm canceling exporting progress',\n      description: 'The progress is not completed yet. Are you sure you want to cancel?'\n    });\n\n    if (result === 'OK') {\n      onClose();\n      dispatch(commonStore.sagaCancelBackgroundJob(operationId));\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(DialogMain, {\n    open: open,\n    onClose: isCompleted ? onClose : handleCancelProcess,\n    maxWidth: \"xs\",\n    fullWidth: true,\n    bodyStyles: {\n      margin: 'auto',\n      textAlign: 'center'\n    },\n    closeText: isCompleted ? 'Close' : 'Cancel',\n    children: [/*#__PURE__*/_jsxDEV(Switch, {\n      children: [/*#__PURE__*/_jsxDEV(Case, {\n        condition: dataSSE.status === 'SUCCESS',\n        children: /*#__PURE__*/_jsxDEV(CheckCircleRounded, {\n          fontSize: \"large\",\n          style: {\n            marginTop: '1rem'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Case, {\n        condition: dataSSE.status === 'ERROR',\n        children: /*#__PURE__*/_jsxDEV(HighlightOffOutlined, {\n          fontSize: \"large\",\n          style: {\n            marginTop: '1rem'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Default, {\n        children: /*#__PURE__*/_jsxDEV(CircularProgress, {\n          style: {\n            marginTop: '1rem'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"body1\",\n      style: {\n        marginTop: '1rem'\n      },\n      children: dataSSE.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this);\n}\n\nexport default DialogSSEProcess;","map":{"version":3,"sources":["D:/Fersher/TTS_Reactjs/malis-3-frontend/src/components/Dialog/Common/SSEProcess/index.tsx"],"names":["React","CircularProgress","Typography","CheckCircleRounded","HighlightOffOutlined","Case","Default","Switch","DialogMain","useConfirm","useDispatch","useSSE","_","commonStore","DialogSSEProcess","props","open","operationId","onClose","onSuccess","onError","dataSSE","setDataSSE","confirm","handleClose","handleCloseConfirm","dispatch","isCompleted","useMemo","status","useEffect","isFunction","message","operation_result","handleCancelProcess","result","title","description","sagaCancelBackgroundJob","margin","textAlign","marginTop"],"mappings":"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","sourcesContent":["import React from 'react'\n\nimport { CircularProgress, Typography } from '@material-ui/core'\n\nimport { CheckCircleRounded, HighlightOffOutlined } from '@material-ui/icons'\n\nimport { Case, Default, Switch } from 'react-if'\n\nimport { DialogMain, useConfirm } from '@/components/index'\n\nimport { useDispatch } from 'react-redux'\nimport useSSE from '@/hooks/useSSE'\n\nimport _ from 'lodash'\nimport { commonStore } from '@/store/reducers'\n\nimport type { DialogSSEProcessProps } from './type'\n\nfunction DialogSSEProcess(props: DialogSSEProcessProps) {\n  const { open, operationId, onClose, onSuccess, onError } = props\n  const { dataSSE, setDataSSE } = useSSE(operationId)\n  const { confirm, handleClose: handleCloseConfirm } = useConfirm()\n\n  const dispatch = useDispatch()\n\n  const isCompleted = React.useMemo(() => dataSSE.status === 'SUCCESS' || dataSSE.status === 'ERROR', [dataSSE.status])\n\n  React.useEffect(() => {\n    if (isCompleted) {\n      handleCloseConfirm()\n      onClose()\n      if (_.isFunction(onSuccess) && dataSSE.status === 'SUCCESS') {\n        onSuccess(operationId, dataSSE)\n      }\n      if (_.isFunction(onError) && dataSSE.status === 'ERROR') {\n        onError(operationId, dataSSE)\n      }\n    }\n  }, [isCompleted])\n\n  /**\n   * This hook to reset state if open = false\n   */\n  React.useEffect(() => {\n    if (!open) {\n      setDataSSE({\n        message: 'Initializing...',\n        status: null,\n        operation_result: null\n      })\n    }\n  }, [open])\n\n  const handleCancelProcess = async () => {\n    const result = await confirm({\n      title: 'Confirm canceling exporting progress',\n      description: 'The progress is not completed yet. Are you sure you want to cancel?'\n    })\n    if (result === 'OK') {\n      onClose()\n      dispatch(commonStore.sagaCancelBackgroundJob(operationId))\n    }\n  }\n\n  return (\n    <DialogMain\n      open={open}\n      onClose={isCompleted ? onClose : handleCancelProcess}\n      maxWidth=\"xs\"\n      fullWidth\n      bodyStyles={{ margin: 'auto', textAlign: 'center' }}\n      closeText={isCompleted ? 'Close' : 'Cancel'}\n    >\n      <Switch>\n        <Case condition={dataSSE.status === 'SUCCESS'}>\n          <CheckCircleRounded fontSize=\"large\" style={{ marginTop: '1rem' }} />\n        </Case>\n        <Case condition={dataSSE.status === 'ERROR'}>\n          <HighlightOffOutlined fontSize=\"large\" style={{ marginTop: '1rem' }} />\n        </Case>\n        <Default>\n          <CircularProgress style={{ marginTop: '1rem' }} />\n        </Default>\n      </Switch>\n\n      <Typography variant=\"body1\" style={{ marginTop: '1rem' }}>\n        {dataSSE.message}\n      </Typography>\n    </DialogMain>\n  )\n}\n\nexport default DialogSSEProcess\n"]},"metadata":{},"sourceType":"module"}