{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"D:\\\\Fersher\\\\TTS_Reactjs\\\\malis-3-frontend\\\\src\\\\components\\\\Dialog\\\\Module\\\\Drawing\\\\TabDetail\\\\index.tsx\",\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState } from 'react';\nimport { useFormContext } from 'react-hook-form';\nimport useStyles from './styles';\nimport { useSelector } from 'react-redux';\nimport { Button, FormControl, Grid, Paper, Switch, Typography } from '@material-ui/core';\nimport { AppTitle, DataTable, DeleteIcon, FormControllerCheckbox, CreateIcon, AppAutocompleteAsync } from '@/components';\nimport _ from 'lodash';\nimport * as columnProperties from '@/utils/columnProperties';\nimport { drawingStore, commonStore } from '@/store/reducers';\n\nfunction TabDetail() {\n  _s();\n\n  var classes = useStyles();\n\n  var _useState = useState([]),\n      selectedDocs = _useState[0],\n      setSelectedDocs = _useState[1];\n\n  var _useState2 = useState([]),\n      selectedDocOptions = _useState2[0],\n      setSelectedDocOptions = _useState2[1];\n\n  var drawingForm = useFormContext();\n  var watchAssociatedDocs = drawingForm.watch('associated_documents', []);\n  var watchDrawingsWithoutParts = drawingForm.watch('drawings_without_parts', false);\n  var userJob = useSelector(commonStore.selectUserValueJob);\n  var drawingDetail = useSelector(drawingStore.selectDetail);\n\n  var isCreating = _.isNil(drawingDetail.id);\n\n  var handleAddDocs = function handleAddDocs() {\n    var _drawingForm$getValue = drawingForm.getValues(),\n        associated_documents = _drawingForm$getValue.associated_documents;\n\n    associated_documents.push.apply(associated_documents, _toConsumableArray(selectedDocOptions));\n    drawingForm.setValue('associated_documents', associated_documents);\n    setSelectedDocOptions([]);\n  };\n\n  var handleSelectDoc = function handleSelectDoc(_ref) {\n    var selectionModel = _ref.selectionModel;\n    setSelectedDocs(selectionModel);\n  };\n\n  var handleDeleteDocs = function handleDeleteDocs() {\n    var _drawingForm$getValue2 = drawingForm.getValues(),\n        associated_documents = _drawingForm$getValue2.associated_documents;\n\n    var newDocs = associated_documents.filter(function (doc) {\n      return !selectedDocs.includes(doc.value);\n    });\n    setSelectedDocs([]);\n    drawingForm.setValue('associated_documents', newDocs);\n  };\n\n  var handleSelectDrawing = function handleSelectDrawing(event, options) {\n    setSelectedDocOptions(options);\n  };\n\n  var handleSwitchDrawingSearch = function handleSwitchDrawingSearch(event, checked) {\n    drawingForm.setValue('drawings_without_parts', checked);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    container: true,\n    spacing: 1,\n    children: [/*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 12,\n      children: /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 6,\n          children: /*#__PURE__*/_jsxDEV(AppTitle, {\n            label: \"Associated detailed documents\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 62,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 6,\n          className: classes.switchButton,\n          children: [/*#__PURE__*/_jsxDEV(FormControl, {\n            style: {},\n            children: /*#__PURE__*/_jsxDEV(Switch, {\n              color: \"primary\",\n              inputProps: {\n                'aria-label': 'primary checkbox'\n              },\n              checked: watchDrawingsWithoutParts,\n              onChange: handleSwitchDrawingSearch\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 66,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n            className: classes.label,\n            children: \"All job/std drawing\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 12,\n      children: /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        spacing: 3,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 8,\n          children: /*#__PURE__*/_jsxDEV(AppAutocompleteAsync, {\n            label: \"Document\",\n            onChange: handleSelectDrawing,\n            compName: \"drawing_list\",\n            additionalData: {\n              limit_to_job: userJob.value,\n              drawings_without_parts: watchDrawingsWithoutParts\n            },\n            value: selectedDocOptions,\n            multiple: true,\n            limitTags: 2,\n            disableCloseOnSelect: true,\n            filterOptions: function filterOptions(options) {\n              if (!options) {\n                return [];\n              }\n\n              if (isCreating) {\n                return _.differenceWith(options, watchAssociatedDocs, _.isEqual);\n              }\n\n              return _.differenceWith(options, watchAssociatedDocs, _.isEqual).filter(function (item) {\n                return item.value !== drawingDetail.id;\n              });\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 4,\n          className: classes.buttonGroup,\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            startIcon: /*#__PURE__*/_jsxDEV(CreateIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 32\n            }, this),\n            disabled: selectedDocOptions.length === 0,\n            onClick: handleAddDocs,\n            children: \"Add\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            startIcon: /*#__PURE__*/_jsxDEV(DeleteIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 111,\n              columnNumber: 26\n            }, this),\n            disabled: selectedDocs.length === 0,\n            onClick: handleDeleteDocs,\n            style: {\n              marginTop: -3\n            },\n            children: \"Remove\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 12,\n      children: /*#__PURE__*/_jsxDEV(Paper, {\n        children: /*#__PURE__*/_jsxDEV(DataTable, {\n          hideFooter: true,\n          disableColumnMenu: true,\n          checkboxSelection: true,\n          tableHeight: 300,\n          rows: watchAssociatedDocs,\n          selectionModel: selectedDocs,\n          onSelectionModelChange: handleSelectDoc,\n          getRowId: function getRowId(params) {\n            return params.value;\n          },\n          columns: [_objectSpread(_objectSpread({}, columnProperties.defaultProperties), {}, {\n            field: 'entity_id',\n            flex: 0.5,\n            headerName: 'Document'\n          }), _objectSpread(_objectSpread({}, columnProperties.defaultProperties), {}, {\n            headerName: 'Description',\n            field: 'description',\n            flex: 0.5\n          })]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 12,\n      children: /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          children: /*#__PURE__*/_jsxDEV(Typography, {\n            className: classes.title,\n            children: \"Exclude this drawing from the forward lists\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          style: {\n            marginTop: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(FormControllerCheckbox, {\n            control: drawingForm.control,\n            name: \"exclude_from_customer\",\n            label: \"Customer\",\n            className: classes.chkSetAsDefault\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(FormControllerCheckbox, {\n            control: drawingForm.control,\n            name: \"exclude_from_supplier\",\n            label: \"Suppliers\",\n            className: classes.chkSetAsDefault\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(FormControllerCheckbox, {\n            control: drawingForm.control,\n            name: \"exclude_from_other\",\n            label: \"Others\",\n            className: classes.chkSetAsDefault\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 5\n  }, this);\n}\n\n_s(TabDetail, \"fvcPd0nh+wyG81W5Myr5G7ZH5Hg=\", false, function () {\n  return [useStyles, useFormContext, useSelector, useSelector];\n});\n\n_c = TabDetail;\nexport default TabDetail;\n\nvar _c;\n\n$RefreshReg$(_c, \"TabDetail\");","map":{"version":3,"sources":["D:/Fersher/TTS_Reactjs/malis-3-frontend/src/components/Dialog/Module/Drawing/TabDetail/index.tsx"],"names":["useState","useFormContext","useStyles","useSelector","Button","FormControl","Grid","Paper","Switch","Typography","AppTitle","DataTable","DeleteIcon","FormControllerCheckbox","CreateIcon","AppAutocompleteAsync","_","columnProperties","drawingStore","commonStore","TabDetail","classes","selectedDocs","setSelectedDocs","selectedDocOptions","setSelectedDocOptions","drawingForm","watchAssociatedDocs","watch","watchDrawingsWithoutParts","userJob","selectUserValueJob","drawingDetail","selectDetail","isCreating","isNil","id","handleAddDocs","getValues","associated_documents","push","setValue","handleSelectDoc","selectionModel","handleDeleteDocs","newDocs","filter","doc","includes","value","handleSelectDrawing","event","options","handleSwitchDrawingSearch","checked","switchButton","label","limit_to_job","drawings_without_parts","differenceWith","isEqual","item","buttonGroup","length","marginTop","params","defaultProperties","field","flex","headerName","title","control","chkSetAsDefault"],"mappings":"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","sourcesContent":["import { useState } from 'react'\nimport { useFormContext } from 'react-hook-form'\nimport useStyles from './styles'\nimport { useSelector } from 'react-redux'\n\nimport { Button, FormControl, Grid, Paper, Switch, Typography } from '@material-ui/core'\n\nimport { AppTitle, DataTable, DeleteIcon, FormControllerCheckbox, CreateIcon, AppAutocompleteAsync } from '@/components'\n\nimport _ from 'lodash'\nimport * as columnProperties from '@/utils/columnProperties'\nimport { drawingStore, commonStore } from '@/store/reducers'\n\nimport type { DrawingDetail } from '@/types/Drawing'\n\nfunction TabDetail() {\n  const classes = useStyles()\n\n  const [selectedDocs, setSelectedDocs] = useState([])\n  const [selectedDocOptions, setSelectedDocOptions] = useState([])\n\n  const drawingForm = useFormContext<DrawingDetail>()\n  const watchAssociatedDocs = drawingForm.watch('associated_documents', [])\n  const watchDrawingsWithoutParts = drawingForm.watch('drawings_without_parts', false)\n\n  const userJob = useSelector(commonStore.selectUserValueJob)\n  const drawingDetail = useSelector(drawingStore.selectDetail)\n\n  const isCreating = _.isNil(drawingDetail.id)\n\n  const handleAddDocs = () => {\n    const { associated_documents } = drawingForm.getValues()\n    associated_documents.push(...selectedDocOptions)\n    drawingForm.setValue('associated_documents', associated_documents)\n    setSelectedDocOptions([])\n  }\n\n  const handleSelectDoc = ({ selectionModel }) => {\n    setSelectedDocs(selectionModel)\n  }\n\n  const handleDeleteDocs = () => {\n    const { associated_documents } = drawingForm.getValues()\n    const newDocs = associated_documents.filter((doc) => !selectedDocs.includes(doc.value))\n    setSelectedDocs([])\n    drawingForm.setValue('associated_documents', newDocs)\n  }\n\n  const handleSelectDrawing = (event, options) => {\n    setSelectedDocOptions(options)\n  }\n\n  const handleSwitchDrawingSearch = (event, checked) => {\n    drawingForm.setValue('drawings_without_parts', checked)\n  }\n\n  return (\n    <Grid container spacing={1}>\n      <Grid item xs={12}>\n        <Grid container>\n          <Grid item xs={6}>\n            <AppTitle label=\"Associated detailed documents\" />\n          </Grid>\n          <Grid item xs={6} className={classes.switchButton}>\n            <FormControl style={{}}>\n              <Switch\n                color=\"primary\"\n                inputProps={{ 'aria-label': 'primary checkbox' }}\n                checked={watchDrawingsWithoutParts}\n                onChange={handleSwitchDrawingSearch}\n              />\n            </FormControl>\n            <FormControl className={classes.label}>All job/std drawing</FormControl>\n          </Grid>\n        </Grid>\n      </Grid>\n      <Grid item xs={12}>\n        <Grid container spacing={3}>\n          <Grid item xs={8}>\n            <AppAutocompleteAsync\n              label=\"Document\"\n              onChange={handleSelectDrawing}\n              compName=\"drawing_list\"\n              additionalData={{\n                limit_to_job: userJob.value,\n                drawings_without_parts: watchDrawingsWithoutParts\n              }}\n              value={selectedDocOptions}\n              multiple\n              limitTags={2}\n              disableCloseOnSelect\n              filterOptions={(options) => {\n                if (!options) {\n                  return []\n                }\n                if (isCreating) {\n                  return _.differenceWith(options, watchAssociatedDocs, _.isEqual)\n                }\n                return _.differenceWith(options, watchAssociatedDocs, _.isEqual).filter(\n                  (item) => item.value !== drawingDetail.id\n                )\n              }}\n            />\n          </Grid>\n\n          <Grid item xs={4} className={classes.buttonGroup}>\n            <Button startIcon={<CreateIcon />} disabled={selectedDocOptions.length === 0} onClick={handleAddDocs}>\n              Add\n            </Button>\n            <Button\n              startIcon={<DeleteIcon />}\n              disabled={selectedDocs.length === 0}\n              onClick={handleDeleteDocs}\n              style={{ marginTop: -3 }}\n            >\n              Remove\n            </Button>\n          </Grid>\n        </Grid>\n      </Grid>\n      <Grid item xs={12}>\n        <Paper>\n          <DataTable\n            hideFooter\n            disableColumnMenu\n            checkboxSelection\n            tableHeight={300}\n            rows={watchAssociatedDocs}\n            selectionModel={selectedDocs}\n            onSelectionModelChange={handleSelectDoc}\n            getRowId={(params) => params.value}\n            columns={[\n              {\n                ...columnProperties.defaultProperties,\n                field: 'entity_id',\n                flex: 0.5,\n                headerName: 'Document'\n              },\n              {\n                ...columnProperties.defaultProperties,\n                headerName: 'Description',\n                field: 'description',\n                flex: 0.5\n              }\n            ]}\n          />\n        </Paper>\n      </Grid>\n      <Grid item xs={12}>\n        <Grid container>\n          <Grid item xs={12}>\n            <Typography className={classes.title}>Exclude this drawing from the forward lists</Typography>\n          </Grid>\n          <Grid item xs={12} style={{ marginTop: 8 }}>\n            <FormControllerCheckbox\n              control={drawingForm.control}\n              name=\"exclude_from_customer\"\n              label=\"Customer\"\n              className={classes.chkSetAsDefault}\n            />\n            <FormControllerCheckbox\n              control={drawingForm.control}\n              name=\"exclude_from_supplier\"\n              label=\"Suppliers\"\n              className={classes.chkSetAsDefault}\n            />\n            <FormControllerCheckbox\n              control={drawingForm.control}\n              name=\"exclude_from_other\"\n              label=\"Others\"\n              className={classes.chkSetAsDefault}\n            />\n          </Grid>\n        </Grid>\n      </Grid>\n    </Grid>\n  )\n}\n\nexport default TabDetail\n"]},"metadata":{},"sourceType":"module"}