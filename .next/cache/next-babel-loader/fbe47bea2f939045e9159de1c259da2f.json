{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport { TextField, InputAdornment } from '@material-ui/core';\nimport DateRangeIcon from '@material-ui/icons/DateRange'; // import DialogCalendar from '../DialogCalendar'\n\nimport { DialogCalendar, FormControllerErrorMessage } from '@/components/index';\nimport { isValid, parseISO, format } from 'date-fns';\nimport _ from 'lodash';\nimport * as constant from '@/utils/constant';\nimport { useToggle } from 'react-use';\nimport useStyles from './styles'; // import type { CustomDatePickerProps } from './type'\n\nfunction DatePicker(props) {\n  var value = props.value,\n      onChange = props.onChange,\n      minDate = props.minDate,\n      maxDate = props.maxDate,\n      helperText = props.helperText,\n      error = props.error,\n      datePickerProps = _objectWithoutProperties(props, [\"value\", \"onChange\", \"minDate\", \"maxDate\", \"helperText\", \"error\"]);\n\n  var classes = useStyles();\n\n  var _React$useState = React.useState(''),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      dateValue = _React$useState2[0],\n      setDateValue = _React$useState2[1];\n\n  var _React$useState3 = React.useState(false),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      openCalendar = _React$useState4[0],\n      setOpenCalendar = _React$useState4[1];\n\n  var _useToggle = useToggle(false),\n      _useToggle2 = _slicedToArray(_useToggle, 2),\n      isFocusing = _useToggle2[0],\n      setIsFocusing = _useToggle2[1];\n\n  var openTooltip = React.useMemo(function () {\n    return isFocusing && error;\n  }, [error, isFocusing]);\n  /**\n   * The function used to check valid date\n   * @param {String} date\n   * @return {boolean}\n   */\n\n  var isValidDate = function isValidDate(date) {\n    return isValid(parseISO(date));\n  };\n\n  React.useEffect(function () {\n    setDateValue(value);\n  }, [value]);\n\n  var onHoverField = function onHoverField() {\n    setIsFocusing(true);\n  };\n\n  var onLeavingField = function onLeavingField() {\n    setIsFocusing(false);\n  };\n\n  var addZero = function addZero(value) {\n    var splitMonth = value.toString().split('');\n\n    if (splitMonth.length === 2) {\n      return value;\n    }\n\n    return \"0\".concat(splitMonth);\n  };\n\n  var getSymbol = function getSymbol(date) {\n    if (date.includes('-')) {\n      return '-';\n    } else if (date.includes('/')) {\n      return '/';\n    } else {\n      return '.';\n    }\n  };\n  /**\n   * Build a date string based on symbols (\"/\", \".\", \"-\")\n   * @param {String} date\n   * @return {String} ex: 2021-07-01 (yyyy-MM-dd)\n   */\n\n\n  var buildDate = function buildDate(date) {\n    var symbol = getSymbol(date);\n    var splitDate = date.split(symbol); // 2021-07-02 => [2021, 07, 02]\n    // case user input full values\n\n    if (splitDate.length === 3 && symbol === '-') {\n      return format(new Date(date), constant.DATE_FORMAT);\n    }\n\n    if (splitDate.length === 3 && symbol !== '-') {\n      var newDate = date.split(symbol).reverse().join(symbol);\n      return format(new Date(newDate), constant.DATE_FORMAT);\n    }\n\n    var currentDate = new Date();\n    var year = currentDate.getFullYear();\n    var month;\n    var day;\n\n    if (splitDate.length === 2) {\n      // case user input two values,\n      // ex1: 02-01 => month = 02, day = 01\n      // ex2: 02/01 => month = 01, day = 02\n      // ex3: 02.01 => month = 01, day = 02\n      month = symbol === '-' ? splitDate[0] : splitDate[1];\n      day = symbol === '-' ? splitDate[1] : splitDate[0];\n    } else {\n      // case user input single value, then we will get the month in the current date\n      month = currentDate.getMonth() + 1;\n      day = date;\n    }\n\n    return \"\".concat(year, \"-\").concat(addZero(month), \"-\").concat(addZero(day));\n  };\n\n  var handleTransformValue = function handleTransformValue(event) {\n    var value = _.trim(event.target.value);\n\n    var date = value;\n\n    if (constant.REGEX_VALID_DATE_EUROPE.test(value) || constant.REGEX_VALID_DATE_ASIA.test(value)) {\n      date = buildDate(value);\n    }\n\n    if (isValidDate(date)) {\n      setDateValue(date);\n      onChange(date);\n    } else {\n      setDateValue(value);\n      onChange(value);\n    }\n  };\n\n  var handleChangeValue = function handleChangeValue(event) {\n    setDateValue(event.target.value);\n  };\n\n  var handleOpenCalendar = function handleOpenCalendar() {\n    setOpenCalendar(true);\n  };\n\n  var handleCloseCalendar = function handleCloseCalendar() {\n    setOpenCalendar(false);\n  };\n\n  var handleChangeDate = function handleChangeDate(nextDate) {\n    var dateFormat = format(nextDate, constant.DATE_FORMAT);\n    onChange(dateFormat);\n    handleCloseCalendar();\n  };\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(FormControllerErrorMessage, {\n      title: helperText,\n      open: openTooltip,\n      children: /*#__PURE__*/_jsx(TextField, _objectSpread(_objectSpread({}, datePickerProps), {}, {\n        error: error,\n        onMouseOver: onHoverField,\n        onMouseLeave: onLeavingField,\n        value: dateValue,\n        onChange: handleChangeValue,\n        onBlur: handleTransformValue,\n        variant: \"outlined\",\n        InputProps: {\n          endAdornment: /*#__PURE__*/_jsx(InputAdornment, {\n            position: \"end\",\n            children: /*#__PURE__*/_jsx(DateRangeIcon, {\n              className: classes.icon,\n              onClick: handleOpenCalendar\n            })\n          })\n        }\n      }))\n    }), /*#__PURE__*/_jsx(DialogCalendar, {\n      open: openCalendar,\n      date: dateValue,\n      onChange: handleChangeDate,\n      onClose: handleCloseCalendar,\n      minDate: minDate,\n      maxDate: maxDate\n    })]\n  });\n}\n\nexport default DatePicker;","map":null,"metadata":{},"sourceType":"module"}