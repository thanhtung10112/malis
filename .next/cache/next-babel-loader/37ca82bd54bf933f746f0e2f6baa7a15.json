{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport { put, takeEvery, takeLatest } from 'redux-saga/effects';\nimport { select, all, call } from 'typed-redux-saga';\nimport { createAction } from '@reduxjs/toolkit';\nimport { authStore, advancedFilterActions, commonStore } from '@/store/reducers';\nimport afApi from '@/apis/advancedFilter.api';\nimport { StatusCode } from '@/utils/StatusCode';\nimport { actionTypes } from '@/utils/constant';\n\nfunction* getEntity() {\n  const entity = yield* select(commonStore.selectEntity);\n  return entity;\n}\n\nfunction* fetchDefaultFilter() {\n  const entity = yield getEntity();\n  const data = yield call(afApi.getInitDataForList, entity);\n  yield put(advancedFilterActions.setDefaultFilter(data.default_filter));\n  yield put(advancedFilterActions.setPermissions(data.permissions.advanced_filters));\n  yield put(advancedFilterActions.setSystemPreset(data.system_default_filter));\n}\n\nfunction* fetchFilterList(filterType = '') {\n  let type = filterType;\n\n  if (!type) {\n    type = yield* select(advancedFilterActions.selectFilterType);\n  }\n\n  const entity = yield getEntity();\n  const {\n    filter_preset_list\n  } = yield call(afApi.getList, {\n    entity,\n    type\n  });\n  yield put(advancedFilterActions.setFilterPresetList(filter_preset_list));\n}\n\nfunction* fetchInitDataForCreateEdit() {\n  const entity = yield getEntity();\n  const data = yield call(afApi.getInitDataForCE, entity);\n  yield put(advancedFilterActions.setInitData(data));\n}\n\nfunction* fetchFilterDetail(id) {\n  const {\n    filter_preset\n  } = yield call(afApi.getDetail, id);\n  const filterType = yield* select(advancedFilterActions.selectFilterType);\n\n  if (filterType === 'shared') {\n    filter_preset.is_user_default = false;\n  }\n\n  yield put(advancedFilterActions.setFilterDetail(filter_preset));\n}\n\nfunction* open() {\n  yield put(advancedFilterActions.setOpenAdvanceSearch(true));\n  yield put(advancedFilterActions.setLoadingSection(true));\n\n  try {\n    yield all([call(fetchDefaultFilter), call(fetchFilterList), call(fetchInitDataForCreateEdit)]);\n    const {\n      user,\n      defaultFilter\n    } = yield* all({\n      user: select(authStore.selectProfile),\n      defaultFilter: select(advancedFilterActions.selectDefaultFilter)\n    });\n\n    if (user.user_id === defaultFilter.created_by) {\n      yield put(advancedFilterActions.setEditMode(true));\n    }\n\n    yield call(fetchFilterDetail, defaultFilter.id);\n    yield put(advancedFilterActions.setExpandedSection(true));\n  } catch (error) {\n    yield put(commonStore.actions.setError(error));\n  }\n\n  yield put(advancedFilterActions.setLoadingSection(false));\n}\n\nfunction* changeFilterType({\n  payload: filterType\n}) {\n  yield put(advancedFilterActions.setLoadingTable(true));\n\n  try {\n    yield call(fetchFilterList, filterType);\n    yield put(advancedFilterActions.setFilterType(filterType));\n  } catch (error) {\n    yield put(commonStore.actions.setError(error));\n  }\n\n  yield put(advancedFilterActions.setLoadingTable(false));\n}\n\nfunction* getList() {\n  yield put(commonStore.actions.setLoadingPage(true));\n\n  try {\n    yield call(fetchFilterList);\n  } catch (error) {\n    yield put(commonStore.actions.setError(error));\n  }\n\n  yield put(commonStore.actions.setLoadingPage(false));\n}\n\nfunction* getDefaultFilter() {\n  yield put(commonStore.actions.setLoadingPage(true));\n\n  try {\n    yield call(fetchDefaultFilter);\n  } catch (error) {\n    yield put(commonStore.actions.setError(error));\n  }\n\n  yield put(commonStore.actions.setLoadingPage(false));\n}\n\nfunction* create() {\n  yield put(commonStore.actions.setLoadingPage(true));\n\n  try {\n    const _yield$select = yield select(advancedFilterActions.selectFilterDetail),\n          {\n      id,\n      created_at,\n      created_by,\n      updated_at,\n      updated_by,\n      is_system_default\n    } = _yield$select,\n          filterDetail = _objectWithoutProperties(_yield$select, [\"id\", \"created_at\", \"created_by\", \"updated_at\", \"updated_by\", \"is_system_default\"]);\n\n    const data = yield call(afApi.create, filterDetail);\n    yield all([call(fetchDefaultFilter), call(fetchFilterList)]);\n    const userInfo = yield select(authStore.selectProfile);\n    yield put(advancedFilterActions.setEditMode(true));\n    yield put(advancedFilterActions.setFilterDetail({\n      id: data.id,\n      created_by: userInfo.user_id,\n      is_system_default: false\n    }));\n    yield put(commonStore.actions.setSuccessMessage(data.message));\n    yield put(advancedFilterActions.setAfForm({\n      clearError: true,\n      error: ''\n    }));\n  } catch (error) {\n    const {\n      status,\n      message\n    } = error;\n\n    if (status === StatusCode.BAD_REQUEST) {\n      yield put(advancedFilterActions.setAfForm({\n        error: message\n      }));\n    } else {\n      yield put(commonStore.actions.setError(error));\n    }\n  }\n\n  yield put(advancedFilterActions.setAfForm({\n    clearError: false,\n    error: ''\n  }));\n  yield put(commonStore.actions.setLoadingPage(false));\n}\n\nfunction* update() {\n  yield put(commonStore.actions.setLoadingPage(true));\n\n  try {\n    const _yield$select2 = yield select(advancedFilterActions.selectFilterDetail),\n          {\n      id,\n      created_at,\n      created_by,\n      updated_at,\n      updated_by,\n      is_system_default\n    } = _yield$select2,\n          filterDetail = _objectWithoutProperties(_yield$select2, [\"id\", \"created_at\", \"created_by\", \"updated_at\", \"updated_by\", \"is_system_default\"]);\n\n    const {\n      message\n    } = yield call(afApi.update, id, filterDetail);\n    yield all([call(fetchDefaultFilter), call(fetchFilterList)]);\n    yield put(commonStore.actions.setSuccessMessage(message));\n    yield put(advancedFilterActions.setAfForm({\n      clearError: true,\n      error: ''\n    }));\n  } catch (error) {\n    const {\n      status,\n      message\n    } = error;\n\n    if (status === StatusCode.BAD_REQUEST) {\n      yield put(advancedFilterActions.setAfForm({\n        error: message\n      }));\n    } else {\n      yield put(commonStore.actions.setError(error));\n    }\n  }\n\n  yield put(advancedFilterActions.setAfForm({\n    clearError: false,\n    error: ''\n  }));\n  yield put(commonStore.actions.setLoadingPage(false));\n}\n\nfunction* share({\n  payload\n}) {\n  yield put(advancedFilterActions.setLoadingTable(true));\n\n  try {\n    const {\n      id,\n      is_shared\n    } = payload;\n    const {\n      message\n    } = yield call(afApi.share, id, is_shared);\n    yield call(fetchFilterList);\n    yield put(commonStore.actions.setSuccessMessage(message));\n  } catch (error) {\n    yield put(commonStore.actions.setError(error));\n  }\n\n  yield put(advancedFilterActions.setLoadingTable(false));\n}\n\nfunction* getDetail({\n  payload: id\n}) {\n  yield put(commonStore.actions.setLoadingPage(true));\n\n  try {\n    yield all([call(fetchInitDataForCreateEdit), call(fetchFilterDetail, id)]);\n    yield put(advancedFilterActions.setEditMode(true));\n  } catch (error) {\n    yield put(commonStore.actions.setError(error));\n  }\n\n  yield put(commonStore.actions.setLoadingPage(false));\n}\n\nfunction* remove() {\n  yield put(commonStore.actions.setLoadingPage(true));\n\n  try {\n    const {\n      id\n    } = yield select(advancedFilterActions.selectFilterDetail);\n    const {\n      message\n    } = yield call(afApi.remove, id);\n    yield all([call(fetchDefaultFilter), call(fetchFilterList)]);\n    const defaultFilter = yield select(advancedFilterActions.selectDefaultFilter);\n    yield call(fetchFilterDetail, defaultFilter.id);\n    yield put(commonStore.actions.setSuccessMessage(message));\n  } catch (error) {\n    yield put(commonStore.actions.setError(error));\n  }\n\n  yield put(commonStore.actions.setLoadingPage(false));\n}\n\nfunction* clearDefaultFilter() {\n  yield put(commonStore.actions.setLoadingPage(true));\n\n  try {\n    const entity = yield getEntity();\n    const {\n      message\n    } = yield call(afApi.clearDefault, entity);\n    yield call(fetchDefaultFilter);\n    const filterDefault = yield select(advancedFilterActions.selectDefaultFilter);\n    yield put(advancedFilterActions.setFilterDetail(filterDefault));\n    yield put(commonStore.actions.setSuccessMessage(message));\n  } catch (error) {\n    yield put(commonStore.actions.setError(error));\n  }\n\n  yield put(commonStore.actions.setLoadingPage(false));\n}\n\nfunction* saveAs({\n  payload: name\n}) {\n  yield put(advancedFilterActions.setLoadingDialog(true));\n\n  try {\n    const _yield$select3 = yield select(advancedFilterActions.selectFilterDetail),\n          {\n      id,\n      created_at,\n      created_by,\n      updated_at,\n      updated_by,\n      is_system_default\n    } = _yield$select3,\n          filterDetail = _objectWithoutProperties(_yield$select3, [\"id\", \"created_at\", \"created_by\", \"updated_at\", \"updated_by\", \"is_system_default\"]);\n\n    const copyFilterDetail = _objectSpread(_objectSpread({}, filterDetail), {}, {\n      name\n    });\n\n    const data = yield call(afApi.create, copyFilterDetail);\n    yield all([call(fetchDefaultFilter), call(fetchFilterList)]);\n    const userInfo = yield select(authStore.selectProfile);\n    yield put(advancedFilterActions.setEditMode(true));\n    yield put(advancedFilterActions.setFilterDetail({\n      id: data.id,\n      created_by: userInfo.user_id,\n      is_system_default: false,\n      name\n    }));\n    yield put(commonStore.actions.setSuccessMessage(data.message));\n    yield put(advancedFilterActions.setSaveAsForm({\n      open: false,\n      clearError: true,\n      error: ''\n    }));\n  } catch (error) {\n    const {\n      message,\n      status\n    } = error;\n\n    if (status === StatusCode.BAD_REQUEST) {\n      yield put(advancedFilterActions.setSaveAsForm({\n        error: message\n      }));\n    } else {\n      yield put(commonStore.actions.setError(error));\n    }\n  }\n\n  yield put(advancedFilterActions.setSaveAsForm({\n    clearError: false,\n    error: ''\n  }));\n  yield put(advancedFilterActions.setLoadingDialog(false));\n}\n\nfunction* apply() {\n  let entity = yield* getEntity();\n\n  if (entity === 'manufacturing_standard' || entity === 'material_standard') {\n    entity = 'equivalence';\n  }\n\n  const getListAction = createAction(`${entity}/${actionTypes.GET_LIST}`);\n  yield put(commonStore.actions.setTableState({\n    page: 1\n  }));\n  yield put(getListAction());\n  yield put(commonStore.actions.setSuccessMessage('The filter preset is applied successfully! This result is temporary'));\n}\n\nfunction* close() {\n  let entity = yield* getEntity();\n\n  if (entity === 'manufacturing_standard' || entity === 'material_standard') {\n    entity = 'equivalence';\n  }\n\n  const getListAction = createAction(`${entity}/${actionTypes.GET_LIST}`);\n  yield put(getListAction());\n}\n\nfunction* advancedFilterSaga() {\n  yield takeEvery(advancedFilterActions.getList, getList);\n  yield takeEvery(advancedFilterActions.create, create);\n  yield takeEvery(advancedFilterActions.update, update);\n  yield takeEvery(advancedFilterActions.getDetail, getDetail);\n  yield takeEvery(advancedFilterActions.share, share);\n  yield takeLatest(advancedFilterActions.remove, remove);\n  yield takeLatest(advancedFilterActions.clearDefaultFilter, clearDefaultFilter);\n  yield takeEvery(advancedFilterActions.getDefaultFilter, getDefaultFilter);\n  yield takeEvery(advancedFilterActions.changeFilterType, changeFilterType);\n  yield takeEvery(advancedFilterActions.saveAs, saveAs);\n  yield takeEvery(advancedFilterActions.open, open);\n  yield takeEvery(advancedFilterActions.apply, apply);\n  yield takeEvery(advancedFilterActions.close, close);\n}\n\nexport default advancedFilterSaga;","map":{"version":3,"sources":["D:/TTS_Reactjs/malis-3-frontend/src/store/saga/advancedFilter.saga.ts"],"names":["put","takeEvery","takeLatest","select","all","call","createAction","authStore","advancedFilterActions","commonStore","afApi","StatusCode","actionTypes","getEntity","entity","selectEntity","fetchDefaultFilter","data","getInitDataForList","setDefaultFilter","default_filter","setPermissions","permissions","advanced_filters","setSystemPreset","system_default_filter","fetchFilterList","filterType","type","selectFilterType","filter_preset_list","getList","setFilterPresetList","fetchInitDataForCreateEdit","getInitDataForCE","setInitData","fetchFilterDetail","id","filter_preset","getDetail","is_user_default","setFilterDetail","open","setOpenAdvanceSearch","setLoadingSection","user","defaultFilter","selectProfile","selectDefaultFilter","user_id","created_by","setEditMode","setExpandedSection","error","actions","setError","changeFilterType","payload","setLoadingTable","setFilterType","setLoadingPage","getDefaultFilter","create","selectFilterDetail","created_at","updated_at","updated_by","is_system_default","filterDetail","userInfo","setSuccessMessage","message","setAfForm","clearError","status","BAD_REQUEST","update","share","is_shared","remove","clearDefaultFilter","clearDefault","filterDefault","saveAs","name","setLoadingDialog","copyFilterDetail","setSaveAsForm","apply","getListAction","GET_LIST","setTableState","page","close","advancedFilterSaga"],"mappings":"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","sourcesContent":["import { put, takeEvery, takeLatest } from 'redux-saga/effects'\nimport { select, all, call } from 'typed-redux-saga'\nimport { createAction } from '@reduxjs/toolkit'\n\nimport { authStore, advancedFilterActions, commonStore } from '@/store/reducers'\nimport afApi from '@/apis/advancedFilter.api'\nimport { StatusCode } from '@/utils/StatusCode'\nimport { actionTypes } from '@/utils/constant'\n\nfunction* getEntity() {\n  const entity = yield* select(commonStore.selectEntity)\n  return entity\n}\n\nfunction* fetchDefaultFilter() {\n  const entity = yield getEntity()\n  const data = yield call(afApi.getInitDataForList, entity)\n  yield put(advancedFilterActions.setDefaultFilter(data.default_filter))\n  yield put(advancedFilterActions.setPermissions(data.permissions.advanced_filters))\n  yield put(advancedFilterActions.setSystemPreset(data.system_default_filter))\n}\n\nfunction* fetchFilterList(filterType = '') {\n  let type = filterType\n  if (!type) {\n    type = yield* select(advancedFilterActions.selectFilterType)\n  }\n  const entity = yield getEntity()\n  const { filter_preset_list } = yield call(afApi.getList, { entity, type })\n  yield put(advancedFilterActions.setFilterPresetList(filter_preset_list))\n}\n\nfunction* fetchInitDataForCreateEdit() {\n  const entity = yield getEntity()\n  const data = yield call(afApi.getInitDataForCE, entity)\n  yield put(advancedFilterActions.setInitData(data))\n}\n\nfunction* fetchFilterDetail(id: number) {\n  const { filter_preset } = yield call(afApi.getDetail, id)\n  const filterType = yield* select(advancedFilterActions.selectFilterType)\n  if (filterType === 'shared') {\n    filter_preset.is_user_default = false\n  }\n  yield put(advancedFilterActions.setFilterDetail(filter_preset))\n}\n\nfunction* open() {\n  yield put(advancedFilterActions.setOpenAdvanceSearch(true))\n  yield put(advancedFilterActions.setLoadingSection(true))\n\n  try {\n    yield all([call(fetchDefaultFilter), call(fetchFilterList), call(fetchInitDataForCreateEdit)])\n    const { user, defaultFilter } = yield* all({\n      user: select(authStore.selectProfile),\n      defaultFilter: select(advancedFilterActions.selectDefaultFilter)\n    })\n    if (user.user_id === defaultFilter.created_by) {\n      yield put(advancedFilterActions.setEditMode(true))\n    }\n    yield call(fetchFilterDetail, defaultFilter.id)\n    yield put(advancedFilterActions.setExpandedSection(true))\n  } catch (error) {\n    yield put(commonStore.actions.setError(error))\n  }\n  yield put(advancedFilterActions.setLoadingSection(false))\n}\n\nfunction* changeFilterType({ payload: filterType }) {\n  yield put(advancedFilterActions.setLoadingTable(true))\n  try {\n    yield call(fetchFilterList, filterType)\n    yield put(advancedFilterActions.setFilterType(filterType))\n  } catch (error) {\n    yield put(commonStore.actions.setError(error))\n  }\n  yield put(advancedFilterActions.setLoadingTable(false))\n}\n\nfunction* getList() {\n  yield put(commonStore.actions.setLoadingPage(true))\n\n  try {\n    yield call(fetchFilterList)\n  } catch (error) {\n    yield put(commonStore.actions.setError(error))\n  }\n\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nfunction* getDefaultFilter() {\n  yield put(commonStore.actions.setLoadingPage(true))\n  try {\n    yield call(fetchDefaultFilter)\n  } catch (error) {\n    yield put(commonStore.actions.setError(error))\n  }\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nfunction* create() {\n  yield put(commonStore.actions.setLoadingPage(true))\n  try {\n    const { id, created_at, created_by, updated_at, updated_by, is_system_default, ...filterDetail } = yield select(\n      advancedFilterActions.selectFilterDetail\n    )\n    const data = yield call(afApi.create, filterDetail)\n    yield all([call(fetchDefaultFilter), call(fetchFilterList)])\n    const userInfo = yield select(authStore.selectProfile)\n    yield put(advancedFilterActions.setEditMode(true))\n    yield put(\n      advancedFilterActions.setFilterDetail({\n        id: data.id,\n        created_by: userInfo.user_id,\n        is_system_default: false\n      })\n    )\n    yield put(commonStore.actions.setSuccessMessage(data.message))\n    yield put(\n      advancedFilterActions.setAfForm({\n        clearError: true,\n        error: ''\n      })\n    )\n  } catch (error) {\n    const { status, message } = error\n    if (status === StatusCode.BAD_REQUEST) {\n      yield put(advancedFilterActions.setAfForm({ error: message }))\n    } else {\n      yield put(commonStore.actions.setError(error))\n    }\n  }\n  yield put(advancedFilterActions.setAfForm({ clearError: false, error: '' }))\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nfunction* update() {\n  yield put(commonStore.actions.setLoadingPage(true))\n  try {\n    const { id, created_at, created_by, updated_at, updated_by, is_system_default, ...filterDetail } = yield select(\n      advancedFilterActions.selectFilterDetail\n    )\n    const { message } = yield call(afApi.update, id, filterDetail)\n    yield all([call(fetchDefaultFilter), call(fetchFilterList)])\n    yield put(commonStore.actions.setSuccessMessage(message))\n    yield put(\n      advancedFilterActions.setAfForm({\n        clearError: true,\n        error: ''\n      })\n    )\n  } catch (error) {\n    const { status, message } = error\n    if (status === StatusCode.BAD_REQUEST) {\n      yield put(advancedFilterActions.setAfForm({ error: message }))\n    } else {\n      yield put(commonStore.actions.setError(error))\n    }\n  }\n  yield put(advancedFilterActions.setAfForm({ clearError: false, error: '' }))\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nfunction* share({ payload }: ReturnType<typeof advancedFilterActions.share>) {\n  yield put(advancedFilterActions.setLoadingTable(true))\n  try {\n    const { id, is_shared } = payload\n    const { message } = yield call(afApi.share, id, is_shared)\n    yield call(fetchFilterList)\n    yield put(commonStore.actions.setSuccessMessage(message))\n  } catch (error) {\n    yield put(commonStore.actions.setError(error))\n  }\n  yield put(advancedFilterActions.setLoadingTable(false))\n}\n\nfunction* getDetail({ payload: id }) {\n  yield put(commonStore.actions.setLoadingPage(true))\n  try {\n    yield all([call(fetchInitDataForCreateEdit), call(fetchFilterDetail, id)])\n    yield put(advancedFilterActions.setEditMode(true))\n  } catch (error) {\n    yield put(commonStore.actions.setError(error))\n  }\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nfunction* remove() {\n  yield put(commonStore.actions.setLoadingPage(true))\n  try {\n    const { id } = yield select(advancedFilterActions.selectFilterDetail)\n    const { message } = yield call(afApi.remove, id)\n    yield all([call(fetchDefaultFilter), call(fetchFilterList)])\n    const defaultFilter = yield select(advancedFilterActions.selectDefaultFilter)\n    yield call(fetchFilterDetail, defaultFilter.id)\n    yield put(commonStore.actions.setSuccessMessage(message))\n  } catch (error) {\n    yield put(commonStore.actions.setError(error))\n  }\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nfunction* clearDefaultFilter() {\n  yield put(commonStore.actions.setLoadingPage(true))\n  try {\n    const entity = yield getEntity()\n    const { message } = yield call(afApi.clearDefault, entity)\n    yield call(fetchDefaultFilter)\n    const filterDefault = yield select(advancedFilterActions.selectDefaultFilter)\n    yield put(advancedFilterActions.setFilterDetail(filterDefault))\n    yield put(commonStore.actions.setSuccessMessage(message))\n  } catch (error) {\n    yield put(commonStore.actions.setError(error))\n  }\n  yield put(commonStore.actions.setLoadingPage(false))\n}\n\nfunction* saveAs({ payload: name }) {\n  yield put(advancedFilterActions.setLoadingDialog(true))\n  try {\n    const { id, created_at, created_by, updated_at, updated_by, is_system_default, ...filterDetail } = yield select(\n      advancedFilterActions.selectFilterDetail\n    )\n    const copyFilterDetail = { ...filterDetail, name }\n    const data = yield call(afApi.create, copyFilterDetail)\n    yield all([call(fetchDefaultFilter), call(fetchFilterList)])\n    const userInfo = yield select(authStore.selectProfile)\n    yield put(advancedFilterActions.setEditMode(true))\n    yield put(\n      advancedFilterActions.setFilterDetail({\n        id: data.id,\n        created_by: userInfo.user_id,\n        is_system_default: false,\n        name\n      })\n    )\n    yield put(commonStore.actions.setSuccessMessage(data.message))\n    yield put(\n      advancedFilterActions.setSaveAsForm({\n        open: false,\n        clearError: true,\n        error: ''\n      })\n    )\n  } catch (error) {\n    const { message, status } = error\n    if (status === StatusCode.BAD_REQUEST) {\n      yield put(advancedFilterActions.setSaveAsForm({ error: message }))\n    } else {\n      yield put(commonStore.actions.setError(error))\n    }\n  }\n  yield put(advancedFilterActions.setSaveAsForm({ clearError: false, error: '' }))\n  yield put(advancedFilterActions.setLoadingDialog(false))\n}\n\nfunction* apply() {\n  let entity = yield* getEntity()\n  if (entity === 'manufacturing_standard' || entity === 'material_standard') {\n    entity = 'equivalence'\n  }\n  const getListAction = createAction(`${entity}/${actionTypes.GET_LIST}`)\n  yield put(commonStore.actions.setTableState({ page: 1 }))\n  yield put(getListAction())\n  yield put(\n    commonStore.actions.setSuccessMessage('The filter preset is applied successfully! This result is temporary')\n  )\n}\n\nfunction* close() {\n  let entity = yield* getEntity()\n  if (entity === 'manufacturing_standard' || entity === 'material_standard') {\n    entity = 'equivalence'\n  }\n  const getListAction = createAction(`${entity}/${actionTypes.GET_LIST}`)\n  yield put(getListAction())\n}\n\nfunction* advancedFilterSaga() {\n  yield takeEvery(advancedFilterActions.getList, getList)\n  yield takeEvery(advancedFilterActions.create, create)\n  yield takeEvery(advancedFilterActions.update, update)\n  yield takeEvery(advancedFilterActions.getDetail, getDetail)\n  yield takeEvery(advancedFilterActions.share, share)\n  yield takeLatest(advancedFilterActions.remove, remove)\n  yield takeLatest(advancedFilterActions.clearDefaultFilter, clearDefaultFilter)\n  yield takeEvery(advancedFilterActions.getDefaultFilter, getDefaultFilter)\n  yield takeEvery(advancedFilterActions.changeFilterType, changeFilterType)\n  yield takeEvery(advancedFilterActions.saveAs, saveAs)\n  yield takeEvery(advancedFilterActions.open, open)\n  yield takeEvery(advancedFilterActions.apply, apply)\n  yield takeEvery(advancedFilterActions.close, close)\n}\n\nexport default advancedFilterSaga\n"]},"metadata":{},"sourceType":"module"}